<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25" zv="Cache for UNIX (Red Hat Enterprise Linux 5 for x86-64) 2011.1.2 (Build 701)" ts="2014-04-25 16:34:24">
<Routine name="VEFAALR5" type="INT" languagemode="0" timestamp="63272,41105.841361"><![CDATA[
VEFAALR5 ;WOIFO/BT - VEFA AWARE KEY APIS for Alert Cache viewer and KB Editor; 01/15/2014
 ;;1.0;VEFA AWARE;**1,4**;17-January-2014;Build 1
 ;; Per VHA Directive 2004-038, this routine should not be modified.
 ;;
 ;
 ; External Reference DBIA#
 ; ------------------------
 ; #10076 - ^XUSEC GLOBAL (Supported)
 ; #2343  - DEA^XUSER     (Supported)
 QUIT
 ;
USRKEY(LEVEL,DUZ) ;
 ; LEVEL : User Key Security Level 
 ;         RETURN value (passed in by reference)
 ;         0 : User has no right to view Alert Cache
 ;         1 : User has right to only view his/her own Alert Cache
 ;         2 : User has right to see all Alert Cache
 ; 
 S LEVEL=0
 I $D(^XUSEC("XUPROG",DUZ)) S LEVEL=2
 I $D(^XUSEC("VEFA AWARE ALL ALERT CACHE",DUZ)) S LEVEL=2
 I 'LEVEL D
 . S DUZ(2)="" ;NOT USED for this session
 . S:$$DEA^XUSER(1,DUZ)'="" LEVEL=1 ;User has DEA# 
 QUIT
 ;
HASKBKEY(DUZ) ; Return 1 if user has programmer key or owns KB Key, 0 otherwise
 N KEY S KEY="VEFA AWARE ADD/EDIT KB RULE"
 QUIT:$D(^XUSEC("XUPROG",DUZ)) 1
 QUIT:$D(^XUSEC(KEY,DUZ)) 1
 QUIT 0
 ;
ISPROG(DUZ) ;  Return number > 0  if user has programmer key 0 otherwise
 QUIT $D(^XUSEC("XUPROG",DUZ))
]]></Routine>
</Export>
