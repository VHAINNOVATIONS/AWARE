<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25" zv="Cache for Windows (x86-64) 2012.2.3 (Build 903)" ts="2015-06-23 13:05:26">
<Class name="VEFA.AWARE">
<Description>
VEFA.AWARE</Description>
<ProcedureBlock>1</ProcedureBlock>
<Super>%SOAP.WebService</Super>
<TimeChanged>63677,63939.566507</TimeChanged>
<TimeCreated>63267,59829.431515</TimeCreated>

<Parameter name="SERVICENAME">
<Description>
Name of the WebService.</Description>
<Default>WSAWARE</Default>
</Parameter>

<Parameter name="NAMESPACE">
<Description>
SOAP Namespace for the WebService</Description>
<Default>http://aware.va.gov</Default>
</Parameter>

<Parameter name="USECLASSNAMESPACES">
<Description>
Namespaces of referenced classes will be used in the WSDL.</Description>
<Default>1</Default>
</Parameter>

<Method name="Login">
<Description>
Login to VistA Instance</Description>
<FormalSpec>Access:%String,Verify:%String</FormalSpec>
<ReturnType>%String</ReturnType>
<WebMethod>1</WebMethod>
<Implementation><![CDATA[
	S U="^"
	S DUZ=$$GETDUZ^VEFACSP1(Access,Verify,.MSG)
	;
	I 'DUZ S RET=0_U_MSG
	I DUZ D
	. D USRKEY^VEFAALR5(.LEVEL,DUZ)
	. S RET=LEVEL_U_$$GETNAME^VEFACSP1(DUZ)_U_DUZ
	;
	S %session.EndSession=1
	D BYE^XUSCLEAN
	QUIT RET
]]></Implementation>
</Method>

<Method name="GetPatientInfo">
<Description>
Get Patient Info</Description>
<FormalSpec>DFN:%Integer</FormalSpec>
<ReturnType>%String</ReturnType>
<WebMethod>1</WebMethod>
<Implementation><![CDATA[
	S RET=$$GETPTINF^VEFACSP1($G(DFN))
	S %session.EndSession=1
	D BYE^XUSCLEAN
	QUIT RET
]]></Implementation>
</Method>
</Class>


<Class name="VEFA.AlertCache">
<Description>
WOIFO/BT - VEFA AWARE ALERT CACHE API CALLED BY CSP FILE ; 01/22/2014
1.0; VEFA ALRE ;**1,4**;MAY 2011;Build 1
Per VHA Directive 2004-038, this routine should not be modified.
</Description>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>63685,68251.604529</TimeChanged>
<TimeCreated>63207,79067.664328</TimeCreated>

<Method name="FillGrid">
<Description><![CDATA[
Provide Alert Cache data for HTML Grid element and
Provide select options to Order Provider, Service, Patient, and Follow-up > 7 days]]></Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	W "<script type='text/javascript'>"
	W "  var mydata = ["
	;	
	;Get Alert Cache based on key, provider, service and FOllow-up > 7 days criteria
	N USERNAME S USERNAME=%session.Data("username",1)
	N DUZ S DUZ=%session.Data("DUZ",1)
	N PROV S PROV=..UnescapeURL(%request.GetCookie("selOrdPrvd"))
	N SERV S SERV=..UnescapeURL(%request.GetCookie("selService"))
	N CLN S CLN=..UnescapeURL(%request.GetCookie("selClinic"))
	N PAT S PAT=..UnescapeURL(%request.GetCookie("selPatient"))
	N FOLLOWUP S FOLLOWUP=..UnescapeURL(%request.GetCookie("selAlert"))
	N SELPROV,SELSERV,SELPAT,SELCLN,FACILITY
	N VEFARSLT S VEFARSLT=$NA(^TMP("VEFA.AlertCache",$J))
	D GETALCH^VEFAALC1(VEFARSLT,USERNAME,DUZ,.PROV,.SERV,.CLN,.PAT,FOLLOWUP,.SELPROV,.SELSERV,.SELCLN,.SELPAT,.FACILITY)
	;D GETALCH^bt(VEFARSLT,USERNAME,DUZ,PROV,SERV,FOL7DAYS,.SELPROV,.SELSERV)
	;
	;send data to browser
	N ID S ID=""
	F  S ID=$O(@VEFARSLT@(ID)) Q:ID=""  W @VEFARSLT@(ID)
	;
	W "	 ];"
	W "  $('#txtUser').val('"_USERNAME_"');"
	W "  $('#txtFacility').val('"_FACILITY_"');"
	;
	;update provider selection options
	D ..WriteMultSelection(.SELPROV,.PROV,"#selOrdPrvd")
	;
	;update service selection options
	D ..WriteMultSelection(.SELSERV,.SERV,"#selService")
	;
	;update clinic selection options
	D ..WriteMultSelection(.SELCLN,.CLN,"#selClinic")
	;
	;update patient selection options
	D ..WriteMultSelection(.SELPAT,.PAT,"#selPatient")
	;
	;update Follow-up options
	N SEL S SEL=""
	S SELFOL("Yes")="Yes"
	S SELFOL("No")="No"
	D ..WriteSelection(.SELFOL,FOLLOWUP,"#selAlert")
	;
	;Hide provider selection if user is using provider own key
	N KEY D USRKEY^VEFAALR5(.KEY,DUZ)
	W "$.cookie('AlertKey','"_KEY_"');"
	;I KEY=1 D
	;. W "$('#lblOrdPrvd').hide();"
	;. W "$('#selOrdPrvd').next().hide();"
	;
	W "</script>"
]]></Implementation>
</Method>

<Method name="WriteSelection">
<Description>
Populate ELEMENT with select options (SELECT array)
Default selection with PROV</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>SELECT,PROV,ELEMENT</FormalSpec>
<Implementation><![CDATA[
	N SEL S SEL=""
	S SELECT("(All)")=""
	N ID S ID=""
	F  S ID=$O(SELECT(ID)) Q:ID=""  D
	. I ID=PROV S SEL=SEL_"<option value="""_ID_""" selected=""selected"">"_ID_"</option>"
	. I ID'=PROV S SEL=SEL_"<option value="""_ID_""">"_ID_"</option>"
	W "$('"_ELEMENT_"').html('"_SEL_"');"
]]></Implementation>
</Method>

<Method name="WriteMultSelection">
<Description>
Populate ELEMENT with select options (SELECT array)
Default selection with PROV</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>SELECT,LSTPROV,ELEMENT</FormalSpec>
<Implementation><![CDATA[
	N SEL S SEL=""
	S SELECT("(All)")=""
	N ID S ID=""
	F  S ID=$O(SELECT(ID)) Q:ID=""  D
	. I $D(LSTPROV(ID)) S SEL=SEL_"<option value="""_ID_""" selected=""selected"">"_ID_"</option>"
	. I '$D(LSTPROV(ID)) S SEL=SEL_"<option value="""_ID_""">"_ID_"</option>"
	W "$('"_ELEMENT_"').html('"_SEL_"');"
]]></Implementation>
</Method>
</Class>


<Class name="VEFA.AlertCacheDetail">
<Description>
WOIFO/BT - VEFA AWARE ALERT CACHE DETAIL API CALLED BY CSP FILE ; 01/22/2014
1.0; VEFA ALRE ;**1,4**;MAY 2011;Build 1
Per VHA Directive 2004-038, this routine should not be modified.
</Description>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>63426,48318.304539</TimeChanged>
<TimeCreated>63208,4165.91796</TimeCreated>

<Method name="Show">
<Description>
Populate HTML elements of Alert Cache Detail Form web page with Alert Cache data and
Populate HTML follow-up action Grid with Alert Cache Follow-up actions (multiple records)</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	D ..FillAlertCache()
	D ..FillFollowupActions()
]]></Implementation>
</Method>

<Method name="FillAlertCache">
<Description>
Populate HTML elements of Alert Cache Detail Form web page with Alert Cache data</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N FIELDS
	S FIELDS(.01)="txtAlertID"
	S FIELDS(1)="txtDate"
	S FIELDS(2)="txtFacility"
	S FIELDS(3)="txtService"
	S FIELDS(4)="txtOrderProvider"
	S FIELDS(5)="txtListValue"
	S FIELDS(6)="txtPatient"	
	S FIELDS(7)="txtCategory"
	S FIELDS(8)="txtType"
	S FIELDS(9)="txtVEFASYS"
	S FIELDS(10)="txtVEFAPROC"
	S FIELDS(11)="txtVEFADELETE"
	S FIELDS(12)="txtFATStatus"
	S FIELDS(13)="txtFATProvider"
	S FIELDS(14)="txtFollowupProvider"
	S FIELDS(15)="txtFollowupActions"
	S FIELDS(16)="txtClinic"
	S FIELDS(17)="txtPatientID"
	S FIELDS(18)="txtGeneratedBy"
	S FIELDS(19)="txtGeneratedByPersonCL"
	S FIELDS(20)="txtOrigStation"
	S FIELDS(21)="chkFol7D"
	S FIELDS(22)="chkAck7D"
	S FIELDS(23)="txtAlertValue"
	S FIELDS(24)="chkFol"
	S FIELDS(25)="txtOrigType"
	;
	N IENS S IENS=%request.GetCookie("ien")
	N DATA D GETDATA^VEFAALC1(.DATA,IENS)
	;
	W "<script type='text/javascript'>"
    W "$(function () {"
	;	
	N FLD F FLD=.01,1:1:14,16:1:20,23,25 W !,"$('#",FIELDS(FLD),"').val('",DATA(FLD),"');"
	N FLD F FLD=.01,1:1:14,16:1:20,23,25 W !,"$('#",FIELDS(FLD),"').parent().attr('title','",DATA(FLD),"');"
	W !,"$('#",FIELDS(24),"').attr('checked',",DATA(24),");"	
	W !,"$('#",FIELDS(21),"').attr('checked',",DATA(21),");"	
	W !,"$('#",FIELDS(22),"').attr('checked',",DATA(22),");"
	;
	W "});"
	W "</script>"
]]></Implementation>
</Method>

<Method name="FillFollowupActions">
<Description>
Populate HTML follow-up action Grid with Alert Cache Follow-up actions (multiple records)</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	W "<script type='text/javascript'>"
    W "$(function () {"
	W "  var mydata=["
	;
	N IENS S IENS=","_%request.GetCookie("ien")_","
	N DATA D GETFOL^VEFAALC1(.DATA,IENS)
	N ID S ID="" F  S ID=$O(DATA(ID)) Q:ID=""  W DATA(ID)
	;
	W "	];"
	W "for (var i=0; i <= mydata.length - 1; i++) {"
	W " $('#actionlist').jqGrid('addRowData', i + 1, mydata[i]);"
   	W "	}"
 	W "$('#actionlist').focus();"
    W "$('#actionlist').jqGrid('setSelection',1);"
	W "});"
	W "</script>"
]]></Implementation>
</Method>
</Class>


<Class name="VEFA.AlertCategory">
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>63713,68025.472064</TimeChanged>
<TimeCreated>63208,53292.598442</TimeCreated>

<Method name="DeleteAlertOptions">
<Description>
Provide HTML Delete Alert Select with Alert Category's Delete Alert Options</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N DELOPTS D GETDELOP^VEFAALC2(.DELOPTS) ;Get all Alert Category Delete Options
	N OPT S OPT=""
	F  S OPT=$O(DELOPTS(OPT)) Q:OPT=""  D
	. W "<option value='",DELOPTS(OPT)_"'>",DELOPTS(OPT),"</option>"
]]></Implementation>
</Method>

<Method name="NotfTypeOptions">
<Description>
Provide HTML Notification Type select with Alert Category's Notification Types</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N NOTFTYP D GETNOTF^VEFAALR4(.NOTFTYP)
	N NOTFI S NOTFI=""
	F  S NOTFI=$O(NOTFTYP(NOTFI)) Q:NOTFI=""  D
	. W "<option value=",NOTFI,">",NOTFTYP(NOTFI),"</option>"
]]></Implementation>
</Method>

<Method name="Save">
<Description>
Save Alert Category</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	;
	N RECORD S RECORD= ..UnescapeURL(%request.GetCookie("cat.record"))
	N NAME S NAME=$P(RECORD,"^")
	;
	D:NAME="" ##class(VEFA.Login).DisplayResult(0,"Invalid Name")
	QUIT:NAME=""
	;
	N TODO S TODO=%request.GetCookie("cat.todo")
	N IEN S IEN=$S(TODO="add":"",1:%request.GetCookie("cat.ien"))
	;
	N ERR,OK S OK=$$SAVE^VEFAALC2(TODO,IEN,RECORD,.ERR)
	D:'OK ##class(VEFA.Login).DisplayResult(0,ERR)
	QUIT:'OK
	;
	N TODODESC S TODODESC=$S(TODO="add":"added",1:$S(TODO="delete":"deleted",1:"updated"))
	D ##class(VEFA.Login).DisplayResult(1,"Alert Category is "_TODODESC_" successfully")
	I TODO="add",IEN D ##class(VEFA.Login).SetCookie("cat.ien",IEN)
]]></Implementation>
</Method>

<Method name="DisableControls">
<Description>
Disable all except description HTML Alert Category elements for non-programmer user</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	N DUZ S DUZ=(%session.Data("DUZ",1))
	QUIT:$$HASKBKEY^VEFAALR5(DUZ)
   	W "<script type='text/javascript'>"
	;W " $('#selNotfType').attr('disabled', 'disabled');"
	;W " $('#chkAction').attr('disabled', 'disabled');"
	;W " $('#selDelAlert').attr('disabled', 'disabled');"
    w "$('#selNotfType').css({ 'background-color': '#f5f5f5'});"
    w "$('#selDelAlert').css({ 'background-color': '#f5f5f5'});"
    w "$('#chkAction').css({ 'background-color': '#f5f5f5'});"
	w "$('select :selected').each(function() { $(this).parent().data('default',this);});"
	w "$('select').change(function(e) { $($(this).data('default')).prop('selected',true);});"
	W " $('#chkAction').click(function() { return false;} );"
	W "</script>"
]]></Implementation>
</Method>
</Class>


<Class name="VEFA.AlertType">
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>63718,55955.543283</TimeChanged>
<TimeCreated>63208,82670.891452</TimeCreated>

<Method name="Populate">
<Description>
Populate HTML Reminder Dialog elements with Alert type's Reminder information
Populate HTML Grid element with Order dialog (multiple records)
Populate HTML Grid element with Follow-up dialog (multiple records)
Populate HTML Grid element with Comments dialog (multiple records)</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	Q:##class(VEFA.Login).InvalidPage()
	;
	N TODO S TODO=%request.GetCookie("type.todo")
	;
	W "<script type='text/javascript'>"
	;
    D ##class(VEFA.Login).Selector("19008","#selAlertCat")
	;    
    I TODO="edit" D
	. D ..PopulateAlertTypeForm()
	. D ..FillAlertTypeText("ord", "19007.01", "fillOrdDlg", "OrdDlgData", "#listOrder")
	. D ..FillAlertTypeText("fol", "19007.02", "fillfollDlg", "follDlgData", "#listFol")
	. D ..FillAlertTypeText("cmt", "19007.03", "fillCmtDlg", "CmtDlgData", "#listCmt")
	. D ..FillFilterCodes("78.3", "fillDiagCodes", "diagCodeData", "#listIDC")
	. D ..FillFilterCodes("71.5", "fillStopCodes", "stopCodeData", "#listISC")
	I TODO="add" D ..PopulateEmptyAlertTypeForm()
    ;
    W "</script>"
]]></Implementation>
</Method>

<Method name="PopulateEmptyAlertTypeForm">
<Description>
Populate HTML Reminder Dialog elements with empty information during adding new record</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N FIELDS
	S FIELDS(.01)="txtName"
	S FIELDS(3)="txtRemDlg"
	S FIELDS(4)="txtTIU"
	S FIELDS(5)="selAlertCat"
	S FIELDS(9)="txtMnemonic"
	S FIELDS(10)="txtDescr"
	S FIELDS(11)="txtGenName"
	;
	W "function fillForm() {"
	N PAGE S PAGE=%request.GetCookie("fromPage")
	;
	I PAGE="saveAlertType" D
	. N REC S REC=..UnescapeURL(%request.GetCookie("type.record"))
	. W !,"$('#txtName').val('"_$P(REC,"^",1)_"');"
	. W !,"$('#txtRemDlg').val('"_$P(REC,"^",2)_"');"
	. W !,"$('#txtTIU').val('"_$P(REC,"^",3)_"');"
	. W !,"$('#selAlertCat').val('"_$P(REC,"^",4)_"');"
	. W !,"$('#dtInit').val('"_$P(REC,"^",5)_"');"
	. W !,"$('#txtMnemonic').val('"_$P(REC,"^",6)_"');"
	. W !,"$('#txtSite').val('"_$P(REC,"^",7)_"');"
	. N ACTIVE S ACTIVE=$S($P(REC,"^",8):"true",1:"false")
	. W "$('#chkActive').prop('checked',"_ACTIVE_");"
	. W !,"$('#txtDescr').val('"_$P(REC,"^",9)_"');"
	. W !,"$('#txtGenName').val('"_$P(REC,"^",10)_"');"
	I PAGE'="saveAlertType" D
	. N IDX F IDX=.01,3:1:5,9,10 W !,"$('#",FIELDS(IDX),"').val('');"
	. W "$('#dtInit').val('');"
	. W "$('#chkActive').prop('checked',false);"
	;
	N SITE S SITE=$$GETSITE^VEFACSP1()
	W "$('#txtSite').val('",SITE,"');"
	W "}"
]]></Implementation>
</Method>

<Method name="PopulateAlertTypeForm">
<Description>
Populate HTML Reminder Dialog elements with Alert type's Reminder information</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N FIELDS
	S FIELDS(.01)="txtName"
	S FIELDS(3)="txtRemDlg"
	S FIELDS(4)="txtTIU"
	S FIELDS(5)="selAlertCat"
	S FIELDS(9)="txtMnemonic"
	S FIELDS(10)="txtDescr"
	S FIELDS(11)="txtGenName"
	S FIELDS(16)="rbIDC"
	S FIELDS(17)="rbISC"
	S FIELDS(18)="rbRpt"
	S FIELDS(19)="rbImp"
	;	
	N IENS S IENS=%request.GetCookie("type.ien")
	N REC,DTINIT,ACTIVE,SITE,RPTTXT,IMPTXT
	D GETATFRM^VEFAKB02(.REC,IENS_",",.DTINIT,.ACTIVE,.SITE) ;get Alert Type info and stored in VEFARSLT
	D GETTEXT^VEFAKB03(IENS,19007.014,.RPTTXT) ;get Report Text filter
	D GETTEXT^VEFAKB03(IENS,19007.015,.IMPTXT) ;get Impression text filter
	;
	W "function fillForm() {"
	N IDX
	F IDX=.01,3:1:5,9:1:11 W !,"$('#",FIELDS(IDX),"').val('",REC(IDX),"');"
	F IDX=16:1:19 W "$(""input[name='"_FIELDS(IDX)_"'][value='"_REC(IDX)_"']"").prop('checked',true);"
	W "$('#dtInit').val('",DTINIT,"');"
	W "$('#dtInit').attr('readonly',true);"
	W "$('#chkActive').prop('checked',",ACTIVE,");"
	W "$('#txtSite').val('",SITE,"');"
	W "$('#txtRpt').val('",RPTTXT,"');"
	W "$('#txtImp').val('",IMPTXT,"');"
	W "}"
]]></Implementation>
</Method>

<Method name="FillAlertTypeText">
<Description>
Populate HTML Grid element with Order, Followup, or comments dialog (multiple records)</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>PREFIX,FILE,FUNC,DATANM,GRIDNM</FormalSpec>
<Implementation><![CDATA[
	N IENS S IENS=","_%request.GetCookie("type.ien")_","
	N DATA D GETATLST^VEFAKB02(.DATA,FILE,IENS)
	;	
	W "function ",FUNC,"() {"
	W "  var ",DATANM," = ["
	N IDX S IDX="" F  S IDX=$O(DATA(IDX)) Q:IDX=""  W DATA(IDX)
	W "	];"
	;
	W "  for(var i=0;i<",DATANM,".length;i++)"
	W "    $('",GRIDNM,"').jqGrid('addRowData',i+1, ",DATANM,"[i]);"
	W "  if (",DATANM,".length>0) {"
	W "     $('",GRIDNM,"').focus();"
	W "     $('",GRIDNM,"').jqGrid('setSelection',1);"
	W "  }"
	W "}"
]]></Implementation>
</Method>

<Method name="FillFilterCodes">
<Description>
Populate HTML Grid element with Filter Diag/Stop Codes (multiple records)</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>FILE,FUNC,DATANM,GRIDNM</FormalSpec>
<Implementation><![CDATA[
	N IENS S IENS=","_%request.GetCookie("type.ien")_","
	N DATA D GETCODES^VEFAKB03(.DATA,FILE,IENS)
	;	
	W "function ",FUNC,"() {"
	W "  var ",DATANM," = ["
	N IDX S IDX="" F  S IDX=$O(DATA(IDX)) Q:IDX=""  W DATA(IDX)
	W "	];"
	;
	W "  for(var i=0;i<",DATANM,".length;i++)"
	W "    $('",GRIDNM,"').jqGrid('addRowData',i+1, ",DATANM,"[i]);"
	W "  if (",DATANM,".length>0) {"
	W "     $('",GRIDNM,"').focus();"
	W "     $('",GRIDNM,"').jqGrid('setSelection',1);"
	W "  }"
	W "}"
]]></Implementation>
</Method>

<Method name="Save">
<Description>
Save or Delete Alert Type and return result web page</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	;
	N TODO S TODO=%request.GetCookie("type.todo")
	I TODO="copy" D ..CopyAlertType() QUIT
	I TODO="delete" D ..DeleteAlertType() QUIT
	;
	; -- Add/Edit
	N OK S OK=..SaveReminderDlg()
	I OK D ..UpdateInitDate()
	I 'OK D ..DeactivateAlertType()
]]></Implementation>
</Method>

<Method name="CopyAlertType">
<Description>
Copy Alert Type and return result web page</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N TYPIEN S TYPIEN=%request.GetCookie("type.ien")
	N OK,MSG S OK=$$CPYALTYP^VEFAKB02(TYPIEN,.MSG)
	D ##class(VEFA.Login).DisplayResult(OK, MSG)
]]></Implementation>
</Method>

<Method name="DeleteAlertType">
<Description>
Delete Alert Type and return result web page</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N TYPIEN S TYPIEN=%request.GetCookie("type.ien")
	N OK,MSG S OK=$$DELALTYP^VEFAKB02(TYPIEN,.MSG)
	D ##class(VEFA.Login).DisplayResult(OK, MSG)
]]></Implementation>
</Method>

<Method name="SaveReminderDlg">
<Description>
Save Alert Type's Reminder dialog section
Validate Alert Type  and return result web page
Display result web page</Description>
<ClassMethod>1</ClassMethod>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	N REC S REC=..UnescapeURL(%request.GetCookie("type.record"))
	N NAME S NAME=$P(REC,"^")
	N CAT S CAT=$P(REC,"^",4)
	;
	I NAME="" D ##class(VEFA.Login).DisplayResult(0, "Invalid Alert Type")
	QUIT:NAME="" 0
	;	
	I CAT="" D ##class(VEFA.Login).DisplayResult(0, "Invalid Alert Category")
	QUIT:CAT="" 0
 	;
 	N OVERLMT S OVERLMT=$L(CAT)+$L(NAME)+1>51
 	I OVERLMT D ##class(VEFA.Login).DisplayResult(0, "The Length of Alert Type and Alert Category names cannot be greater than 50 characters")
 	QUIT:OVERLMT 0
	;
	N MSG,IEN S IEN=..FileAlertType(REC,.MSG)
    I IEN="" D ##class(VEFA.Login).DisplayResult(0,MSG)
    QUIT:IEN="" 0
    ;
	I NAME="@" D ##class(VEFA.Login).DisplayResult(1,MSG)
	QUIT:NAME="@" 1
	;
	D ##class(VEFA.Login).SetCookie("type.ien",IEN)
	N ER,VALID S VALID=..ValidateAlertType(NAME,.ER)
	;
	N RSLT S RSLT=$S(VALID:MSG,1:ER)
	D ##class(VEFA.Login).DisplayResult(VALID,RSLT)
	D ##class(VEFA.Login).SetCookie("updateResult",RSLT)
	;
	N TODO S TODO=%request.GetCookie("type.todo")
	I 'VALID,TODO="add" D 
	. D ##class(VEFA.Login).SetCookie("type.todo","edit")
	. D ##class(VEFA.Login).SetCookie("type.id","")
	;
	QUIT VALID
]]></Implementation>
</Method>

<Method name="FileAlertType">
<Description>
Save Alert Type's Reminder dialog section and return error message if failed</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec><![CDATA[RECORD:%String,&MSG:%String]]></FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	S MSG=""
	N NAME S NAME=$P(RECORD,"^")
	QUIT:NAME="" "Invalid Alert Type"
	N CAT S CAT=$P(RECORD,"^",4)
	QUIT:CAT="" "Invalid Alert Category"
	;
	N TODO S TODO=%request.GetCookie("type.todo")
	N DBIEN S DBIEN=$$GETATIEN^VEFAKB02(NAME,CAT)
	N FILE S FILE=19007
	N IEN
	;
	I TODO="edit" D
	. S IEN=%request.GetCookie("type.ien")
	. I DBIEN,IEN'=DBIEN S MSG=NAME_"/"_CAT_" Alert Type/Alert Category combination already exist!"
	I TODO="add" D
	. S IEN="+1"
	. I DBIEN S MSG=NAME_"/"_CAT_" Alert Type/Alert Category combination already exist!"
	;
	QUIT:(MSG'="") ""
	;			
	N OK S OK=$$SAVATFRM^VEFAKB02(TODO,FILE,IEN,RECORD,.MSG)
	I TODO="add" D
	. I OK D
	. . S IEN=$$GETATIEN^VEFAKB02(NAME,CAT)
	. . I IEN D ##class(VEFA.Login).SetCookie("type.ien",IEN)
	. I 'OK S IEN=""
	;
	QUIT IEN
]]></Implementation>
</Method>

<Method name="ValidateAlertType">
<Description>
Validate Alert Type and return result</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec><![CDATA[NAME:%String,&ER:%String]]></FormalSpec>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	D BASICCHK^VEFAALR4(.ER,NAME)
	QUIT (ER = "OK ALL VALIDITY CHECKS PASSED")
]]></Implementation>
</Method>

<Method name="SaveDlgForm">
<ClassMethod>1</ClassMethod>
<FormalSpec>FROMPAGE,PREFIX,FILE,FILEIDX</FormalSpec>
<Implementation><![CDATA[
	N OK S OK=..SaveOrderDlg(FROMPAGE, PREFIX, FILE, FILEIDX)
	D:'OK ..DeactivateAlertType()
]]></Implementation>
</Method>

<Method name="DeleteDlgForm">
<ClassMethod>1</ClassMethod>
<FormalSpec>FROMPAGE,PREFIX,FILE,FILEIDX</FormalSpec>
<Implementation><![CDATA[
	N OK S OK=..DeleteOrderDlg(PREFIX, FILE)
	D:'OK ..DeactivateAlertType()
]]></Implementation>
</Method>

<Method name="DeactivateAlertType">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N REC S REC=..UnescapeURL(%request.GetCookie("type.record"))
	N NAME S NAME=$P(REC,"^")
	D INACTV^VEFAKB02(NAME)
]]></Implementation>
</Method>

<Method name="UpdateInitDate">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N REC S REC=..UnescapeURL(%request.GetCookie("type.record"))
	N NAME S NAME=$P(REC,"^")
	D UPINITDT^VEFAKB02(NAME)
]]></Implementation>
</Method>

<Method name="SaveOrderDlg">
<ClassMethod>1</ClassMethod>
<FormalSpec>FROMPAGE,PREFIX,FILE,FILEIDX</FormalSpec>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	N TYPEIEN S TYPEIEN=%request.GetCookie("type.ien")
	N RECORD S RECORD=..UnescapeURL(%request.GetCookie("type.record"))
	N NAME S NAME=$P(RECORD,"^",1)
	;
	N MSG,IEN S IEN=..FileAlertType(RECORD,.MSG)
	I IEN="" D ##class(VEFA.Login).DisplayResult(0,MSG)
	QUIT:IEN="" 0
	;
	D ##class(VEFA.Login).SetCookie("type.ien",IEN)
	S IEN=..SaveDialogText(FROMPAGE,TYPEIEN,PREFIX,FILE,FILEIDX,.MSG)
	I 'IEN D ##class(VEFA.Login).DisplayResult(0,MSG)
	QUIT:'IEN 0
	;
	N ER,VALID S VALID=..ValidateAlertType(NAME,.ER)
	S RSLT=$S(VALID:MSG,1:ER)
	;
	N REQ S REQ=%request.GetCookie(PREFIX_".form")
	D ##class(VEFA.Login).DisplayResult(VALID,RSLT)
	D ##class(VEFA.Login).SetCookie("updateResult",RSLT)
	;
	QUIT VALID
]]></Implementation>
</Method>

<Method name="DeleteOrderDlg">
<ClassMethod>1</ClassMethod>
<FormalSpec>PREFIX,FILE</FormalSpec>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	N TYPEIEN S TYPEIEN=%request.GetCookie("type.ien")
	N ORDIEN S ORDIEN=%request.GetCookie(PREFIX_".ien")
	N MSG S MSG=$$DELORDLG^VEFAKB02(FILE,TYPEIEN,ORDIEN)
	D ##class(VEFA.Login).DisplayResult(0,MSG)
	QUIT 0
]]></Implementation>
</Method>

<Method name="SaveDialogText">
<ClassMethod>1</ClassMethod>
<FormalSpec><![CDATA[FROMPAGE,TYPEIEN,PREFIX,FILE,FILEIDX,&MSG]]></FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	S MSG=""
	N RECORD S RECORD=..UnescapeURL(%request.GetCookie("dlg.record"))
	N NAME S NAME=$P(RECORD,"^",1)
	;
	I NAME="" S MSG="Invalid Name!"
	QUIT:NAME="" ""
	;
	N DBIEN S DBIEN=$$GTDLGIEN^VEFACSP1(TYPEIEN,FILEIDX,NAME)
	N TODO S TODO=%request.GetCookie(PREFIX_".todo")
	N IEN S IEN=""
	;
	I TODO="edit" D
	. S IEN=%request.GetCookie(PREFIX_".ien")
	. I DBIEN,IEN'=DBIEN S MSG=" Alert Type: "_NAME_" exists!",IEN=""
	I TODO="add",DBIEN S MSG="Alert Type: "_NAME_" exists!"
	QUIT:(MSG'="") ""
	;
	N OK S OK=$$SAVDLG^VEFAKB02(TODO,FILE,RECORD,TYPEIEN,FILEIDX,.IEN,.MSG)
	I OK,TODO="add" D ##class(VEFA.Login).SetCookie(PREFIX_".ien",IEN)
	;	
	QUIT IEN
]]></Implementation>
</Method>

<Method name="AddFilterCode">
<ClassMethod>1</ClassMethod>
<FormalSpec>FILE,CODE</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	N REC S REC=..UnescapeURL(%request.GetCookie("type.record"))
	N NAME S NAME=$P(REC,"^")
	QUIT:NAME="" "Save Alert Type before adding Filter! "
	;
	N TYPEIEN S TYPEIEN=%request.GetCookie("type.ien")
	N MSG S MSG=$$ADDCODE^VEFAKB03(TYPEIEN,FILE,CODE)
	QUIT MSG
]]></Implementation>
</Method>

<Method name="DeleteFilterCode">
<ClassMethod>1</ClassMethod>
<FormalSpec>FILE,CODE</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	N TYPEIEN S TYPEIEN=%request.GetCookie("type.ien")
	N MSG S MSG=$$DELCODE^VEFAKB03(TYPEIEN,FILE,CODE)
	QUIT MSG
]]></Implementation>
</Method>
</Class>


<Class name="VEFA.KBEditorMain">
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>63713,68004.573968</TimeChanged>
<TimeCreated>63208,39489.296087</TimeCreated>

<Method name="FillGrids">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	D ..FillAlertCategory()
	D ..FillAlertType()
]]></Implementation>
</Method>

<Method name="FillAlertCategory">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	W "<script type='text/javascript'>"
	W "$(function () {"
	W "  var mydata = ["
	;
	N DATA D GETALCAT^VEFAKB01(.DATA)
	N ID S ID="" F  S ID=$O(DATA(ID)) Q:ID=""  W DATA(ID)
	;
	W "	];"
	;
	N USERNAME S USERNAME=%session.Data("username",1)
	N DUZ S DUZ=%session.Data("DUZ",1)
	W " $('#txtUser').val('"_USERNAME_ "');"
	W " for(var i=0;i<=mydata.length;i++) $('#listCat').jqGrid('addRowData',i+1,mydata[i]);"
	W " $('#listCat').focus();"
	;
	N ID S ID=%request.GetCookie("cat.id")
	S:ID="" ID=1
	W " $('#listCat').jqGrid('setSelection','"_ID_"');"
	I '$$HASKBKEY^VEFAALR5(DUZ) D
	. W " $('#add').addClass('ui-state-disabled');"
	. W " $('#lblAdd').hide();"
	W "});"
	W "</script>"
]]></Implementation>
</Method>

<Method name="FillAlertType">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	W "<script type='text/javascript'>"
	W "$(function () {"
	W "  var mydata = ["
	;
	N DATA D GETALTYP^VEFAKB01(.DATA)
	N ID S ID="" F  S ID=$O(DATA(ID)) Q:ID=""  W DATA(ID)
	;
	W "	];"
	;
	w " for(var i=0;i<=mydata.length;i++) $('#listType').jqGrid('addRowData',i+1,mydata[i]);"
	w " $('#listType').focus();"
	;
	N ID S ID=%request.GetCookie("type.id")
	S:ID="" ID=1
	W " $('#listType').jqGrid('setSelection','"_ID_"');"
	W "});"
	W "</script>"
]]></Implementation>
</Method>
</Class>


<Class name="VEFA.Login">
<Description>
WOIFO/BT - VEFA AWARE COMMON AND LOGIN API CALLED BY CSP FILE ; 01/22/2014
1.0; VEFA ALRE ;**1,4**;MAY 2011;Build 1
Per VHA Directive 2004-038, this routine should not be modified.
</Description>
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>63713,66368.303232</TimeChanged>
<TimeCreated>63207,57492.688288</TimeCreated>

<Method name="SaveAV">
<Description>
Encrypt Access and Verify codes and save them as session variables</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>ACCESS,VERIFY</FormalSpec>
<Implementation><![CDATA[
	S %session.Data("access",1)=..Encrypt(ACCESS)
	S %session.Data("verify",1)=..Encrypt(VERIFY)
]]></Implementation>
</Method>

<Method name="WarnUser">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	S WARNMIN=5
	S TIMEOUT=%session.AppTimeout
	S WARNED=%session.Data("hasBeenWarned",1)
	S DIFF=$zh-%session.Data("startTimeOut",1)
	;w "alert('diff="_diff_" timeOut="_timeOut_"');"
	I 'WARNED D
	. I DIFF>(TIMEOUT-(WARNMIN*60)) D
	. . S %session.Data("hasBeenWarned",1)=1
	. . W "timeoutWarning("_WARNMIN_");"
	I WARNED D
	. I DIFF>TIMEOUT D
	. . S %session.EndSession=1
	. .	W "window.location = 'logoff.csp';"
]]></Implementation>
</Method>

<Method name="ResetSession">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	S TIMEOUT=%session.AppTimeout
	S DIFF=$zh-%session.Data("startTimeOut",1)
	;
	I DIFF>TIMEOUT D
	. S %session.EndSession=1
	. W "window.location = 'logoff.csp';"
	I DIFF'>TIMEOUT D
	. S %session.Data("hasBeenWarned",1)=0
	. S %session.Data("startTimeOut",1)=$zh
	. W "intervalID = window.setInterval(checkTimeout,60000);"
]]></Implementation>
</Method>

<Method name="LoginAlertCache">
<Description>
Authenticate Access/Verify codes, Login to VistA and fill Web Page with Alert Cache</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	Q:'..GetAccessVerifyCodes()
	;
	N ACCESS S ACCESS=(%session.Data("access",1))
	S ACCESS=..Decrypt(ACCESS)
	N VERIFY S VERIFY=(%session.Data("verify",1))
	S VERIFY=..Decrypt(VERIFY)
	;	
	D ##class(VEFA.Login).Env()
	N DUZ,MSG S DUZ=$$GETDUZ^VEFACSP1(ACCESS,VERIFY,.MSG)
	;
	I 'DUZ D ..AccessError("alertcache.csp",MSG)
	I DUZ D
	. S %session.Data("login",1)=2
	. S %session.Data("username",1)=$$GETNAME^VEFACSP1(DUZ)
	. S %session.Data("DUZ",1)=DUZ
	. I $D(%session.Data("saveAV",1)),%session.Data("saveAV",1) D ..SaveAVDUZ(DUZ,ACCESS,VERIFY)
	. D ##class(VEFA.AlertCache).FillGrid()
	D BYE^XUSCLEAN
]]></Implementation>
</Method>

<Method name="SaveAVDUZ">
<ClassMethod>1</ClassMethod>
<FormalSpec>DUZ,ACCESS,VERIFY</FormalSpec>
<Implementation><![CDATA[
	W "<script>"
	N AVDUZVAL S AVDUZVAL=$SYSTEM.Encryption.AESCBCEncrypt(ACCESS_"^"_VERIFY_"^"_DUZ,"$@W@R3$")
	S AVDUZVAL=$SYSTEM.Encryption.Base64Encode(AVDUZVAL)
	N AVDUZ S AVDUZ="AC"_DUZ
	W "$.cookie('"_AVDUZ_"','"_AVDUZVAL_"',{ expires : (new Date()).getDate() + 900});"
	W "</script>"
]]></Implementation>
</Method>

<Method name="LoginKBEditor">
<Description>
Authenticate Access/Verify codes, Login to VistA and if successful login,
fill Web Page with Alert Categories and Alert Types</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	Q:'..GetAccessVerifyCodes()
	;
	N ACCESS S ACCESS=(%session.Data("access",1))
	S ACCESS=..Decrypt(ACCESS)
	N VERIFY S VERIFY=(%session.Data("verify",1))
	S VERIFY=..Decrypt(VERIFY)
	;	
	D ##class(VEFA.Login).Env()
	N DUZ,MSG S DUZ=$$GETDUZ^VEFACSP1(ACCESS,VERIFY,.MSG)
	;
	I 'DUZ D ..AccessError("kbeditor.csp",MSG)
	I DUZ D
	. N HASKBKEY S HASKBKEY=$$HASKBKEY^VEFAALR5(DUZ)
	. I HASKBKEY D
	. . S %session.Data("login",1)=2
	. . S %session.Data("username",1)=$$GETNAME^VEFACSP1(DUZ)
	. . S %session.Data("DUZ",1)=DUZ
	. . D ##class(VEFA.KBEditorMain).FillGrids()
	. I 'HASKBKEY D
	. . W "<script>"
	. . W "$('#form1').hide();"
	. . W "alert('Security Key is required to access KB Editor!');"
	. . W "window.location = 'kbeditor.csp';"
	. . W "</script>"
	D BYE^XUSCLEAN
]]></Implementation>
</Method>

<Method name="GetAccessVerifyCodes">
<Description>
Check if the session contains access/verify codes, this prevents user avoiding Login Page</Description>
<ClassMethod>1</ClassMethod>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	N OK S OK=0
	I $D(%session.Data("access",1)),$D(%session.Data("verify",1)) S OK=1
	D:'OK ..AccessError("","Not a Valid ACCESS CODE/VERIFY CODE pair.")
	QUIT OK
]]></Implementation>
</Method>

<Method name="KillSession">
<Description>
Kill Session upon logoff</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N DUZ S DUZ=$G(%session.Data("DUZ",1))
	K %session.Data
	s %session.EndSession=1
]]></Implementation>
</Method>

<Method name="AccessError">
<Description>
Show page with Access error - called by login web page</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>CSP,MSG</FormalSpec>
<Implementation><![CDATA[
	W "<script>"
	W "$('#form1').hide();"
	W "alert('"_MSG_"');"
	I CSP="" W "window.close();"
	I CSP'="" W "window.location = '",CSP,"';"
	W "</script>"
]]></Implementation>
</Method>

<Method name="ShowEnv">
<Description>
Show Local VistA Environment variables - called by login web page</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	D ..Env()
	W "<script>"
	N VER S VER="Version: 1.1.9 Build 20150610.1"
	N ENV S ENV="[ VistA Server: "_%session.Data("server",1)_" ]"
	S ENV=ENV_" [ UCI: "_%session.Data("UCI",1)_" ]"
	S ENV=ENV_" [ Volume: "_%session.Data("volume",1)_" ]"
	S ENV=ENV_" [ Production Account: "_$s(%session.Data("production",1):"Yes",1:"No")_" ]"
	W "   $('#ver').text('"_VER_"');"
	W "   $('#env').text('"_ENV_"');"
	W "</script>"
]]></Implementation>
</Method>

<Method name="Env">
<Description>
Get Local VistA Environment variables and save into session</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N SERVER,VOLBOX,UCI,PROD
	D GETENV^VEFACSP1(.SERVER,.VOLBOX,.UCI,.PROD) ;get environment vars
	S %session.Data("server",1)=SERVER
	S %session.Data("volume",1)=VOLBOX
	S %session.Data("UCI",1)=UCI
	S %session.Data("production",1)=PROD
]]></Implementation>
</Method>

<Method name="quote">
<Description>
Transform string with the equivalent HTML string</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>STR:%String</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[	Q $$QUOTE^VEFACSP1(STR)
]]></Implementation>
</Method>

<Method name="InvalidPage">
<Description>
Check if user CAP page request is valid. This prevents user avoiding login page</Description>
<ClassMethod>1</ClassMethod>
<ReturnType>%Boolean</ReturnType>
<Implementation><![CDATA[
	N INVALID S INVALID=0
	N LOGIN S LOGIN=$D(%session.Data("login",1))
	;
	I LOGIN<1 D
	. W "<script>"
	. W "alert('Invalid Page!');"
	. W "window.close();"
	. W "</script>"
	. S INVALID=1
	;	
	Q INVALID
]]></Implementation>
</Method>

<Method name="DisplayResult">
<Description>
Display Confirmation dialog after save</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>SUCCESS:%Boolean,MSG:%String</FormalSpec>
<Implementation><![CDATA[
	W "<script>"
	W "$(function () {"
	W "$('#savedialog').text('",..quote(MSG),"');"
	W:SUCCESS "successDlg();"
	W:'SUCCESS "failDlg();"
	W "});"
	W "</script>"
]]></Implementation>
</Method>

<Method name="SetCookie">
<Description>
Dynamically set cookie </Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>COOKIE,VALUE</FormalSpec>
<Implementation><![CDATA[
	W "<script>"
	W "$.cookie('",COOKIE,"','",VALUE,"')"
	W "</script>"
]]></Implementation>
</Method>

<Method name="Selector">
<Description>
Get name values of a FILE and fill select options </Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>FILE:%String,ELEMENT:%String</FormalSpec>
<Implementation><![CDATA[
	N NAMES D GETNAMES^VEFACSP1(.NAMES,FILE)
	D ..FillOptions(.NAMES,ELEMENT)
]]></Implementation>
</Method>

<Method name="FillOptions">
<Description>
Fill select options on HTML element</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>NAMES,ELEMENT:%String</FormalSpec>
<Implementation><![CDATA[
	N NAME S NAME=""
	;	
	F  S NAME=$O(NAMES(NAME)) Q:NAME=""  D
	. W "var sel = $('",ELEMENT,"');"
	. W "var temp = new Option('",NAME,"','",NAME,"');"
	. W "sel[0].options[sel[0].options.length] = temp;"
]]></Implementation>
</Method>

<Method name="CheckParam">
<ClassMethod>1</ClassMethod>
<FormalSpec>PARAM:%String,AVDUZVAL:%String</FormalSpec>
<Implementation><![CDATA[
	S %session.Data("saveAV",1)=(PARAM'="")
	QUIT:PARAM=""
	N DUZ S DUZ=$P(PARAM,"=",2)
	QUIT:AVDUZVAL=""
	;
	S AVDUZVAL=$SYSTEM.Encryption.Base64Decode(AVDUZVAL)
	S AVDUZVAL=$SYSTEM.Encryption.AESCBCDecrypt(AVDUZVAL,"$@W@R3$")
	;
	N ACCESS S ACCESS=$P(AVDUZVAL,"^")
	N VERIFY S VERIFY=$P(AVDUZVAL,"^",2)
	N SAVDUZ S SAVDUZ=$P(AVDUZVAL,"^",3)
	QUIT:DUZ'=SAVDUZ
	;
	N MSG,VISTADUZ S VISTADUZ=$$GETDUZ^VEFACSP1(ACCESS,VERIFY,.MSG) ;Get DUZ based on Access and Verify codes
	QUIT:MSG'=""
	QUIT:DUZ'=VISTADUZ
	;
	S %session.Data("saveAV",1)=0
	D ..SaveAV(ACCESS,VERIFY)
	W "showAlertCache();"
]]></Implementation>
</Method>
</Class>


<Class name="VEFA.OrderDialog">
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>63517,46198.283024</TimeChanged>
<TimeCreated>63209,53630.217153</TimeCreated>

<Method name="FillOrderDlg">
<Description>
Populate Order Dialog Form Web Page with Alert Type's order dialog group information</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	;
	N TODO S TODO=%request.GetCookie("ord.todo")
	;
	W "<script type='text/javascript'>"
    ;
    D ..FillPackage()
	;
	I TODO="edit" D ..PopulateDlgTxtForm("ord",19007.01)
	I TODO="add" D ..PopulateEmptyDlgTxtForm()
	;    
    W "</script>"
]]></Implementation>
</Method>

<Method name="FillPackage">
<Description>
Fill HTML Package select element</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
    ;D ##class(VEFA.Login).Selector(9.4,"#selOrdDlgPkg")
	N PKG
	S PKG("CONSULT/REQUEST TRACKING")=""
	S PKG("IMAGING")=""
	S PKG("LAB SERVICE")=""
	S PKG("MEDICINE/CARDIOLOGY")=""
	
	S PKG("MENTAL HEALTH")=""
	S PKG("NUCLEAR MEDICINE")=""
	S PKG("ONCOLOGY")=""
	S PKG("OUTPATIENT PHARMACY")=""

	S PKG("PCE PATIENT CARE ENCOUNTER")=""
	S PKG("PHARMACY")=""
	S PKG("PRMR")=""
	S PKG("PROSTHETICS")=""
	
	S PKG("RADIOLOGY/NUCLEAR MEDICINE")=""
	S PKG("REHAB MEDICINE")=""
	S PKG("SCHEDULING")=""
	S PKG("SURGERY")=""
	
	S PKG("UNIT DOSE MEDICATIONS")=""
	S PKG("WOMEN\'S HEALTH")=""
	S PKG("CLINICAL PROCEDURES")=""
	
	D ##class(VEFA.Login).FillOptions(.PKG,"#selOrdDlgPkg")
]]></Implementation>
</Method>

<Method name="FillFollowupDlg">
<Description>
Populate Followup Dialog Form Web Page with Alert Type's Follow-up dialog group information</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	;
	N TODO S TODO=%request.GetCookie("fol.todo")
	;
	W "<script type='text/javascript'>"
    ;
    D ..FillPackage()
	;
	I TODO="edit" D ..PopulateDlgTxtForm("fol",19007.02)
	I TODO="add" D ..PopulateEmptyDlgTxtForm()
	;    
    W "</script>"
]]></Implementation>
</Method>

<Method name="FillCommentDlg">
<Description>
Populate Comment Dialog Form Web Page with Alert Type's Comment dialog group information</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	;
	N TODO S TODO=%request.GetCookie("cmt.todo")
	;
	W "<script type='text/javascript'>"
    ;
	D ..FillPackage()
	;
	I TODO="edit" D ..PopulateDlgTxtForm("cmt",19007.03)
	I TODO="add" D ..PopulateEmptyDlgTxtForm()
	;    
    W "</script>"
]]></Implementation>
</Method>

<Method name="PopulateEmptyDlgTxtForm">
<Description>
Populate Dialog's fields with empty values during adding a new record</Description>
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	N IEN S IEN=%request.GetCookie("type.ien")
	N RMDLG S RMDLG=$$GETNAME^VEFAKB01(IEN)
	W "function fillForm() {"
	W "  $('#txtReminderDlg').text('"_RMDLG_"');"
	W "  $('#txtName').val('');"
	W "  $('#selOrdItemDispGrp').val('');"
	W "  $('#txtOrgOrdDlgPkg').val('');"
	W "  $('#txtOrdItemName').val('');"
	W "  $('#selOrdDlgDispGrp').val('');"
	W "  $('#txtOrdDlg').val('');"
	W "  $('#txtAddFind').val('');"
 	W "  $('#selOrdDlgPkg').val('');"
	W "  $('#txtComment').val('');"
 	W "  $('#txtDesired').val('');"
	W "  $('#chkOrdItemReq').prop('checked',false);"
	W "  $('#txtAreaPrgNote').val('');"
	W "  $('#txtSeqNumber').val('');"
	W "}"
]]></Implementation>
</Method>

<Method name="PopulateDlgTxtForm">
<Description>
Populate Dialog's fields with Alert Type's dialog record during editing existing record</Description>
<ClassMethod>1</ClassMethod>
<FormalSpec>PREFIX,FILE</FormalSpec>
<Implementation><![CDATA[
	N FIELDS
	S FIELDS(.01)="txtName"
	S FIELDS(1)="txtOrdItemDispGrp"
	S FIELDS(.5)="txtOrdItemName"
	S FIELDS(2)="txtOrdDlgDispGrp"
	S FIELDS(1.5)="txtOrdDlg"
	S FIELDS(4)="txtAddFind"
	S FIELDS(3.5)="selOrdDlgPkg"
	S FIELDS(6)="txtComment"
	S FIELDS(.3)="txtDesired"
	S FIELDS(7)="txtOrgOrdDlgPkg"
	S FIELDS(.4)="txtSeqNumber"
	;	
	N IEN S IEN=%request.GetCookie("type.ien")
	N RMDLG S RMDLG=$$GETNAME^VEFAKB01(IEN)
	;
	N IENS s IENS = %request.GetCookie(PREFIX_".ien") _ "," _ IEN _ ","
	K REC
	N PRGNOTES
	D GETREC^VEFAKB01(.REC,FILE,IENS,.PRGNOTES)
	;
	W "function fillForm() {"
	W "  $('#txtReminderDlg').text('"_RMDLG_"');"
	;	
	N FLD F FLD=.01,1,.5,2,1.5,4,3.5,6,.3,7,.4 W !,"$('#",FIELDS(FLD),"').val('",REC(FLD),"');"
	;
	N ITMREQ S ITMREQ=REC(.7)
	S ITMREQ=$$JSBOOL^VEFACSP1(ITMREQ)
	W "$('#chkOrdItemReq').prop('checked',",ITMREQ,");"
	W "$('#txtAreaNote').html('",PRGNOTES,"');"
	W "}"
]]></Implementation>
</Method>

<Method name="SaveOrderDlg">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	N TODO S TODO=%request.GetCookie("ord.todo")
	I TODO="delete" D ##class(VEFA.AlertType).DeleteDlgForm("saveorderdlg", "ord", "19007.01", 1)
	I TODO'="delete" D ##class(VEFA.AlertType).SaveDlgForm("saveorderdlg", "ord", "19007.01", 1)
]]></Implementation>
</Method>

<Method name="SaveFollowupDlg">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	N TODO S TODO=%request.GetCookie("fol.todo")
	I TODO="delete" D ##class(VEFA.AlertType).DeleteDlgForm("savefoldlg", "fol", "19007.02", 2)
	I TODO'="delete" D ##class(VEFA.AlertType).SaveDlgForm("savefoldlg", "fol", "19007.02", 2)
]]></Implementation>
</Method>

<Method name="SaveCommentDlg">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	N TODO S TODO=%request.GetCookie("cmt.todo")
	I TODO="delete" D ##class(VEFA.AlertType).DeleteDlgForm("savecmtdlg", "cmt", "19007.03", 4)
	I TODO'="delete" D ##class(VEFA.AlertType).SaveDlgForm("savecmtdlg", "cmt", "19007.03", 4)
]]></Implementation>
</Method>

<Method name="SetSequenceNumber">
<ClassMethod>1</ClassMethod>
<FormalSpec>FILE,ALERTTYPE,ITEM</FormalSpec>
<Implementation><![CDATA[
	N SEQ S SEQ=$$GETSEQ2^VEFAKB01(FILE,ALERTTYPE,ITEM)
	I SEQ W "  $('#txtSeqNumber').val('"_SEQ_"');"
	I SEQ W "  $('#txtSeqNumber').focus();"
	I SEQ W "  $('#txtSeqNumber').select();"
]]></Implementation>
</Method>
</Class>


<Class name="VEFA.Search">
<ProcedureBlock>0</ProcedureBlock>
<Super>%CSP.Page</Super>
<TimeChanged>63498,66491.215155</TimeChanged>
<TimeCreated>63209,34709.790694</TimeCreated>

<Method name="Fill">
<ClassMethod>1</ClassMethod>
<Implementation><![CDATA[
	QUIT:##class(VEFA.Login).InvalidPage()
	;
	N FILE S FILE=%request.GetCookie("search.filenumber")
  	N SEARCH S SEARCH=..UnescapeURL(%request.GetCookie("search.value"))
  	N SCREEN S SCREEN=..UnescapeURL(%request.GetCookie("search.screen"))
	N ATYPE S ATYPE=%request.GetCookie("type.ien") //alert type ien
	N DLGFILE S DLGFILE=%request.GetCookie("search.dlgFile") //Dialog file 19007.01, 19007.02, 19007.03
	N DATA D GETSRCH^VEFACSP1(.DATA,FILE,SEARCH,SCREEN,ATYPE,DLGFILE)
	;
	W "<script type='text/javascript'>"
	W "function fillSearchValues() {"
	W "  var mydata = ["
	;
	N ID S ID="" F  S ID=$O(DATA(ID)) Q:ID=""  W DATA(ID)
	;
	W "	];"
	W " for(var i=0;i<mydata.length;i++) $('#listFile').jqGrid('addRowData',i+1,mydata[i]);"
	W " $('#listFile').focus();"
	W " $('#listFile').jqGrid('setSelection',1);"
	W "}"
	W "</script>"
]]></Implementation>
</Method>
</Class>


<CSP name="alertcache/alertcache.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE Alert Login</title>
	
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
	

    <style type="text/css">
	  h1 {
		  margin:0;
	  }
	  html, body {
	     margin: 20;
	     padding: 0;
	     font-size: 100%;
	  }

	  #access {
          width: 236px;
          margin-right: 71px;
      }
      #verify {
          width: 236px;
          margin-right: 71px;
      }
      
	  #Select1 {
          width: 241px;
      }
      
      #ok {
          Width: 80px;
      }
      
	  #ok:hover {
		   color: #0e1ed7;
	  }

	  #ok:focus {
		   color: #0e1ed7;
	  }

	  #TextArea1 {
          width: 400px;
      }

	  #TextAreaStatus {
          width: 399px;
      }

	  #TextAreaLegal {
          width: 397px;
          overflow-x: hidden;
          overflow-y: hidden;
      }
      
	</style>


    <link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />

	
	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
  	<script src="jquery.cookie.js"></script>
    <script src="jquery.ui.dialog.js"></script>

    <script>

	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

        $(function () {
	        window.onbeforeunload = function() {
				//#server(VEFA.Login.KillSession())#;
	        }
	        
            $("#ok")
              .button()
              .click(function () {
	              window.onbeforeunload = null;
				  #server(VEFA.Login.SaveAV($("#access").val(), $("#verify").val()))#;
	              showAlertCache();
              });
        });
        
        function showAlertCache() {
			$.cookie("fromPage", "logon");
            $.cookie("startMainTab", "#listCat");
            $.cookie("page",1);
		    $.cookie("rowid",1);
	        $.cookie("selOrdPrvd", "(All)");
	        $.cookie("selService", "(All)");
	        $.cookie("selClinic", "(All)");
	        $.cookie("selPatient", "(All)");
	        $.cookie("selAlert", "(All)");
            $.cookie("filter","");
            window.onbeforeunload = null;
            window.location = "showalertcache.csp";
        }

        function init() {
	        if (location.search !== "") {
		        var user = location.search.substr(1).split("=")[1];
		        var awarecred = $.cookie("AC"+user);
		        if (typeof(awarecred) == "undefined") {
			        awarecred = "";
		        } 
				#server(VEFA.Login.CheckParam(location.search,awarecred))#;
	        }
            $("#access").focus();
            $("#TextAreaLegal").val(
               "Unauthorized access or misuse of this system and/or its data is a federal crime. " +
              "Use of all data shall be in accordance with VA policy on security and privacy.");
	        $("#TextAreaLegal").css({ 'background-color': '#efefef', 'color': '#0e1ed7', 'font-size': '12px' });
        }
        
        var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}
        
  </script>
	
</head>
   
<BODY onload="init()">

 <center>


<FORM action="showalertcache.csp" method="post" id=form1 name=form1 class="ui-widget ui-state-default ui-corner-all" style="width:750px">
<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
        
		<td align="left">
			&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
	    	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
	    	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>

        <td align="right">
			<h1>VistA AWARE</h1>
			<h1>Alert Viewer</h1>
        </td>
        
    </table>
</div>
    <br />
    <br />


 	<table>

      <tr>
   	    <td align="right"><label for="access">Access Code</label></td>
        <td><input id="access" name="access" type="password" align="left" class="ui-widget ui-corner-all" /></td>
      </tr>

      <tr>
        <td align="right"><label for="verify">Verify Code</label></td>
        <td><input id="verify" name="verify" type="password" align="left" class="ui-widget ui-corner-all"/></td>
      </tr>

      <tr>
        <td align="right">&nbsp;</td>
        <td><input id='ok' name='ok' type='submit' value='Logon' 
                align="right"/>&nbsp &nbsp&nbsp;
        </td>
      </tr>
    </table>
    
    
	<div>
    <table>
      <tr align="left">
        <td>
      	<label for="TextAreaLegal" style="font-size:60%;">Warning</label>
        </td>
      </tr>
      <tr>
        <td>
        <textarea id="TextAreaLegal" name="TextAreaLegal" readonly="readonly" rows="3"
            style = "overflow-x: hidden; overflow-y: hidden;"
            class="ui-corner-all" >
        </textarea>
        </td>
      </tr>
    </table>
	</div>

    <br />
   	<label style="font-size:60%;" id="ver" name="ver">version</label>
   	<br />
   	<label style="font-size:60%;" id="env" name="env">env</label>
    
</FORM>

<script language="Cache" runat="server">
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
 	d ##class(VEFA.Login).ShowEnv()
</script>


</center>

    
</BODY>



</html>
]]></CSP>


<CSP name="alertcache/error.csp" application="/csp/aware/"><![CDATA[
<!-- Copyright (c) 2001 InterSystems Inc. ALL RIGHTS RESERVED. -->

<!-- All error pages MUST inherit from %CSP.Error -->
<csp:class super="%CSP.Error" description="PRIVATE:Demo of how to write an application error page">

<html>
<head>
</head>
<body bgcolor="#CCCCFF">

<!-- display standard sample template using a custom tag -->
<isc:SAMPLE title="Example application error page">
The sample demonstrates how to write your own application error
page.
</isc:SAMPLE>

<script language="Cache" method="OnPreHTTP" arguments="" returntype="%Boolean">
	Quit 1
</script>

<!-- The HyperEventError method is called when an error occurs while running -->
<!-- the hyperevent method. This should generate JavaScript back to the browser -->
<script language="Cache" method="HyperEventError" arguments="" returntype="">
	New ErrorInfo,ErrorNumber,message
	Do ..DecomposeError($get(%request.Data("Error:ErrorCode",1)),.ErrorInfo)
	Set message="Example HyperEvent Error Alert\n\n"
	For i=1:1:ErrorInfo {
		Set message=message_$ZCVT(ErrorInfo(i,"Desc"),"O","JS")_"\n"
		Set message=message_$ZCVT("    Error: "_ErrorInfo(i,"Error"),"O","JS")_"\n"
		If ErrorInfo(i,"ErrorNo")'=$$$ERRORCODE($$$CacheError),ErrorInfo(i,"ErrorNo")'=$$$ERRORCODE($$$FailedToCreateClass) Set message=message_$ZCVT("    ErrorNo: "_ErrorInfo(i,"ErrorNo"),"O","JS")_"\n"
		Set message=message_$ZCVT("    CSP Page: "_ErrorInfo(i,"URL"),"O","JS")_"\n"
		Set message=message_$ZCVT("    Namespace: "_ErrorInfo(i,"Namespace"),"O","JS")_"\n"
		Set message=message_$ZCVT("    Class: "_ErrorInfo(i,"Class"),"O","JS")_"\n"
		If $G(ErrorInfo(i,"Routine"))'="" {
			Set message=message_$ZCVT("    Routine: "_ErrorInfo(i,"Routine"),"O","JS")_"\n"
			Set message=message_$ZCVT("    Location: "_ErrorInfo(i,"Location"),"O","JS")_"\n"
			If $G(ErrorInfo(i,"Line"))'="" Set message=message_$ZCVT("    Line: "_ErrorInfo(i,"Line"),"O","JS")_"\n"
		}
		Set message=message_"\n"
	}
	Write "alert('",message,"');",!

	; As we are outputting JavaScript we can also do things like redirect the browser depending on the error.
	; For example if the session timed out, or was ended directly then when the user tries to go to a page
	; that contains encrypted data in the parameter they will get one of these two errors. If so we redirect
	; them to a login page.
	Set ErrorNumber=$get(%request.Data("Error:ErrorNumber",1))
	If ErrorNumber=$$$ERRORCODE($$$CSPSessionTimeout)!(ErrorNumber=$$$ERRORCODE($$$InvalidDecrypt)) {
		Write "CSPPage.window.location='logoff.csp'",!
	}
</script>

<script language="Cache" runat="server">
	&html<<p><p>>
	New ErrorInfo
	Do ..DecomposeError($get(%request.Data("Error:ErrorCode",1)),.ErrorInfo)
	Do ..DisplayError(.ErrorInfo)
	&html<<p><br>>
	; Call the inspector to display the objects associated with this request.
	; Note this is done inside the <body></body> tags.
	Do ##class(%CSP.Utils).DisplayAllObjects()
</script>

</body>
</html>
]]></CSP>


<CSP name="alertcache/logoff.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>VEFA AWARE Alert List</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript" src="jquery-ui.js"></script>
	<script type="text/javascript" src="jquery.cookie.js"></script>
	<script type="text/javascript" src="jquery.jqGrid.min.js"></script>


    <style type="text/css">
		h1 {
			margin:0;
	  	}
        .text-style {
	        color: #0e1ed7;
        }
        .link-style {
	        text-decoration: none;
        }
      
    </style>


	<script type="text/javascript">
	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = true;
		    if (event.keyCode === 8) {
        		event.preventDefault();
		    }
		});

	    $(function () {
		    $("#return").focus();
	        //var cookies = document.cookie.split(";");
	        //for (var i = 0; i < cookies.length; i++) {
	        //    var cookie = cookies[i];
	        //    var eqPos = cookie.indexOf("=");
	        //    var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
	        //    $.removeCookie(name);
	       // }
	    });

	</script>
     
     <script language="Cache" runat="server" >
       	d ##class(VEFA.Login).KillSession()
    </script>

	
</head>


<body>

<center>
<FORM id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:800px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE</h1>
			<h1>Alert Viewer </h1>
        </td>
    </table>
</div>


    <br />
    <br />


<div align="center" class="text-style">
	You have logged out of Alert Viewer.
</div>
    <br />
<div align="center">
	<a id="return" name="return" href="alertcache.csp" class="link-style"><u>Return to Alert Viewer Logon</u></a>    
</div>

    <br />
    <br />

</FORM>
 </center>

</body>


</html>
]]></CSP>


<CSP name="alertcache/showalertcache.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>VEFA AWARE Alert List</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="jquery.multiselect.css" />
	
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript" src="jquery-ui.js"></script>
	<script type="text/javascript" src="jquery.cookie.js"></script>
	<script type="text/javascript" src="grid.locale-en.js"></script>
	<script type="text/javascript" src="jquery.jqGrid.min-aware.js"></script>
	<script type="text/javascript" src="mousetrap.min.js"></script>
	<script type="text/javascript" src="jquery.multiselect.js"></script>

    <style type="text/css">
		h1 {
			margin:0;
	  	}

    	.ui-jqgrid tr.ui-row-ltr td {
			padding: 0 8px;
    	}
    	
		.ui-jqgrid tr.jqgrow td {
			word-wrap: break-word;
			white-space:normal !important;
    	}

		.ui-jqgrid .ui-widget-header {
			background: #0a1a4c;
		}
		
    	.auto-style1 {
            width: 423px;
        }
        #txtUser {
            width: 250px;
        }
        #txtFacility {
            width: 300px;
        }
        #txtConnection {
            width: 139px;
        }

	   #signout:hover {
		   color: #0e1ed7;
	   }

	   #signout:focus {
		   color: #0e1ed7;
	   }

       #selOrdPrvd {
	       width: 200px;
       	   overflow:hidden;
       }

       #selService {
	       width: 200px;
       	   overflow:hidden;
       }
       
       #selClinic {
	       width: 200px;
       	   overflow:hidden;
       }

       #selPatient {
	       width: 200px;
       	   overflow:hidden;
       }
       
       #selAlert {
	       width: 100px;
       	   overflow:hidden;
       }
       
    </style>


        
	<script type="text/javascript">

	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }

    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

		function NotNumber(str) {
			return ((str == "undefined") || (str == "") || isNaN(str));
	    }
	
	    $(function () {
		    var killSession = false;
		    
   	        window.onbeforeunload = function() {
	   	        if (killSession) {
					#server(VEFA.Login.KillSession())#;
	   	        }
	        }

			var jqGridRowNum = $.cookie("jqGrid.rowNum");
    	    if (NotNumber(jqGridRowNum)) {
	            jqGridRowNum = 20;
	        } else {
	            jqGridRowNum = parseInt(jqGridRowNum);
	        }

			function checkmark(cellValue, options, rowObject) {
				if (cellValue == "true") {
					return '&#10004;';
				} else {
					return '';
				}
			}
	        
			function uncheckmark(cellValue, options) {
				if (cellValue == "&#10004;") {
					return 'true';
				} else {
					return 'false';
				}
			}

			function colorDayCounter(cellValue, options, rowObject) {
				var dayColor = cellValue.split("-");
				var day = dayColor[0];
				var color = dayColor[1];
				if (color == "R") {
					return '<span style="font-weight:bold;color:red;">' + day + '</span>';
				} else if (color == "O") {
					return '<span style="font-weight:bold;color:orange;">' + day + '</span>';
				} else {
					return day;
				}
			}

	        $("#list").jqGrid({
		        data: mydata,
		        datatype: "local",
	            height: "auto", //250,
	            colNames: ['ID', 'Date', 'Patient Name', 'Patient ID', 'Alert ID', 'Service', 'Clinic', 'Provider', 'Alert Category', 'Alert Type', 'Follow-up', 'Day Counter'],

	            colModel: [
                { name: 'ien', index: 'ien', width: 60, sorttype: "int", hidden:true},
   		        { name: 'date', index: 'date', width: 120, sorttype:"date", formatter:"date",
   		          align: 'center',
   		          formatoptions: {srcformat: "Y-m-d h:i:s", newformat: "M d, Y H:i"}},
   		        { name: 'patient', index: 'patient', width: 150 },
                { name: 'l4ssn', index: 'l4ssn', width: 65, sorttype: "int", align:"right"},
                { name: 'alertid', index: 'alertid', width:100, hidden:true },
   		        { name: 'service', index: 'service', width: 130 },
   		        { name: 'clinic', index: 'clinic', width: 150 },
   		        { name: 'provider', index: 'provider', width: 150 },
   		        { name: 'alertcategory', index: 'alertcategory', width: 100, hidden:true },
   		        { name: 'alerttype', index: 'alerttype', width: 100 },
   		        { name: 'folup', index: 'folup', width: 80, 
   		        	align: 'center', editable: false,
					formatter:checkmark, unformat:uncheckmark
   		        },
   		        { name: 'fol7days', index: 'fol7days', width: 100, 
   		        	align: 'center', sorttype: 'int',
   		        	formatter:colorDayCounter,
   		        }
   		        ],
   		        multiSort: true,
                sortname: "date",
                sortorder: "asc",
				hidegrid: false,
	            pager: "#pager",
	            rowNum: jqGridRowNum,
	            rowList: [10, 20, 30, 40],
	            viewrecords: true,
	            gridview: true,
	            autoencode: true,
	            multiSelect: false,
	            caption: "AWARE Alerts",
	            ondblClickRow: function (rowId) {
	                showDetail();
	            },
	            loadComplete: function () {
					//var rowsPerPage = getGridSize();
	                //$("#list").jqGrid("setGridHeight", (rowsPerPage * 38), true); //470/2 = 235
	            }
	        })
	        .navGrid("#pager", { add: false, edit: false, del: false, refresh: false, search: false })
            .navButtonAdd("#pager", {
                caption: "Detail",
                buttonicon: "ui-icon-document",
                onClickButton: function () {
                    showDetail();
                },
                position: "last"
            });

			genToolTips();
			
            //$(".ui-pg-selbox").closest("td").before("<td dir='ltr'><label for='#pager .ui-pg-selbox'>Page Size</label></td>");
            $("#pager .ui-pg-selbox").prop("title","Select Page Size");
            $("#pager .ui-pg-selbox").prop("name","selPageSize");
            $("#pager .ui-pg-selbox").prop("id","selPageSize");
            $("#pager .ui-pg-input").prop("title","Enter Page Number");
            $("#pager .ui-pg-input").prop("name","SelPageNumber");
            $("#pager .ui-pg-input").prop("id","SelPageNumber");
            
			//$(".ui-jqgrid-titlebar-close").prop("title","Show/Close Content");
			//$(".ui-jqdialog-titlebar-close>span").removeClass("ui-icon ui-icon-closethick");
			$("#alertmod_list").remove();
		    
            $("#signout")
              .button()
              .click(function (event) {	
				killSession = false;
				var rowsPerPage = $("#list").getGridParam("rowNum");
                $.cookie("jqGrid.rowNum", rowsPerPage, { expires: 10000 });
                window.location = "logoff.csp";
              });

	        $("#list").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event

	        Mousetrap.bind('ctrl+alt+e', function (e) {
	            showDetail();
	        });

	        Mousetrap.bind('alt+g', function (e) {
				$("#list").focus();
	        	$("#list tr").eq(1).trigger("click");
	        });

	        Mousetrap.bind('ctrl+alt+n', function (e) {
				var rowNum = $("#list").getGridParam("rowNum");
				var allRecs = $("#list").getGridParam("records");
				var totalPages = parseInt((allRecs/rowNum) + 1);
				var page = $("#list").getGridParam("page");
				if (page+1 <= totalPages) {
		        	$("#list").setGridParam({ page: (page+1) }).trigger("reloadGrid");
					$("#list").focus();
	        		$("#list tr").eq(1).trigger("click");
				}
	        });

	        Mousetrap.bind('ctrl+alt+b', function (e) {
				var page = $("#list").getGridParam("page");
				if (page > 0) {
		        	$("#list").setGridParam({ page: (page-1) }).trigger("reloadGrid");
					$("#list").focus();
	        		$("#list tr").eq(1).trigger("click");
				}
	        });

	        Mousetrap.bind("ctrl+alt+x", function (e) {
		        window.location = "logoff.csp";
	        });
			
			var selOrdPrvdClose = true;
			var selOrdPrvdLast = "(All)";
			var selOrdPrvdPrev = $("#selOrdPrvd").find(":selected").text();
	        $("#selOrdPrvd").multiselect({
				selectedList: 10,
				close: function() {
					if (selOrdPrvdClose) {
			            $.cookie("filter","#selOrdPrvd")
			        	$.cookie("rowid",1)
						var selOrdPrvdCurrent = $("#selOrdPrvd").find(":selected").text();
						if (selOrdPrvdPrev !== selOrdPrvdCurrent) {
				        	refreshGrid();
				        	selOrdPrvdPrev = $("#selOrdPrvd").find(":selected").text();
						} else {
						    $("#selOrdPrvd").next().focus();
						}
					}
			        selOrdPrvdClose = true;
				},
				open: function() {
					$("input[value='" + selOrdPrvdLast + "']:first").focus();
				},
				click: function(event, ui) {
					var val = ui.value;
					var checked = ui.checked;
					
					if (val == "(All)") {
						if (checked) {
							selOrdPrvdClose = false;
							selOrdPrvdLast = val;
							uncheckOthers("#selOrdPrvd");
						}
					} else {
						var allSelected = isAllSelected("#selOrdPrvd");
						if (allSelected) {
							selOrdPrvdClose = false;
							selOrdPrvdLast = val;
							selectItem("#selOrdPrvd", val, checked);
						}
					}
				}
			});

			var selServiceClose = true;
			var selServiceLast = "(All)";
			var selServicePrev = $("#selService").find(":selected").text();
	        $("#selService").multiselect({
				selectedList: 10,
				close: function() {
					if (selServiceClose) {
			        	$.cookie("filter","#selService")
				        $.cookie("rowid",1)
						var selServiceCurrent = $("#selService").find(":selected").text();
						if (selServicePrev !== selServiceCurrent) {
				        	refreshGrid();
				        	selServicePrev = $("#selService").find(":selected").text();
						} else {
						    $("#selService").next().focus();
						}
					}
					selServiceClose = true;					
				},
				open: function() {
					$("input[value='" + selServiceLast + "']:first").focus();
				},
				click: function(event, ui) {
					var val = ui.value;
					var checked = ui.checked;
					
					if (val == "(All)") {
						if (checked) {
							selServiceClose = false;
							selServiceLast = val;
							uncheckOthers("#selService");
						}
					} else {
						var allSelected = isAllSelected("#selService");
						if (allSelected) {
							selServiceClose = false;
							selServiceLast = val;
							selectItem("#selService", val, checked);
						}
					}
				}

	        });

			var selClinicClose = true;
			var selClinicLast = "(All)";
			var selClinicPrev = $("#selClinic").find(":selected").text();
	        $("#selClinic").multiselect({
				selectedList: 10,
				close: function() {
					if (selClinicClose) {
			        	$.cookie("filter","#selClinic")
				        $.cookie("rowid",1)
						var selClinicCurrent = $("#selClinic").find(":selected").text();
						if (selClinicPrev !== selClinicCurrent) {
				        	refreshGrid();
				        	selClinicPrev = $("#selClinic").find(":selected").text();
						} else {
						    $("#selClinic").next().focus();
						}
					}
					selClinicClose = true;					
				},
				open: function() {
					$("input[value='" + selClinicLast + "']:first").focus();
				},
				click: function(event, ui) {
					var val = ui.value;
					var checked = ui.checked;
					
					if (val == "(All)") {
						if (checked) {
							selClinicClose = false;
							selClinicLast = val;
							uncheckOthers("#selClinic");
						}
					} else {
						var allSelected = isAllSelected("#selClinic");
						if (allSelected) {
							selClinicClose = false;
							selClinicLast = val;
							selectItem("#selClinic", val, checked);
						}
					}
				}

	        });

			var selPatientClose = true;
			var selPatientLast = "(All)";
			var selPatientPrev = $("#selPatient").find(":selected").text();
	        $("#selPatient").multiselect({
				selectedList: 10,
				close: function() {
					if (selPatientClose) {
				        $.cookie("filter","#selPatient")
				        $.cookie("rowid",1)
						var selPatientCurrent = $("#selPatient").find(":selected").text();
						if (selPatientPrev !== selPatientCurrent) {
				        	refreshGrid();
				        	selPatientPrev = $("#selPatient").find(":selected").text();
						} else {
						    $("#selPatient").next().focus();
						}
					}
					selPatientClose = true;
				},
				open: function() {
					$("input[value='" + selPatientLast + "']:first").focus();
				},
				click: function(event, ui) {
					var val = ui.value;
					var checked = ui.checked;
					
					if (val == "(All)") {
						if (checked) {
							selPatientClose = false;
							selPatientLast = val;
							uncheckOthers("#selPatient");
						}
					} else {
						var allSelected = isAllSelected("#selPatient");
						if (allSelected) {
							selPatientClose = false;
							selPatientLast = val;
							selectItem("#selPatient", val, checked);
						}
					}
				}

	        });

	        $("#selAlert").multiselect({
		        multiple: false,
		        selectedList: 1,
		        minWidth: 160,
		        close: function() {
			        $.cookie("filter","#selAlert")
			        $.cookie("rowid",1)
	    	        refreshGrid();
		        }
	        });

			
			function selectItem(elem, val, checked) {
				$(elem + " option[value='(All)']").prop("selected",false);
				$(elem).multiselect("refresh");
				$(elem + " option[value='" + val + "']").prop("selected",checked);				
				$(elem).multiselect("refresh");
				$(elem).multiselect("close");
				$(elem).multiselect("open");			
			}
			
			function uncheckOthers(elem) {
				$(elem).multiselect("uncheckAll");
				$(elem + " option[value='(All)']").prop("selected",true);				
				$(elem).multiselect("refresh");
				$(elem).multiselect("close");
				$(elem).multiselect("open");
			}
			
			function isAllSelected(elem) {
				var selectedArray = $(elem + ' option:selected');
				if (selectedArray.length > 0) {
					return (selectedArray[0].value == '(All)');
				} else {
					return false;
				}
			}

	        function getGridSize() {
	            var rowsPerPage = $("#list").getGridParam("rowNum");
	            if (NotNumber(rowsPerPage)) {
	                rowsPerPage = 20;
	            }
	            return rowsPerPage;
	        }

	        function showDetail() {
	            var rowId = $('#list').jqGrid('getGridParam', 'selrow');
	            if (rowId == null) {
	                alert('No row selected');
	            } else {
		            killSession = false;
	                var rowData = $('#list').getRowData(rowId);
	                var ien = rowData['ien'];
	                $.cookie("ien", ien);
	                $.cookie("rowid", rowId);
					var page = $("#list").getGridParam("page");
	                $.cookie("page", page);
	                var rowsPerPage = $("#list").getGridParam("rowNum");
	                $.cookie("jqGrid.rowNum", rowsPerPage, { expires: 10000 });

					saveFilters();
		      		window.location = "showalertcachedetail.csp"
	            }
	        }

			function saveFilters() {
	            var lstSelOrdPrvd = $("#selOrdPrvd").multiselect("getChecked").map(function() {
		            return this.value + "^";
	            }).get();
	            
	            var lstSelService = $("#selService").multiselect("getChecked").map(function() {
		            return this.value + "^";
	            }).get();

	            var lstSelClinic = $("#selClinic").multiselect("getChecked").map(function() {
		            return this.value + "^";
	            }).get();

	            var lstSelPatient = $("#selPatient").multiselect("getChecked").map(function() {
		            return this.value + "^";
        	    }).get();

				$.cookie("selOrdPrvd", lstSelOrdPrvd);
	            $.cookie("selService", lstSelService);
	            $.cookie("selClinic", lstSelClinic);
	            $.cookie("selPatient", lstSelPatient);
	            $.cookie("selAlert", $("#selAlert").val());
			}

			function refreshGrid() {
	            killSession = false;
                $.cookie("rowid", 1);
	            $.cookie("page", 1);
	            var rowsPerPage = $("#list").getGridParam("rowNum");
	            $.cookie("jqGrid.rowNum", rowsPerPage, { expires: 10000 });
	            
				saveFilters();
	          	window.location.href = "showalertcache.csp"
	        }
	        

	    });

        var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}

		function genToolTips() {
	        $("#list_patient").attr("title", "Sort By: Patient Name");
	        $("#list_l4ssn").attr("title", "Sort By: Patient ID");
	        $("#list_alertid").attr("title", "Sort By: Alert ID");
	        $("#list_date").attr("title", "Sort By: Alert Date/Time");
	        $("#list_service").attr("title", "Sort By: Service");
	        $("#list_clinic").attr("title", "Sort By: Clinic");
	        $("#list_provider").attr("title", "Sort By: Ordering Provider");
	        $("#list_alertcategory").attr("title", "Sort By: Alert Category");
	        $("#list_alerttype").attr("title", "Sort By: Alert Type");
	        $("#list_folup").attr("title", "Sort By: Follow-up Flag");
	        $("#list_fol7days").attr("title", "Sort By: Day Counter");
		}

		
	</script>
     
	
</head>


<body>

<center>
<FORM id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:1100px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA Alert Watch and Response Engine (AWARE)</h1>
			<h1>Alert Viewer </h1>
        </td>

    </table>
</div>

<div>

    <table style="width: 100%;">
        <tr>
            <td align="left" class="ui-widget ui-corner-all">
                <label for="selService">Service</label>
                <select id="selService" name="selService" title="Select Service" multiple="multiple">
                    <option></option>
                </select>
            </td>
            <td align="left" class="ui-widget ui-corner-all">
                <label for="selClinic">Clinic</label>
                <select id="selClinic" name="selClinic" title="Select Clinic" multiple="multiple">
                    <option></option>
                </select>
            </td>
            <td align="left" class="ui-widget ui-corner-all">
                <label id="lblOrdPrvd" for="selOrdPrvd">Ordering Provider</label>
                <select id="selOrdPrvd" name="selOrdPrvd" title="Select Order Provider" multiple="multiple">
                    <option></option>
                </select>
            </td>
            <td align="left" class="ui-widget ui-corner-all">
                <label for="selPatient">Patient</label>
                <select id="selPatient" name="selPatient" title="Select Patient" multiple="multiple">
                    <option></option>
                </select>
            </td>
            <td align="left" class="ui-widget ui-corner-all">
                <label for="selAlert">Follow-up</label>
                <select id="selAlert" name="selAlert" title="Any Follow-up?">
                    <option></option>
                </select>
            </td>
        </tr>
    </table>

    <table id="list" ></table>
    <div id="pager" ></div>

    <input id="hien" name="hien" type="hidden" />
        <table style="width: 100%">
           <tr>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Alt+G: select a row
            		</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">To see detail, select a row and press [Ctrl+Alt+E]</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+N: Next Page
              		</p>
			   </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+B: Previous Page</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+X: Sign Out</p>
                </td>
           </tr>
        </table>
 </div>


 <div>
        <table style="width: 100%">
           <tr>
                <td class="auto-style2">
                  <p style="font-size:70%; color:#001A4C; text-align:left; width: 450px;">
                      <label for="txtUser">Alert Viewer used by&nbsp;</label>
                      <input id="txtUser" type="text" readonly/></p>
                </td>

                <td class="auto-style2">
                  <p style="font-size:70%; color:#001A4C; text-align:left; width: 400px;">
				    <label for="txtFacility">Facility</label>
				    <input id="txtFacility" type="text" readonly/></p>
                </td>

                <td align="right" style="font-size:60%">
				    <input type="button" value="Sign Out" id="signout" name="signout">
                </td>
           </tr>
        </table>
</div>

 </FORM>


<script language="Cache" runat="server">
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
 	d ##class(VEFA.Login).LoginAlertCache()
</script>
    

<script type="text/javascript">
     $(function () {
	     var rowsPerPage = $.cookie("jqGrid.rowNum");
         if (NotNumber(rowsPerPage)) {
             rowsPerPage = 20;
             $.cookie("jqGrid.rowNum", rowsPerPage, { expires: 10000 });
         } else {
	         rowsPerPage = parseInt(rowsPerPage);
         }

	     var pageNum = $.cookie("page");
	     if (NotNumber(pageNum)) {
		     pageNum = 1;
	     } else {
	     	 pageNum = parseInt(pageNum);
	     }
         $("#list").setGridParam({ page: pageNum, rowNum: rowsPerPage }).trigger("reloadGrid");
	     
	     var rowID = $.cookie("rowid");
	     if (NotNumber(rowID)) {
		     rowID = 1;
	     } else {
		     rowID = parseInt(rowID);
	     }
	                
         $("#list").jqGrid("setSelection", rowID);
       
		var filter = $.cookie("filter");
		if ((filter == "undefined") || (filter == "")) {
			filter = "#selService";
		} 

		var key = $.cookie("AlertKey");
		if (key == '1') {
			$('#lblOrdPrvd').hide();
			$('#selOrdPrvd').next().hide();
			if (filter == "#selOrdPrvd") {
				filter = "#selPatient";
			}
		}
		
	    $(filter).next().focus();

     });
</script>	
     
</center>

</body>


</html>
]]></CSP>


<CSP name="alertcache/showalertcachedetail.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>VEFA AWARE Alert Detail</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
   <style type="text/css">
		h1 {
			margin:0;
	  	}

        .ReadOnly
        {
			background: #f5f5f5
		}
        .IDWidth
        {
            width: 168px;
        }

        .DateWidth
        {
            width: 217px;
        }

		.TextWidth
        {
            width: 400px;
        }
		
	</style>
	
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />

    <style type="text/css">
		.ui-jqgrid .ui-widget-header {
			background: #0a1a4c;
		}
	   #tabs {
            padding: 0px;
	   }
	   #tabs .ui-tabs-nav {
    	 background: transparent; 
         border-width: 0px 0px 1px 0px; 
         -moz-border-radius: 0px; 
         -webkit-border-radius: 0px; 
         border-radius: 0px; 
	   }
	   #tabs .ui-tabs-panel {
          margin: 0em 0.2em 0.2em 0.2em;
	   }
   	   #tabs .ui-state-hover a {
		   color: #0e1ed7;
	   }
	   #tabs .ui-state-focus a {
		   color: #0e1ed7;
	   }
	   #tabs .ui-state-active a {
		   color: #0e1ed7;
	   }
	   #close:hover {
		   color: #0e1ed7;
	   }

	</style>

	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="jquery.jqGrid.min-aware.js"></script>
	<script src="mousetrap.min.js"></script>

    <script>
    
	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});
    
        $(function () {
		    var killSession = false;
		    
   	        window.onbeforeunload = function() {
	   	        if (killSession) {
					#server(VEFA.Login.KillSession())#;
	   	        }
	        }

            $("#actionlist").jqGrid({
                datatype: "local",
                height: 250,
                colNames: ['ID', 'Follow-up Action', 'Date/Time'],

                colModel: [
                { name: 'id', index: 'id', width: 60, sorttype: "int" },
                { name: 'action', index: 'action', width: 450 },
   		        { name: 'date', index: 'date', width: 150, sorttype: "date" }
                ],
      			hidegrid: false,
                pager: "#pager",
                rowNum: 10,
                rowList: [10, 20, 30, 40],
                viewrecords: true,
                gridview: true,
                autoencode: true,
                multiSelect: true,
                caption: "Follow-up Actions"
            });
			$("#actionlist").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event
			genFUToolTips();

            $("#close")
              .button()
              .click(function (event) {
                  showList();
              });

            Mousetrap.bind('ctrl+alt+b', function (e) {
                showList();
            });


            function showList() {
                $.cookie("fromPage", "detail");
		    	killSession = false;
                window.location = "showalertcache.csp";
                //history.back();
            }

            $("#tabs").focus();
            $("#tabs").tabs();
            $("#tab-1").focus();
            

        });

        var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}

		function genFUToolTips() {
	        $("#actionlist_id").attr("title", "Sort By: Follow-up IEN");
	        $("#actionlist_action").attr("title", "Sort By: Follow-up Action");
	        $("#actionlist_date").attr("title", "Sort By: Follow-up Date/Time");
		}

    </script>
    

</head>

<BODY>

<center>

<FORM class="ui-widget ui-state-default ui-corner-all" style="width:750px">
            
<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
        	<img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
    	</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
 		</td>
        <td align="right">
			<h1>VistA AWARE</h1>
			<h1>Alert Viewer </h1>
        </td>

    </table>
</div>


<br />

<div id='tabs' text-align:left>
    <ul>
        <li><a id='tab-1' href='#tabs-1' >Alert</a></li>
        <li><a id='tab-2' href='#tabs-2' >Status</a></li>
	    <li><a id='tab-3' href='#tabs-3' >Result</a></li>
	    <li><a id='tab-4' href='#tabs-4' >Follow-up Actions</a></li>
	</ul>
	
    <div id='tabs-1'>
	    <table class="ui-widget ui-state-default ui-corner-all" style="width: 100%;">
        <tr>
        <td align="right">
            <label for="txtAlertID">Alert ID</label></td>
        <td align="left">
            <input id="txtAlertID" align="left" type="text" class="ReadOnly ui-widget ui-corner-all TextWidth" 
                readonly />&nbsp;
        </td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtDate">Date</label></td>
        <td align="left">
            <input id="txtDate" align="left" type="text" class="ReadOnly ui-widget ui-corner-all DateWidth"
                readonly />&nbsp;
        </td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtService">Service</label></td>
        <td align="left">
            <input id="txtService" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtOrderProvider">Ordering Provider</label></td>
        <td align="left">
            <input id="txtOrderProvider" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtListValue">Alert Recipient</label></td>
        <td align="left">
        	<textarea id="txtListValue" name="txtListValue" rows="3"
           	style = "overflow-x: hidden; overflow-y: scroll"
            class="ReadOnly ui-widget ui-corner-all TextWidth" readonly >
          	</textarea></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtPatient">Patient</label></td>
        <td align="left">
            <input id="txtPatient" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtCategory">Alert Category</label></td>
        <td align="left">
            <input id="txtCategory" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtType">Alert Type</label></td>
        <td align="left">
            <input id="txtType" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtOrigType">Original Alert Type</label></td>
        <td align="left">
            <input id="txtOrigType" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        </table>
    </div>
    <div id='tabs-2'>
        <table class="ui-widget ui-state-default ui-corner-all" style="width: 100%;">
        <tr>
        <td align="right">
            <label for="txtVEFASYS">Un-Acknowledged Status</label></td>
        <td align="left">
            <input id="txtVEFASYS" align="left" type="text" class="ReadOnly ui-widget ui-corner-all TextWidth" 
                readonly />&nbsp;
        </td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtVEFAPROC">Alert Renew Date</label></td>
        <td align="left">
            <input id="txtVEFAPROC" align="left" type="text" class="ReadOnly ui-widget ui-corner-all DateWidth"
                readonly />&nbsp;
        </td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtVEFADELETE">Delete Date</label></td>
        <td align="left">
            <input id="txtVEFADELETE" align="left" type="text" class="ReadOnly ui-widget ui-corner-all DateWidth"
                readonly />&nbsp;
        </td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtFATStatus">Alert Status</label></td>
        <td align="left">
            <input id="txtFATStatus" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtFATProvider">Alert Provider</label></td>
        <td align="left">
            <input id="txtFATProvider" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtFollowupProvider">Follow-up Provider</label> </td>
        <td align="left">
            <input id="txtFollowupProvider" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtClinic">Clinic</label></td>
        <td align="left">
            <input id="txtClinic" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtPatientID">Patient ID</label></td>
        <td align="left">
            <input id="txtPatientID" type="text" 
                class="ReadOnly ui-widget ui-corner-all IDWidth" readonly /></td>
        </tr>
        
        </table>
    </div>
    <div id='tabs-3'>
    <table class="ui-widget ui-state-default ui-corner-all" style="width: 100%;">
        <tr>
        <td align="right">
            <label for="txtGeneratedBy">Alert Created By</label></td>
        <td align="left">
            <input id="txtGeneratedBy" type="text" 
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtGeneratedByPersonCL" style="display:none">Resultor Person Class</label></td>
        <td align="left">
            <input id="txtGeneratedByPersonCL" class="ReadOnly ui-widget ui-corner-all TxtWidth" 
                readonly type="text" style="display:none"/></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtOrigStation" hidden="hidden">Alert Type Orig Station</label></td>
        <td align="left">
            <input id="txtOrigStation" type="text" hidden="hidden"
                class="ReadOnly ui-widget ui-corner-all TextWidth" readonly /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="chkFol">Follow-up</label></td>
        <td align="left">
      		<input id="chkFol" type="checkbox" class="ui-widget ui-corner-all" onclick="return false" /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="chkFol7D">Follow-up > 7 Days</label></td>
        <td align="left">
      		<input id="chkFol7D" type="checkbox" class="ui-widget ui-corner-all" onclick="return false" /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="chkAck7D">Ack > 7 Days</label></td>
        <td align="left">
      		<input id="chkAck7D" type="checkbox" class="ui-widget ui-corner-all" onclick="return false" /></td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtAlertValue">Alert Value</label></td>
        <td align="left">
            <input id="txtAlertValue" class="ReadOnly ui-widget ui-corner-all TextWidth" 
                readonly type="text" /></td>
        </tr>
    </table>
    </div>
    <div id='tabs-4'>
    <table id="actionlist">
    </table>
    </div>
</div>


<div>
<table style="width: 95%">
    <tr>
        <td align="left">
            <p style="font-size:70%; text-align:left;">Ctrl+Alt+B to return to previous Page</p>
        </td>
        <td align="left">
            <p style="font-size:70%; text-align:left;">Left and Right Arrow 
                Keys to navigate the TABS</p>
        </td>
	</tr>
</table>

<table style="width: 95%">
    <tr>
        <td align="left">
			<p style="font-size:70%; text-align:left;">
	            <label for="txtFacility">Facility</label>
    	        <input id="txtFacility" align="left" type="text" class="ReadOnly TextWidth"
        	        readonly /></p>
        </td>
        <td align="right" style="font-size:80%">
            <input type="button" value="Close" id="close" name="close">
        </td>
    </tr>
</table>
</div>

<br />

</FORM>

<script language="Cache" runat="server" >
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
  	d ##class(VEFA.AlertCacheDetail).Show()
</script>


</center>

</body>
</html>
]]></CSP>


<CSP name="kbeditor/kbeditor.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KB Editor Login</title>
	
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
	

    <style type="text/css">
	  html, body {
	     margin: 20;
	     padding: 0;
	     font-size: 100%;
	  }
	  
	  h1 {
		  margin:0;
	  }

	  #access {
          width: 236px;
          margin-right: 71px;
      }
      #verify {
          width: 236px;
          margin-right: 71px;
      }
      
	  #Select1 {
          width: 241px;
      }
      
      #ok {
          Width: 80px;
      }

	  #ok:hover {
		   color: #0e1ed7;
	  }

	  #ok:focus {
		   color: #0e1ed7;
	  }

	  #TextArea1 {
          width: 400px;
      }

	  #TextAreaStatus {
          width: 399px;
      }

	  #TextAreaLegal {
          width: 397px;
      }

	</style>


    <link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	
	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
  	<script src="jquery.cookie.js"></script>

    <script>
		// Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});
		
		$(function () {
	        window.onbeforeunload = function() {
				//#server(VEFA.Login.KillSession())#;
	        }

            $("#ok")
              .button()
              .click(function () {
	              showMain();
              });
	        
	     });

		function showMain() {
			$.cookie("fromPage", "logon");
	        $.cookie("startMainTab", "#listCat");
	     	$.cookie("cat.page",1);
			$.cookie("cat.id", 1);
	     	$.cookie("type.page",1);
			$.cookie("type.id", 1);
            window.onbeforeunload = null;
    	    #server(VEFA.Login.SaveAV($("#access").val(), $("#verify").val()))#;
    		window.location = "showmain.csp";
		}


   		function init() {
  	    	$("#access").focus();
	        $("#TextAreaLegal").val(
               "Unauthorized access or misuse of this system and/or its data is a federal crime. " +
               "Use of all data shall be in accordance with VA policy on security and privacy.");
	        $("#TextAreaLegal").css({ 'background-color': '#efefef', 'color': '#0e1ed7', 'font-size': '12px' });
		}

        var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}


  </script>
	
</head>
   
<BODY onload="init()">

 <center>


<FORM action="showmain.csp" method="post" id=form1 name=form1 class="ui-widget ui-state-default ui-corner-all" style="width:750px">

<div style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
        
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>

        <td align="right">
			<h1>VistA AWARE</h1>
			<h1>Knowledge Based Editor</h1>
        </td>
        
    </table>
</div>
    
    <br /><br />
 	<table>

      <tr>
	    <td align="right"><label for="access">Access Code</label></td>
        <td>
        <input id="access" name="access" type="password" align="left" class="ui-widget ui-corner-all" />
        </td>
      </tr>

      <tr>
        <td align="right"><label for="verify">Verify Code</label></td>
        <td><input id="verify" name="verify" type="password" align="left" class="ui-widget ui-corner-all"/></td>
      </tr>

      <tr>
        <td align="right">&nbsp;</td>
        <td><input id='ok' name='ok' type='submit' value='Logon' align="right"/>
        </td>
      </tr>



    </table>
    
	<div>
    <table>
      <tr align="left">
        <td>
      	<label for="TextAreaLegal" style="font-size:60%;">Warning</label>
        </td>
      </tr>
      <tr>
        <td>
        <textarea id="TextAreaLegal" name="TextAreaLegal" readonly="readonly" rows="3"
            style = "overflow-x: hidden; overflow-y: hidden;"
            class="ui-corner-all" >
        </textarea>
        </td>
      </tr>
    </table>
	</div>

    <br />
   	<label style="font-size:60%;" id="ver" name="ver"></label>
   	<br />
   	<label style="font-size:60%;" id="env" name="env"></label>
    
</FORM>
<script language="Cache" runat="server">
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
 	d ##class(VEFA.Login).ShowEnv()
</script>

</center>

    
</BODY>



</html>
]]></CSP>


<CSP name="kbeditor/logoff.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KB Editor</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	
	<script type="text/javascript" src="jquery.js"></script>
	<script type="text/javascript" src="jquery-ui.js"></script>
	<script type="text/javascript" src="jquery.cookie.js"></script>
	<script type="text/javascript" src="jquery.jqGrid.min.js"></script>


    <style type="text/css">
		h1 {
			margin:0;
	  	}

        .auto-style1 {
            width: 423px;
        }
        .text-style {
	        color: #0e1ed7;
        }
        #txtUser {
            width: 282px;
        }
        #txtConnection {
            width: 139px;
        }
    </style>


	<script type="text/javascript">
	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = true;
		    if (event.keyCode === 8) {
        		event.preventDefault();
		    }
		});

	    $(function () {
		    $("#return").focus();
	        //var cookies = document.cookie.split(";");
	        //for (var i = 0; i < cookies.length; i++) {
	            //var cookie = cookies[i];
	            //var eqPos = cookie.indexOf("=");
	            //var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
	            //$.removeCookie(name);
	        //}
	    });

	</script>
     
     <script language="Cache" runat="server" >
       	d ##class(VEFA.Login).KillSession()
    </script>

	
</head>


<body>

<center>
<FORM id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:875px">


<div style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE</h1>
			<h1>Knowledge Based Editor</h1>
        </td>
    </table>
</div>


    <br />
    <br />

<div align="center" class="text-style">
	You have logged out of Knowledge Based Editor.
</div>
    <br />
<div align="center" >
	<a id="return" name="return" href="kbeditor.csp"><u>Return to Knowledge Based Editor Logon</u></a>    
</div>

    <br />
    <br />

</FORM>
 </center>

</body>


</html>
]]></CSP>


<CSP name="kbeditor/savealertcat.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KBEditor Save Alert Category</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="jquery.ui.dialog.css" />
    
    <script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.ui.dialog.js"></script>

	<style type="text/css">
	h1 {	
		margin:0;
  	}

   	.no-close .ui-dialog-titlebar-close {
	   	display: none;
   	}
   	.ui-dialog-titlebar {
	   	background: #0a1a4c;
   	}
   </style>

    <script>
	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
		    if (event.keyCode === 8) {
        		event.preventDefault();
		    }
		});
        $.cookie("fromPage", "saveAlertCat");
        $.cookie("startMainTab", "#listCat");
    </script>
	
    
</head>

<body>

<center>

<FORM id= "form1" name="form1" style="width:750px">


<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE KB Editor</h1>
			<h1>Alert Category</h1>
        </td>
    </table>
</div>



<div id="savedialog" title="Knowledge Based Editor">Error</div>

<script language="Cache" runat="server" >
    d ##class(VEFA.AlertCategory).Save()
</script>

<script>
	    var killSession = false;
		    
        window.onbeforeunload = function() {
  	        if (killSession) {
				#server(VEFA.Login.KillSession())#;
   	        }
        }

        function successDlg() {
            var todo = $.cookie("cat.todo");
            if (todo == "add") {
                $.cookie("cat.id", ""); //This will make grid go to the last row
            }
            
            $("#savedialog").dialog({
                dialogClass: "no-close",
                modal: true,
                buttons: [{
                    text: "OK",
                    click: function () {
                        $(this).dialog("close");
	                    if ($.cookie("cat.todo") == "delete") {
				            $.cookie("cat.id",1);
	                    }
                        killSession = false;
	                    window.location = 'showmain.csp';
                    }
                }],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
            });
        }

        function failDlg() {
            $("#savedialog").dialog({
                dialogClass: "no-close",
                modal: true,
                buttons: [{
                    text: "OK",
                    click: function () {
                        $(this).dialog("close");
		                if ($.cookie("cat.todo") == "delete") {
							killSession = false;
		                    window.location = 'showmain.csp';
	                    } else {
		                    killSession = false;
		                    window.location = 'showalertcategory.csp';
    	                }
                    }
                }],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
            });
        }
    
</script>




</FORM>

</center>



</body>
</html>
]]></CSP>


<CSP name="kbeditor/savealerttype.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KBEditor Save Alert Category</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="jquery.ui.dialog.css" />
    
    <script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.ui.dialog.js"></script>

	<style type="text/css">
	h1 {	
		margin:0;
  	}

   	.no-close .ui-dialog-titlebar-close {
	   	display: none;
   	}
   	.ui-dialog-titlebar {
	   	background: #0a1a4c;
   	}
   </style>
   
    <script>
	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
		    if (event.keyCode === 8) {
        		event.preventDefault();
		    }
		});
        $.cookie("fromPage", "saveAlertType");
        $.cookie("startMainTab", "#listType");
    </script>
	
    
</head>

<body>

<center>

<FORM id= "form1" name="form1" style="width:750px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE KB Editor</h1>
			<h1>Alert Type</h1>
        </td>
    </table>
</div>

<div id="savedialog" title="Knowledge Based Editor">Error</div>

    <script language="Cache" runat="server" >
       	d ##class(VEFA.AlertType).Save()
   </script>



<script>
	var killSession = false;
		    
    window.onbeforeunload = function() {
  	     if (killSession) {
			#server(VEFA.Login.KillSession())#;
   	     }
    }

    function successDlg() {
        var todo = $.cookie("type.todo");
        
        if (todo == "add") {
            $.cookie("type.id",""); //This will make grid go to the last row
        }

	    $("#savedialog").dialog({
    		dialogClass: "no-close",
            modal: true,
	        buttons: [{
    	    	text: "OK",
        	    click: function () {
            		$(this).dialog("close");
                    if ($.cookie("type.todo") == "delete") {
			            $.cookie("type.id",1);
                    }
					killSession = false;
                	window.location = 'showmain.csp';
	            }
    	    }],
			open: function(event, ui) {
				$(":button:contains('OK')").focus();
			}
       	});
    }

    function failDlg() {
        $("#savedialog").dialog({
            dialogClass: "no-close",
            modal: true,
            buttons: [{
                text: "OK",
                click: function () {
                    $(this).dialog("close");
                    if ( ($.cookie("type.todo") == "delete") || ($.cookie("type.todo") == "copy") ) {
						killSession = false;
	                    window.location = 'showmain.csp';
                    } else {
	                    killSession = false;
	                    window.location = 'showalerttype.csp';
                    }
                }
            }],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
        });
        
    }
    
</script>




</FORM>

</center>



</body>
</html>
]]></CSP>


<CSP name="kbeditor/savecmtdlg.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KBEditor Save Alert Type - Comments Dialog</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="jquery.ui.dialog.css" />
    
    <script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.ui.dialog.js"></script>

	<style type="text/css">
	h1 {	
			margin:0;
	  	}
   	.no-close .ui-dialog-titlebar-close {
	   	display: none;
   	}
   	.ui-dialog-titlebar {
	   	background: #0a1a4c;
   	}
   </style>

    <script>
	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
		    if (event.keyCode === 8) {
        		event.preventDefault();
		    }
		});
        $.cookie("fromPage", "saveCmtDlg");
    </script>
	
    
</head>

<body>

<center>

<FORM id= "form1" name="form1" style="width:750px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE KB Editor</h1>
			<h1>Comments Dialog</h1>
        </td>
    </table>
</div>

<div id="savedialog" title="Knowledge Based Editor">Error</div>

    <script language="Cache" runat="server" >
       	d ##class(VEFA.OrderDialog).SaveCommentDlg()
   </script>


<script>
	var killSession = false;
		    
    window.onbeforeunload = function() {
  	     if (killSession) {
			#server(VEFA.Login.KillSession())#;
   	     }
    }

	function successDlg() {
		if ($.cookie("cmt.form") == "update") {
			$.cookie("cmt.todo", "edit");
			killSession = false;
			window.location = 'showcmtdlg.csp';
		} else {

			$("#savedialog").dialog({
				dialogClass: "no-close",
				modal: true,
				buttons: [{
					text: "OK",
					click: function () {
                        $.cookie("type.todo", "edit");
	                    $(this).dialog("close");
                        if ($.cookie("cmt.form") == "close") {
		                    killSession = false;
		                    window.location = 'showalerttype.csp';
                        } else {
							$.cookie("cmt.todo", "edit");
							killSession = false;
							window.location = 'showcmtdlg.csp';
						}
                    }
				}],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
			});

		}
	}
        
	function failDlg() {
    	$.cookie("type.todo", "edit");
        if ($.cookie("cmt.todo") == "delete") {
    		$("#savedialog").dialog({
				dialogClass: "no-close",
				modal: true,
				buttons: [{
					text: "OK",
					click: function () {
    			    	killSession = false;
    			    	window.location = 'showalerttype.csp';
					}
				}],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
    		});
        } else {
            if ($.cookie("cmt.form") == "close") {
	    		$("#savedialog").dialog({
					dialogClass: "no-close",
					modal: true,
					buttons: [{
						text: "OK",
						click: function () {
    			    		killSession = false;
    			    		window.location = 'showalerttype.csp';
						}
					}],
					open: function(event, ui) {
						$(":button:contains('OK')").focus();
					}
	    		});
	        } else {
				killSession = false;
				window.location = 'showcmtdlg.csp';
	        }
        }
    }

    
</script>




</FORM>

</center>



</body>
</html>
]]></CSP>


<CSP name="kbeditor/savefoldlg.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KBEditor Save Alert Type - Follow-up Dialog</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="jquery.ui.dialog.css" />
    
    <script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.ui.dialog.js"></script>

	<style type="text/css">
	h1 {	
			margin:0;
	  	}
   	.no-close .ui-dialog-titlebar-close {
	   	display: none;
   	}
   	.ui-dialog-titlebar {
	   	background: #0a1a4c;
   	}
   </style>

    <script>
	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
		    if (event.keyCode === 8) {
        		event.preventDefault();
		    }
		});
        $.cookie("fromPage", "saveFolDlg");
    </script>
	
    
</head>

<body>

<center>

<FORM id= "form1" name="form1" style="width:750px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE KB Editor</h1>
			<h1>Follow-up Dialog</h1>
        </td>
    </table>
</div>

<div id="savedialog" title="Knowledge Based Editor">Error</div>

<script language="Cache" runat="server" >
       	d ##class(VEFA.OrderDialog).SaveFollowupDlg()
</script>


<script>
	var killSession = false;
		    
    window.onbeforeunload = function() {
  	     if (killSession) {
			#server(VEFA.Login.KillSession())#;
   	     }
    }

	function successDlg() {
		if ($.cookie("fol.form") == "update") {
			$.cookie("fol.todo", "edit");
			killSession = false;
			window.location = 'showfoldlg.csp';
		} else {

			$("#savedialog").dialog({
				dialogClass: "no-close",
				modal: true,
				buttons: [{
					text: "OK",
					click: function () {
                        $.cookie("type.todo", "edit");
	                    $(this).dialog("close");
                        if ($.cookie("fol.form") == "close") {
		                    killSession = false;
		                    window.location = 'showalerttype.csp';
                        } else {
							$.cookie("fol.todo", "edit");
							killSession = false;
							window.location = 'showfoldlg.csp';
						}
                    }
				}],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
			});

		}
	}
        
	function failDlg() {
    	$.cookie("type.todo", "edit");
        if ($.cookie("fol.todo") == "delete") {
    		$("#savedialog").dialog({
				dialogClass: "no-close",
				modal: true,
				buttons: [{
					text: "OK",
					click: function () {
    			    	killSession = false;
    			    	window.location = 'showalerttype.csp';
					}
				}],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
    		});
        } else {
            if ($.cookie("fol.form") == "close") {
	    		$("#savedialog").dialog({
					dialogClass: "no-close",
					modal: true,
					buttons: [{
						text: "OK",
						click: function () {
    			    		killSession = false;
    			    		window.location = 'showalerttype.csp';
						}
					}],
					open: function(event, ui) {
						$(":button:contains('OK')").focus();
					}
	    		});
	        } else {
			    killSession = false;
			    window.location = 'showfoldlg.csp';
	        }
        }
    }



    
</script>




</FORM>

</center>



</body>
</html>
]]></CSP>


<CSP name="kbeditor/saveorderdlg.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KBEditor Save Alert Type - Order Dialog</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="jquery.ui.dialog.css" />
    
    <script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.ui.dialog.js"></script>

	<style type="text/css">
		h1 {	
			margin:0;
	  	}

		.no-close .ui-dialog-titlebar-close {
	   		display: none;
	   	}
   		.ui-dialog-titlebar {
	   		background: #0a1a4c;
	   	}
   </style>

    <script>
	    // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
		    if (event.keyCode === 8) {
        		event.preventDefault();
		    }
		});

        $.cookie("fromPage", "saveOrdDlg");
   </script>
	
    
</head>

<body>

<center>

<FORM id= "form1" name="form1" style="width:750px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
    		<h1>VistA AWARE KB Editor</h1>
			<h1>Order Dialog</h1>
	    </td>
    </table>
</div>

<div id="savedialog" title="Knowledge Based Editor">Error</div>

    <script language="Cache" runat="server" >
       	d ##class(VEFA.OrderDialog).SaveOrderDlg()
   </script>


<script>
	var killSession = false;
		    
    window.onbeforeunload = function() {
  	     if (killSession) {
			#server(VEFA.Login.KillSession())#;
   	     }
    }

	function successDlg() {
		if ($.cookie("ord.form") == "update") {
			$.cookie("ord.todo", "edit");
			killSession = false;
			window.location = 'showorderdlg.csp';
		} else {

			$("#savedialog").dialog({
				dialogClass: "no-close",
				modal: true,
				buttons: [{
					text: "OK",
					click: function () {
                        $.cookie("type.todo", "edit");
	                    $(this).dialog("close");
                        if ($.cookie("ord.form") == "close") {
		                    killSession = false;
		                    window.location = 'showalerttype.csp';
                        } else {
							$.cookie("ord.todo", "edit");
							killSession = false;
							window.location = 'showorderdlg.csp';
						}
                    }
				}],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
			});

		}
	}
        


	function failDlg() {
    	$.cookie("type.todo", "edit");
        if ($.cookie("ord.todo") == "delete") {
    		$("#savedialog").dialog({
				dialogClass: "no-close",
				modal: true,
				buttons: [{
					text: "OK",
					click: function () {
    			    	killSession = false;
    			    	window.location = 'showalerttype.csp';
					}
				}],
				open: function(event, ui) {
					$(":button:contains('OK')").focus();
				}
    		});
        } else {
            if ($.cookie("ord.form") == "close") {
	    		$("#savedialog").dialog({
					dialogClass: "no-close",
					modal: true,
					buttons: [{
						text: "OK",
						click: function () {
    			    		killSession = false;
    			    		window.location = 'showalerttype.csp';
						}
					}],
					open: function(event, ui) {
						$(":button:contains('OK')").focus();
					}
	    		});
	        } else {
			    killSession = false;
			    window.location = 'showorderdlg.csp';
	        }

        }
    }



    
</script>




</FORM>

</center>



</body>
</html>
]]></CSP>


<CSP name="kbeditor/searchfile.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>AWARE KBEditor Main</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="jquery.ui.dialog.css" />

	<style type="text/css">
		h1 {	
			margin:0;
	  	}

		.ui-jqgrid .ui-widget-header {
			background: #0a1a4c;
		}
	</style>
	    

	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="jquery.jqGrid.min-aware.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.ui.dialog.js"></script>


	<script type="text/javascript">
		// Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

	    $(function () {
	        
	        var filename = $.cookie("search.filename");
	        var dlgFile = $.cookie("search.dlgFile");
	        
	        $("#listFile").jqGrid({
	            datatype: "local",
	            height: 470,
	            colNames: ["ID", "Seq #", "Name"],
	            colModel: [
                    { name: "ien", width: 50, sorttype: "number"},
                    { name: "seq", width: 50, hidden:true},
                    { name: "name", width: 300 }
	            ],
                sortname: "name",
                sortorder: "asc",
				hidegrid: false,
	            rowNum: 500,
	            viewrecords: true,
	            gridview: true,
	            autoencode: true,
	            multiSelect: true,
	            caption: filename,
	            ondblClickRow: function (rowId) {
	                selectRecord();
	            }
	        });
           
	        $("#listFile").jqGrid("bindKeys", {});
			$("#alertmod_listFile").remove();
			
	        Mousetrap.bind("enter", function (e) {
	            selectRecord();
	        });

	        Mousetrap.bind("ctrl+alt+x", function (e) {
                window.close();
	        });

	        function selectRecord() {
	            var rowId = $("#listFile").jqGrid("getGridParam", "selrow");
	            if (rowId == null) {
	                alert("No row selected");
	            } else {
	                var rowData = $("#listFile").getRowData(rowId);
					if (dlgFile.substring(0,5) == "19007") {
	                	window.returnValue = rowData["name"] + " (#" + rowData["seq"] + ")";
					} else {
	                	window.returnValue = rowData["name"];
					}
                    window.close();
	            }
	        }

	        
	        fillSearchValues();
	        $("#listFile").focus();
	        $("#listFile").jqGrid("setSelection", "1");
	        $("#listFile_ien").attr("title", "Sort By: Reminder Dialog IEN");
	        $("#listFile_name").attr("title", "Sort By: Name");
			if (dlgFile.substring(0,5) == "19007") {
		        $("#listFile_seq").attr("title", "Sort By: Sequence #");
		        $("#listFile_name").attr("title", "Sort By: Name");
		        $("#listFile").hideCol("ien");
		        $("#listFile").showCol("seq");
			}


	    });

	        
        var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
    	    
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
		    #server(VEFA.Login.ResetSession())#;
		}
    </script>

</head>

<body>

<center>

<FORM class="ui-widget ui-state-default ui-corner-all" style="width:450px">


<div align="center" style="background-color:#001A4C; color:#FFFFFF;" >
	<h1>Search Result</h1>
</div>

<br />

<div>
    <table id="listFile"></table>
</div>

    <div>
        <table>
           <tr>
                <td>
                  <p style="font-size:70%; text-align:left;">Double-Click or Press Enter key to select a Row
                  </br>Ctrl+Alt+X to exit</p>
                </td>
           </tr>
           <tr>
                <td>
                </td>
           </tr>
            
        </table>
   </div>

   
</FORM>    

</center>

   
 

</body>

 <script language="Cache" runat="server" >
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
   	d ##class(VEFA.Search).Fill()
</script>



</html>
]]></CSP>


<CSP name="kbeditor/showalertcategory.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KB Editor Alert Category</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <style type="text/css">
    	h1 {	
			margin:0;
	  	}

        #txtName
        {
            width: 400px;
        }
        #txtDescr
        {
            width: 400px;
        }
        #ok
        {
            width: 76px;
        }
        #close
        {
            width: 76px;
        }
     </style>

	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />
    
    
	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="jquery.jqGrid.min.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.validate.min.js"></script>

    <script type="text/javascript">
        // Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

        $(function () {
	        
   		    var killSession = false;
		    
   	        window.onbeforeunload = function() {
	   	        if (killSession) {
					#server(VEFA.Login.KillSession())#;
	   	        }
	        }

            $("#form1").validate({
                rules: {
                    txtName: "required",
                    txtDescr: "required",
                    selNotfType: "required"
                }
            });
            
            $.cookie("fromPage", "alertCategory");

            $("#ok")
            .button()
            .click(function () {
	            if (valLength()) {
                    var action = $("#chkAction").prop("checked") ? "Yes" : "No";
					var record = $("#txtName").val() + "^" +
						$("#txtDescr").val() + "^" +
						$("#selDelAlert").val() + "^" +
						$("#selNotfType").val() + "^" +
						action;
                    $.cookie("cat.record", record);
					killSession = false;
                    window.location = "savealertcat.csp";
	            }
            });

            $("#cancel")
            .button()
            .click(function () {
                    killSession = false;
                    window.location = "showmain.csp";
            });

        });
    
		function valLength() {
			var fld = "#txtName";
			var val = valFieldLength(fld, "Name", 3, 60);
			if (val) {
				fld = "#txtDescr";
				val = valFieldLength(fld, "Description", 3, 40);
			}
			
			if (!val) {
				$(fld).focus();
			}

			return val;
		}
		
		function valFieldLength(fld, caption, low, high) {
			if (($(fld).val().length > high) || ($(fld).val().length < low)) {
				alert(caption + " must be " + low + "-" + high + " characters in length");
				return false;
			} else {
				return true;
			}
		}

		var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}
		
	</script>

</head>
<body>

 <center>

<FORM id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:750px">


<div style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE KB Editor</h1>
			<h1>Alert Category</h1>
        </td>
    </table>
</div>


    
<br />

<div id="cat">
    <table class="ui-widget ui-state-default ui-corner-all" style="width: 100%;">
        <tr>
        <td align="right">
            <label for="txtName">Name</label></td>
        <td align="left">
            <input id="txtName" name="txtName" align="left" type="text" class="ui-widget ui-corner-all" />&nbsp;
        </td>
        </tr>
        <tr>
        <td align="right">
            <label for="txtDescr">Description</label></td>
        <td align="left">
            <input id="txtDescr" name="txtDescr" align="left" type="text" class="ui-widget ui-corner-all"  />&nbsp;
        </td>
        </tr>
        <tr>
        <td align="right">
            <label for="selDelAlert">Delete Alert</label></td>
        <td align="left">
            <select id="selDelAlert" name="selDelAlert" class="ui-widget ui-corner-all">
                <script language="Cache" runat="server" >
       				d ##class(VEFA.AlertCategory).DeleteAlertOptions()
			   </script>
            </select>
        </td>
        </tr>
        <tr>
        <td align="right">
            <label for="selNotfType">Notification Type</label></td>
        <td align="left">
            <select id="selNotfType" name="selNotfType" class="ui-widget ui-corner-all">
	             <script language="Cache" runat="server" >
       				d ##class(VEFA.AlertCategory).NotfTypeOptions()
			   </script>
            </select>

        </td>
        </tr>
        <tr>
        <td align="right">
            &nbsp;</td>
        <td align="left" class="ui-widget ui-corner-all">
           <input id="chkAction" name="chkAction" type="checkbox" class="ui-widget ui-corner-all" />
           <label for="chkAction">Upon Follow-up Action</label>
        </td>
        </tr>
        
    </table>
</div>

<br />
<div>
    <table style="width: 405px">
    <td align="right">
            <input id="ok" name="ok" type="button" value="OK" />
        </td>
        <td align="left">
            <input type="button" value="Cancel" id="cancel" name="cancel">
        </td>
    </table>
</div>

<script>
    var todo = $.cookie("cat.todo");
    if (todo == "edit") {
	    var record = $.cookie("cat.record");
	    var arr = (record.length==0 || record.indexOf("^")==-1) ? []: record.split("^");
        $("#txtName").val(arr[0]);
        $("#txtDescr").val(arr[1]);
        var delAlert = arr[2];
        $("#selDelAlert").val(delAlert).attr("selected", true);
        $("#selNotfType").val(arr[3]).attr("selected", true);
        $("#chkAction").attr("checked", (arr[4] == "Yes"));
        //$("#txtName").attr("readonly", true);
        //$("#txtName").css({ 'background-color': '#f5f5f5'});
	    //$("#txtName").focus();
    } else {
        $("#txtName").val("");
        $("#txtDescr").val("");
        $("#selDelAlert").val("NO").attr("selected", true);
        $("#selNotfType").val("");
        $("#chkAction").attr("checked", false);
        $("#txtName").attr("readonly", false);
        $("#txtName").css({ 'background-color': '#FFFFFF'});
        //$("#selNotfType").attr("disabled", false);
    }
    $("#txtName").focus();
</script>

 <script language="Cache" runat="server" >
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
	//d ##class(VEFA.AlertCategory).DisableControls()
</script>
    

<br />


</FORM>
</center>
</body>
</html>
]]></CSP>


<CSP name="kbeditor/showalerttype.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KB Editor Alert Type</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <style type="text/css">
    	h1 {	
			margin:0;
	  	}
	  	
  		.ui-jqgrid .ui-widget-header {
			background: #0a1a4c;
		}

        .ReadOnly
        {
			background: #f5f5f5
		}
        #txtName
        {
            width: 400px;
        }
        #txtGenName
        {
            width: 400px;
        }
        #txtDescr
        {
            width: 400px;
        }
        #txtRemDlg
        {
            width: 400px;
        }
        #txtTIU
        {
            width: 400px;
        }
        #txtSite
        {
            width: 100px;
        }
        #selAlertCat
        {
            width: 400px;
        }
        #txtMnemonic
        {
            width: 100px;
        }
        #dtInit
        {
            width: 200px;
        }
        #ok
        {
            width: 100px;
        }
        #cancel
        {
            width: 100px;
        }
        #txtAreaResult {
            width: 888px;
            height: 52px;
            color: #0e1ed7;
            font-weight: bold;
        }     
        .button
        {
            width: 273px;
        }
		.auto-style1 {
            width: 688px;
        }
        .auto-style2 {
            width: 578px;
        }
        .auto-style3 {
            width: 654px;
        }
        .auto-style4 {
            width: 252px;
        }        
     </style>

	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />

    <style type="text/css">
	   #tabs {
            padding: 0px;
	   }
	   #tabs .ui-tabs-nav {
    	 background: transparent; 
         border-width: 0px 0px 1px 0px; 
         -moz-border-radius: 0px; 
         -webkit-border-radius: 0px; 
         border-radius: 0px; 
	   }
	   #tabs .ui-tabs-panel {
          margin: 0em 0.2em 0.2em 0.2em;
	   }
	    .style3
        {
            width: 267px;
        }

      	.ui-jqgrid tr.ui-row-ltr td {
			padding: 0 8px;
    	}
    	
		.ui-jqgrid tr.jqgrow td {
			word-wrap: break-word;
			white-space:normal !important;
    	}


	</style>

	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>
    <script src="jquery.ui.datepicker.js"></script>
    <script src="jquery.ui.button.js"></script>
    
	<script src="grid.locale-en.js"></script>
	<script src="jquery.jqGrid.min-aware.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.validate.min.js"></script>

    <script type="text/javascript">
		// Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

        var btnClicked = false;
		function NotNumber(str) {
			return ((str == "undefined") || (str == "") || isNaN(str));
	    }
	
        $(function () {
   		    var killSession = false;
		    
   	        window.onbeforeunload = function() {
	   	        if (killSession) {
					#server(VEFA.Login.KillSession())#;
	   	        }
	        }

  			var ordRowNum = $.cookie("ord.rowNum");
    	    if (NotNumber(ordRowNum)) {
        	    ordRowNum = 10;
	        } else {
    	        ordRowNum = parseInt(ordRowNum);
        	}
	
			var folRowNum = $.cookie("fol.rowNum");
    	    if (NotNumber(folRowNum)) {
        	    folRowNum = 10;
	        } else {
    	        folRowNum = parseInt(folRowNum);
        	}

			var cmtRowNum = $.cookie("cmt.rowNum");
    	    if (NotNumber(cmtRowNum)) {
        	    cmtRowNum = 10;
	        } else {
    	        cmtRowNum = parseInt(cmtRowNum);
        	}

            $("#form1").validate({
                rules: {
                    txtName: "required",
                    txtRemDlg: "required",
                    txtTIU: "required",
                    selAlertCat: "required",
                    dtInit: "required",
                    txtMnemonic: "required",
                    txtSite: "required"
                }
            });

			if (($.cookie("fromPage") == "showmain") || ($.cookie("updateResult") == "")) {
				clearUpdateResult();
			} else {
				showUpdateResult();
			}
			
			function showUpdateResult() {
				var updateResult = $.cookie("updateResult") ;
				$("#txtAreaResult").val(updateResult);
				$("#lblAreaResult").show();
				$("#txtAreaResult").show();
			}

			function clearUpdateResult() {
				$.cookie("fromPage", "alertType");
            	$("#txtAreaResult").val("");
				$("#lblAreaResult").hide();
				$("#txtAreaResult").hide();
			}

            $("#listOrder").jqGrid({
                datatype: "local",
                height: "auto",
                colNames: ["ID", "Seq", "Dialog Box Text", "Orderable Item Disp Grp", "Orderable Item Name", "Order Dlg Disp Grp",
                 "Order Dialog", "Addl Finding", "Desired OrdDlgPkg"],
                colModel: [
                    { name: "ien", width: 50, hidden:true },
                    { name: "seq", width: 50, sorttype: "number" },
                    { name: "boxText", width: 100 },
                    { name: "ordItemDispGrp", width: 130 },
                    { name: "ordItemName", width: 125 },
                    { name: "ordDlgDispGrp", width: 100 },
                    { name: "ordDlg", width: 100 },
                    { name: "AddFind", width: 100 },
       		        { name: "OrdDlgPkg", width: 100 }
                ],
                sortname: "seq",
                sortorder: "asc",
				hidegrid: false,
                pager: "#pagerOrder",
                rowNum: ordRowNum,
                rowList: [10, 20, 30, 40],
                viewrecords: true,
                gridview: true,
                autoencode: true,
                multiSelect: true,
                caption: "Order Dialog Box Text",
                ondblClickRow: function (rowId) {
                    editOrderDlg();
                },
  	            loadComplete: function () {
          			//var rowsPerPage = getGridSize("#listOrder");
	                //$("#listOrder").jqGrid("setGridHeight", (rowsPerPage * 23.5), true);
	            }

            }).navGrid("#pagerOrder", { add: false, edit: false, del: false, refresh: false, search: false })
            .navButtonAdd("#pagerOrder", {
                caption: "Add",
                buttonicon: "ui-icon-document",
                onClickButton: function () {
                    addOrderDlg();
                },
                position: "last"
            })
	        .navButtonAdd("#pagerOrder", {
	            caption: "Edit",
	            buttonicon: "ui-icon-folder-open",
	            onClickButton: function () {
	                editOrderDlg();
	            },
	            position: "last"
	        })
	        .navButtonAdd("#pagerOrder", {
	            caption: "Delete",
	            buttonicon: "ui-icon-trash",
	            onClickButton: function () {
	                delOrderDlg();
	            },
	            position: "last"
	        });

            $("#listOrder").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event
			genToolTips("#listOrder");
			//$("#pagerOrder_center").hide();
			$("#alertmod_listOrder").remove();
            $("#pagerOrder .ui-pg-selbox").prop("title","Select Page Size");
            $("#pagerOrder .ui-pg-input").prop("title","Enter Page Number");

            $("#listFol").jqGrid({
                datatype: "local",
                height: "auto",
                colNames: ["ID", "Seq", "Dialog Box Text", "Orderable Item Disp Grp", "Orderable Item Name", "Order Dlg Disp Grp",
                 "Order Dialog", "Addl Finding", "Desired OrdDlgPkg"],
                colModel: [
                    { name: "ien", width: 50, hidden:true },
                    { name: "seq", width: 50, sorttype: "number" },
                    { name: "boxText", width: 100 },
                    { name: "ordItemDispGrp", width: 130 },
                    { name: "ordItemName", width: 125 },
                    { name: "ordDlgDispGrp", width: 100 },
                    { name: "ordDlg", width: 100 },
                    { name: "AddFind", width: 100 },
       		        { name: "OrdDlgPkg", width: 100 }
                ],
                sortname: "seq",
                sortorder: "asc",
				hidegrid: false,
                pager: "#pagerFol",
                rowNum: folRowNum,
                rowList: [10, 20, 30, 40],
                viewrecords: true,
                gridview: true,
                autoencode: true,
                multiSelect: true,
                caption: "Follow-up Dialog Box Text",
                ondblClickRow: function (rowId) {
                    editFolDlg();
                },
  	            loadComplete: function () {
          			//var rowsPerPage = getGridSize("#listFol");
	                //$("#listFol").jqGrid("setGridHeight", (rowsPerPage * 23.5), true);
	            }
            }).navGrid("#pagerFol", { add: false, edit: false, del: false, refresh: false, search: false })
            .navButtonAdd("#pagerFol", {
                caption: "Add",
                buttonicon: "ui-icon-document",
                onClickButton: function () {
                    addFolDlg();
                },
                position: "last"
            })
	        .navButtonAdd("#pagerFol", {
	            caption: "Edit",
	            buttonicon: "ui-icon-folder-open",
	            onClickButton: function () {
	                editFolDlg();
	            },
	            position: "last"
	        })
	        .navButtonAdd("#pagerFol", {
	            caption: "Delete",
	            buttonicon: "ui-icon-trash",
	            onClickButton: function () {
	                delFolDlg();
	            },
	            position: "last"
	        });

            $("#listFol").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event
			genToolTips("#listFol");
			$("#alertmod_listFol").remove();
            $("#pagerFol .ui-pg-selbox").prop("title","Select Page Size");
            $("#pagerFol .ui-pg-input").prop("title","Enter Page Number");
			//$("#pagerFol_center").hide();

            $("#listCmt").jqGrid({
                datatype: "local",
                height: "auto",
                colNames: ["ID", "Seq", "Dialog Box Text", "Orderable Item Disp Grp", "Orderable Item Name", "Order Dlg Disp Grp",
                 "Order Dialog", "Addl Finding", "Desired OrdDlgPkg"],
                colModel: [
                    { name: "ien", width: 50, hidden:true },
                    { name: "seq", width: 50, sorttype: "number" },
                    { name: "boxText", width: 100 },
                    { name: "ordItemDispGrp", width: 130 },
                    { name: "ordItemName", width: 125 },
                    { name: "ordDlgDispGrp", width: 100 },
                    { name: "ordDlg", width: 100 },
                    { name: "AddFind", width: 100 },
       		        { name: "OrdDlgPkg", width: 100 }
                ],
                sortname: "seq",
                sortorder: "asc",
				hidegrid: false,
                pager: "#pagerCmt",
                rowNum: cmtRowNum,
                rowList: [10, 20, 30, 40],
                viewrecords: true,
                gridview: true,
                autoencode: true,
                multiSelect: true,
                caption: "Comments Dialog Box Text",
                ondblClickRow: function (rowId) {
                    editCmtDlg();
                },
  	            loadComplete: function () {
          			//var rowsPerPage = getGridSize("#listCmt");
	                //$("#listCmt").jqGrid("setGridHeight", (rowsPerPage * 23.5), true);
	            }
            }).navGrid("#pagerCmt", { add: false, edit: false, del: false, refresh: false, search: false })
            .navButtonAdd("#pagerCmt", {
                caption: "Add",
                buttonicon: "ui-icon-document",
                onClickButton: function () {
                    addCmtDlg();
                },
                position: "last"
            })
	        .navButtonAdd("#pagerCmt", {
	            caption: "Edit",
	            buttonicon: "ui-icon-folder-open",
	            onClickButton: function () {
	                editCmtDlg();
	            },
	            position: "last"
	        })
	        .navButtonAdd("#pagerCmt", {
	            caption: "Delete",
	            buttonicon: "ui-icon-trash",
	            onClickButton: function () {
	                delCmtDlg();
	            },
	            position: "last"
	        });
	        
            $("#listCmt").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event
			genToolTips("#listCmt");
			//$("#pagerCmt_center").hide();
			$("#alertmod_listCmt").remove();
            $("#pagerCmt .ui-pg-selbox").prop("title","Select Page Size");
            $("#pagerCmt .ui-pg-input").prop("title","Enter Page Number");

            $("#listIDC").jqGrid({
                datatype: "local",
                height: "auto",
                colNames: ["ID", "Diagnostic Code"],
                colModel: [
                    { name: "ien", width: 50, hidden:true },
                    { name: "code", width: 500 }
                ],
                sortname: "idcCode",
                sortorder: "asc",
				hidegrid: false,
                pager: "#pagerIDC",
                pgbuttons: false,
                viewrecords: false,
                pgtext: null,
                rowNum: 50,
                viewrecords: true,
                gridview: true,
                autoencode: true,
                multiSelect: true,
                caption: "Imaging Diagnostic Codes"
            }).navGrid("#pagerIDC", { add: false, edit: false, del: false, refresh: false, search: false })
            .navButtonAdd("#pagerIDC", {
                caption: "Add",
                buttonicon: "ui-icon-document",
                onClickButton: function () {
	                addCodeFilter("78.3", "Diagnostic Codes", "", "listIDC");
                },
                position: "last"
            })
	        .navButtonAdd("#pagerIDC", {
	            caption: "Delete",
	            buttonicon: "ui-icon-trash",
	            onClickButton: function () {
		            delCodeFilter("78.3", "listIDC");
	            },
	            position: "last"
	        });


            $("#listIDC").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event
			$("[name=rbIDC]").filter("[value='All']").prop("checked",true);

            $("#listISC").jqGrid({
                datatype: "local",
                height: "auto",
                colNames: ["ID", "Stop Code"],
                colModel: [
                    { name: "ien", width: 50, hidden:true },
                    { name: "code", width: 500 }
                ],
                sortname: "iscCode",
                sortorder: "asc",
				hidegrid: false,
                pager: "#pagerISC",
                pgbuttons: false,
                viewrecords: false,
                pgtext: null,
                rowNum: 50,
                viewrecords: true,
                gridview: true,
                autoencode: true,
                multiSelect: true,
                caption: "Imaging Stop Codes"
            }).navGrid("#pagerISC", { add: false, edit: false, del: false, refresh: false, search: false })
            .navButtonAdd("#pagerISC", {
                caption: "Add",
                buttonicon: "ui-icon-document",
                onClickButton: function () {
	                addCodeFilter("71.5", "Imaging Stop Codes", "", "listISC");
                },
                position: "last"
            })
	        .navButtonAdd("#pagerISC", {
	            caption: "Delete",
	            buttonicon: "ui-icon-trash",
	            onClickButton: function () {
	                delCodeFilter("71.5", "listISC");
	            },
	            position: "last"
	        });

            $("#listISC").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event
			$("[name=rbISC]").filter("[value='All']").prop("checked",true);

			$("[name=rbRpt]").filter("[value='All']").prop("checked",true);
			$("[name=rbImp]").filter("[value='All']").prop("checked",true);

            $("#ok")
            .button()
            .click(function () {
	            if (valLength()) {
                	btnClicked = true;
                	setCookies();
                	var activeIndex = $("#tabs").tabs("option", "active");
                	activeIndex = parseInt(activeIndex, 10);
                	$.cookie("type.lastTabIndex",activeIndex);
					saveRowsPerPage();                
                	killSession = false;
                	window.location = "savealerttype.csp";
	            }
            });

            $("#cancel")
            .button()
            .click(function () {
                btnClicked = true;
				saveRowsPerPage();                
                killSession = false;
                window.location = "showmain.csp";
            });

            $("#btnTIU")
            .button({ text: true, icons: { primary: "ui-icon ui-icon-search" } })
            .click(function () {
                var tiu = $("#txtTIU").val();
                if (tiu == "") {
                    alert('To search, enter "Start With" value in the TIU Template text Box');
                    $("#txtTIU").focus();
                } else {
                    searchFile("8927", "TIU Template", tiu, "txtTIU", "");
                }

            });

            $("#btnRemDlg")
            .button({ text: true, icons: { primary: "ui-icon-search" } })
            .click(function () {
                var remDlgVal = $("#txtRemDlg").val();
                if (remDlgVal == "") {
                    alert('To search, enter "Start With" value in the Reminder Dialog text Box');
                    $("#txtRemDlg").focus();
                } else {
                    searchFile('801.41', 'Reminder Dialog', remDlgVal, 'txtRemDlg', 'I $P(^(0),U,4)="R"');
                }
            });


            Mousetrap.bind("alt+g", function (e) {
                var activeIndex = $("#tabs").tabs("option", "active");
                activeIndex = parseInt(activeIndex, 10);
                $('#tabs').tabs({ active: activeIndex });
                if (activeIndex == 0) {
                  $("#txtName").focus();
                } else if (activeIndex == 1) {
                    selectOrdRow();
                } else if (activeIndex == 2) {
                    selectFolRow();
                } else if (activeIndex == 3) {
                    selectCmtRow();
                } else if (activeIndex == 4) {
	            	var activeIndex4 = $("#tabs-5").tabs("option", "active");
	                activeIndex4 = parseInt(activeIndex4, 10);
    	            $('#tabs-5').tabs({ active: activeIndex4 });
    	            if (activeIndex4 == 0) {
	    	            setCodeSelection("listIDC");
	    	        } else if (activeIndex4 == 1) {
	    	            setCodeSelection("listISC");
	    	        }
                }
            });

            Mousetrap.bind("ctrl+alt+n", function (e) {
                var activeIndex = $("#tabs").tabs("option", "active");
                activeIndex = parseInt(activeIndex, 10);
                $('#tabs').tabs({ active: activeIndex });
                if (activeIndex == 1) {
                    nextPage("#listOrder");
                } else if (activeIndex == 2) {
                    nextPage("#listFol");
                } else if (activeIndex == 3) {
                    nextPage("#listCmt");
                }
            });

	        function nextPage(grid) {
				var rowNum = $(grid).getGridParam("rowNum");
				var allRecs = $(grid).getGridParam("records");
				var totalPages = parseInt((allRecs/rowNum) + 1);
				var page = $(grid).getGridParam("page");
				if (page+1 <= totalPages) {
		        	$(grid).setGridParam({ page: (page+1) }).trigger("reloadGrid");
					$(grid).focus();
	        		$(grid + " tr").eq(1).trigger("click");
				}
	        }

            Mousetrap.bind("ctrl+alt+b", function (e) {
                var activeIndex = $("#tabs").tabs("option", "active");
                activeIndex = parseInt(activeIndex, 10);
                $('#tabs').tabs({ active: activeIndex });
                if (activeIndex == 1) {
                    prevPage("#listOrder");
                } else if (activeIndex == 2) {
                    prevPage("#listFol");
                } else if (activeIndex == 3) {
                    prevPage("#listCmt");
                }
            });
            
	        function prevPage(grid) {
				var page = $(grid).getGridParam("page");
				if (page > 0) {
		        	$(grid).setGridParam({ page: (page-1) }).trigger("reloadGrid");
					$(grid).focus();
	        		$(grid + " tr").eq(1).trigger("click");
				}
	        }

            Mousetrap.bind("ctrl+alt+a", function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 1) {
                    addOrderDlg();
	            } else if (activeIndex == 2) {
	                addFolDlg();
	            } else if (activeIndex == 3) {
	                addCmtDlg();
                } else if (activeIndex == 4) {
	            	var activeIndex4 = $("#tabs-5").tabs("option", "active");
	                activeIndex4 = parseInt(activeIndex4, 10);
    	            $('#tabs-5').tabs({ active: activeIndex4 });
    	            if (activeIndex4 == 0) {
		                addCodeFilter("78.3", "Diagnostic Codes", "", "listIDC");
	    	        } else if (activeIndex4 == 1) {
		                addCodeFilter("71.5", "Imaging Stop Codes", "", "listISC");
	    	        }
                }
	        });

	        Mousetrap.bind("ctrl+alt+e", function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 1) {
                    editOrderDlg();
	            } else if (activeIndex == 2) {
	                editFolDlg();
	            } else if (activeIndex == 3) {
	                editCmtDlg();
	            }
	        });

	        Mousetrap.bind("ctrl+alt+d", function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 1) {
                    delOrderDlg();
	            } else if (activeIndex == 2) {
	                delFolDlg();
	            } else if (activeIndex == 3) {
	                delCmtDlg();
                } else if (activeIndex == 4) {
	            	var activeIndex4 = $("#tabs-5").tabs("option", "active");
	                activeIndex4 = parseInt(activeIndex4, 10);
    	            $('#tabs-5').tabs({ active: activeIndex4 });
    	            if (activeIndex4 == 0) {
			            delCodeFilter("78.3", "listIDC");
	    	        } else if (activeIndex4 == 1) {
       	                delCodeFilter("71.5", "listISC");
	    	        }
                }
	        });

            window.onload = function () {
                var activeIndex = $("#tabs").tabs("option", "active");
                if (activeIndex == 1) {
                    $('#tabs').tabs({ active: 1 });
                    selectOrdRow();
                } else if (activeIndex == 2) {
                    $('#tabs').tabs({ active: 2 });
                    selectFolRow();
                } else if (activeIndex == 3) {
                    $('#tabs').tabs({ active: 3 });
                    selectCmtRow();
                }
            };

            $("#tabs").focus();
            $("#tabs").tabs();
            $("#tabs-5").tabs();
            $("#tabs li:nth-child(5)").css("visibility", "hidden"); //Remove this line if Filter is being used
            

            $("#dtInit").datepicker();

            selectLastTab();
            
            function setCookies() {
				var active = $("#chkActive").prop("checked") ? "1" : "0";
                var record = ""
                record = $("#txtName").val() + "^" +
                	$("#txtRemDlg").val() + "^" +
                	$("#txtTIU").val() + "^" +
					$("#selAlertCat").val() + "^" +
					$("#dtInit").val() + "^" +
					$("#txtMnemonic").val() + "^" +
					$("#txtSite").val() + "^" +
					active +"^" +
					$("#txtDescr").val() + "^" +
					$("#txtGenName").val() + "^" +
					$("input:radio[name=rbIDC]:checked").val() + "^" +
					$("input:radio[name=rbISC]:checked").val() + "^" +
					$("input:radio[name=rbRpt]:checked").val() + "^" +
					$("input:radio[name=rbImp]:checked").val() + "^" +
					$("#txtRpt").val() + "^" +
					$("#txtImp").val();
                $.cookie("type.record", record);
       			$.cookie("dlg.record", "");
            }

            function selectLastTab() {
                var lastTabIndex = $.cookie("type.lastTabIndex");
                lastTabIndex = parseInt(lastTabIndex, 10);
                $('#tabs').tabs({ active: lastTabIndex });
                if (lastTabIndex == 0) {
                    $("#txtName").focus();
                }
            }

            function addOrderDlg() {
                if (!btnClicked) {
                    btnClicked = true;

                    setCookies();
                    $.cookie("type.lastTabIndex", 1);
                    $.cookie("ord.lastrow", getLastRowId("#listOrder"));
                    $.cookie("ord.todo", "add");
					saveRowsPerPage();                
                    killSession = false;
                    window.location = "showorderdlg.csp";
                }
            }

            function editOrderDlg() {
                if (!btnClicked) {
                    setCookies();
                    var rowId = $("#listOrder").jqGrid("getGridParam", "selrow");
                    if (rowId == null) {
                        alert("No row selected");
                    } else {
	                    btnClicked = true;
                        var rowData = $("#listOrder").getRowData(rowId);
                        var ien = rowData["ien"];
                        $.cookie("type.lastTabIndex", 1);
                        $.cookie("ord.todo", "edit");
                        $.cookie("ord.id", rowId);
                        $.cookie("ord.ien", ien);
	    				saveRowsPerPage();                
    	                killSession = false;
    	                window.location = "showorderdlg.csp";
                    }
                }
            }

            function delOrderDlg() {
                if (!btnClicked) {
                    setCookies();
                    var rowId = $("#listOrder").jqGrid("getGridParam", "selrow");
                    if (rowId == null) {
                        alert("No row selected");
                    } else {
	                    if (confirm("Delete the selected Order Dialog")) {
	            		    btnClicked = true;
                            var rowData = $("#listOrder").getRowData(rowId);
    	                    var ien = rowData["ien"];
        	                $.cookie("type.lastTabIndex", 1);
                	        $.cookie("ord.todo", "delete");
                    	    $.cookie("ord.id", rowId);
                        	$.cookie("ord.ien", ien);
	        				saveRowsPerPage();                
    			           	killSession = false;
    			           	window.location = "saveorderdlg.csp";
	                    }
                    }
                }
            }

            function addFolDlg() {
                if (!btnClicked) {
                    btnClicked = true;
                    setCookies();
                    $.cookie("type.lastTabIndex", 2);
                    $.cookie("fol.lastrow", getLastRowId("#listFol"));
                    $.cookie("fol.todo", "add");
       				saveRowsPerPage();                
				    killSession = false;
				    window.location = "showfoldlg.csp";
                }
            }

            function editFolDlg() {
                if (!btnClicked) {
                    setCookies();
                    var rowId = $("#listFol").jqGrid("getGridParam", "selrow");
                    if (rowId == null) {
                        alert("No row selected");
                    } else {
	                    btnClicked = true;
                        var rowData = $("#listFol").getRowData(rowId);
                        var ien = rowData["ien"];
                        $.cookie("type.lastTabIndex", 2);
                        $.cookie("fol.todo", "edit");
                        $.cookie("fol.id", rowId);
                        $.cookie("fol.ien", ien);
           				saveRowsPerPage();                
						killSession = false;
						window.location = "showfoldlg.csp";
                    }
                }
            }

            function delFolDlg() {
                if (!btnClicked) {
                    setCookies();
                    var rowId = $("#listFol").jqGrid("getGridParam", "selrow");
                    if (rowId == null) {
                        alert("No row selected");
                    } else {
	                    if (confirm("Delete the selected Follow-up Dialog")) {
	            		    btnClicked = true;
                            var rowData = $("#listFol").getRowData(rowId);
    	                    var ien = rowData["ien"];
        	                $.cookie("type.lastTabIndex", 2);
                	        $.cookie("fol.todo", "delete");
                    	    $.cookie("fol.id", rowId);
                        	$.cookie("fol.ien", ien);
               				saveRowsPerPage();                
							killSession = false;
							window.location = "savefoldlg.csp";
	                    }
                    }
                }
            }

            function addCmtDlg() {
                if (!btnClicked) {
                    btnClicked = true;
                    setCookies();
                    $.cookie("type.lastTabIndex", 3);
                    $.cookie("cmt.lastrow", getLastRowId("#listCmt"));
                    $.cookie("cmt.todo", "add");
       				saveRowsPerPage();                
                    killSession = false;
                    window.location = "showcmtdlg.csp";
                }
            }

            function editCmtDlg() {
                if (!btnClicked) {
                    setCookies();
                    var rowId = $("#listCmt").jqGrid("getGridParam", "selrow");
                    if (rowId == null) {
                        alert("No row selected");
                    } else {
	                    btnClicked = true;
                        var rowData = $("#listCmt").getRowData(rowId);
                        var ien = rowData["ien"];
                        $.cookie("type.lastTabIndex", 3);
                        $.cookie("cmt.todo", "edit");
                        $.cookie("cmt.id", rowId);
                        $.cookie("cmt.ien", ien);
						saveRowsPerPage();                
                        killSession = false;
                        window.location = "showcmtdlg.csp";
                    }
                }
            }

            function delCmtDlg() {
                if (!btnClicked) {
                    setCookies();
                    var rowId = $("#listCmt").jqGrid("getGridParam", "selrow");
                    if (rowId == null) {
                        alert("No row selected");
                    } else {
	                    if (confirm("Delete the selected Comments Dialog")) {
	            		    btnClicked = true;
                            var rowData = $("#listCmt").getRowData(rowId);
    	                    var ien = rowData["ien"];
        	                $.cookie("type.lastTabIndex", 3);
                	        $.cookie("cmt.todo", "delete");
                    	    $.cookie("cmt.id", rowId);
                        	$.cookie("cmt.ien", ien);
	        				saveRowsPerPage();                
    		            	killSession = false;
    		            	window.location = "savecmtdlg.csp";
	                    }
                    }
                }
            }

            function getLastRowId(list) {
                var rows = $(list)[0].rows;
                return (rows.length - 1);
            }

            function selectOrdRow() {
                $("#listOrder").focus();
                var id = $.cookie("ord.id");
                if (typeof id == "undefined") {
                    id = 1;
                    $.cookie("ord.id", id);
                } else if (id == "") {
                    id = $.cookie("ord.lastrow");
                    id = parseInt(id, 10) + 1;
                    $.cookie("ord.id", id);
                }
                $("#listOrder").jqGrid("setSelection", id);
            }

            function selectFolRow() {
                $("#listFol").focus();
                var id = $.cookie("fol.id");
                if (typeof id == "undefined") {
                    id = 1;
                    $.cookie("fol.id", id);
                } else if (id == "") {
                    id = $.cookie("fol.lastrow");
                    id = parseInt(id, 10) + 1;
                    $.cookie("fol.id", id);
                }
                $("#listFol").jqGrid("setSelection", id);
            }

            function selectCmtRow() {
                $("#listCmt").focus();
                var id = $.cookie("cmt.id");
                if (typeof id == "undefined") {
                    id = 1;
                    $.cookie("cmt.id", id);
                } else if (id == "") {
                    id = $.cookie("cmt.lastrow");
                    id = parseInt(id, 10) + 1;
                    $.cookie("cmt.id", id);
                }
                $("#listCmt").jqGrid("setSelection", id);
            }

			function setCodeSelection(list) {
				$("#" + list).focus();
	            var rowId = $("#" + list).jqGrid("getGridParam", "selrow");
	            if (rowId == null) {
                     rowId = 1;
	            } else {
	                 rowId = parseInt(rowId, 10);
	            }
                $("#" + list).jqGrid("setSelection", rowId);
			}
			
            function addCodeFilter(filenumber, filename, screen, grid) {
                var features = "dialogwidth: 550px; dialogheight: 700px; resizable: yes";

                $.cookie("search.dlgFile", "");
                $.cookie("search.filenumber", filenumber);
                $.cookie("search.filename", filename);
                $.cookie("search.value", "");
                $.cookie('search.screen', screen);

				var code = window.showModalDialog("searchfile.csp", null, "dialogHeight:700px;dialogWidth:500px");
				if (typeof code === "undefined") {
				} else {
					var lastId = 1;
					var recordCount = $("#" + grid).jqGrid('getGridParam', 'reccount');
					if ( recordCount > 0) {
						lastId = recordCount + 1;
					}
					
		    	    var result = #server(VEFA.AlertType.AddFilterCode(filenumber, code))#;
					if (result == "1") {
						var newData = {ien:lastId, code: code};
						$("#" + grid).jqGrid("addRowData", lastId, newData, "last");
					} else {
						alert("Problem adding Code. Error=" + result);
					}
				}

            }

  		    function delCodeFilter(filenumber, list) {
	            var rowId = $("#" + list).jqGrid("getGridParam", "selrow");
                if (rowId == null) {
    	            alert("No row selected");
                } else {
	                var rowData = $("#" + list).getRowData(rowId);
	                var code = rowData.code;
		    	    var result = #server(VEFA.AlertType.DeleteFilterCode(filenumber, code))#;
					if (result == "1") {
		              	$("#" + list).jqGrid("delRowData",rowId);
					} else {
						alert("Problem deleting Code. Error=" + result);
					}
                }
        	}

            function searchFile(filenumber, filename, searchval, element, screen) {
                var features = "dialogwidth: 550px; dialogheight: 700px; resizable: yes";

                $.cookie("search.dlgFile", "");
                $.cookie("search.filenumber", filenumber);
                $.cookie("search.filename", filename);
                $.cookie("search.value", searchval);
                $.cookie('search.screen', screen);

				var remDlg = window.showModalDialog("searchfile.csp", null, "dialogHeight:700px;dialogWidth:500px");
				if (typeof remDlg === "undefined") {
				} else {
					$("#" + element).val(remDlg);
				}

                //window.open("searchfile.csp", "_blank", "height=700,width=550,status=yes,toolbar=no,menubar=no,location=no");
            }

  	        function getGridSize(grid) {
	            var rowsPerPage = $(grid).getGridParam("rowNum");
	            if (NotNumber(rowsPerPage)) {
	                rowsPerPage = 10;
	            } else {
		            rowsPerPage = parseInt(rowsPerPage);
	            }
	            return rowsPerPage;
	        }

			function saveRowsPerPage() {
   				var rowsPerPage = $("#listOrder").getGridParam("rowNum");
                $.cookie("ord.rowNum", rowsPerPage, { expires: 10000 });
   				var page = $("#listOrder").getGridParam("page");
                $.cookie("ord.page", page);

   				var rowsPerPage = $("#listFol").getGridParam("rowNum");
                $.cookie("fol.rowNum", rowsPerPage, { expires: 10000 });
   				var page = $("#listFol").getGridParam("page");
                $.cookie("fol.page", page);

   				var rowsPerPage = $("#listCmt").getGridParam("rowNum");
                $.cookie("cmt.rowNum", rowsPerPage, { expires: 10000 });
   				var page = $("#listCmt").getGridParam("page");
                $.cookie("cmt.page", page);
			}

        });

		function valLength() {
			var fld = "#txtName";
			var val = valFieldLength(fld, "Alert Type", 3, 30);
			if (val) {
				fld = "#txtGenName";
				val = valFieldLength(fld, "Generic Name", 3, 30);
			}
			if (val) {
				fld = "#txtDescr";
				val = valFieldLength(fld, "Description", 3, 40);
			}
			if (!val) {
				$(fld).focus();
			}

			return val;
		}
		
		function valFieldLength(fld, caption, low, high) {
			if (($(fld).val().length > high) || ($(fld).val().length < low)) {
				alert(caption + " must be " + low + "-" + high + " characters in length");
				return false;
			} else {
				return true;
			}
		}

		var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}

		function genToolTips(grid) {
	        $(grid + "_seq").attr("title", "Sort By: Sequence #");
	        $(grid + "_boxText").attr("title", "Sort By: Dialog Box Text");
	        $(grid + "_ordItemDispGrp").attr("title", "Sort By: Orderable Item Display Group");
	        $(grid + "_ordItemName").attr("title", "Sort By: Orderable Item Name");
	        $(grid + "_ordDlgDispGrp").attr("title", "Sort By: Order Dialog Display Group");
	        $(grid + "_ordDlg").attr("title", "Sort By: Order Dialog");
	        $(grid + "_AddFind").attr("title", "Sort By: Additional Finding");
	        $(grid + "_OrdDlgPkg").attr("title", "Sort By: Desired Order Dialog Package");
		}


	</script>

</head>
<body>

<center>

<FORM id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:900px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE KB Editor</h1>
			<h1>Alert Type</h1>

        </td>
    </table>
</div>


<div id='tabs' text-align:left>
    <ul>
        <li><a id='tabRem' href='#tabs-1'>Reminder Dialog</a></li>
        <li><a id='tabOrder' href='#tabs-2'>Order Dialog</a></li>
        <li><a id='tabFol' href='#tabs-3'>Follow-up Dialog</a></li>
	    <li><a id='tabCmt' href='#tabs-4'>Comments Dialog</a></li>
	    <li><a id='tabFilter' href='#tabs-5'>Filter Criteria</a></li>	
	</ul>
	
    <div id='tabs-1'>
        <table class="ui-widget ui-state-default ui-corner-all" style="width: 100%;">
        
        <tr>
        <td align="right" >
            <label for="txtName">Alert Type</label></td>
        <td align="left">
            <input id="txtName" name="txtName" align="left" type="text" 
                class="ui-widget ui-corner-all" />&nbsp;
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtDescr">Description</label></td>
        <td align="left">
            <input id="txtDescr" name="txtDescr" align="left" type="text" 
                class="ui-widget ui-corner-all" />&nbsp;
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtGenName">Generic Name</label></td>
        <td align="left">
            <input id="txtGenName" name="txtGenName" align="left" type="text" 
                class="ui-widget ui-corner-all" />&nbsp;
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtRemDlg">Reminder Dialog</label></td>
        <td align="left">
            <input id="txtRemDlg" name="txtRemDlg" align="left" type="text" 
                class="ui-widget ui-corner-all required" />
            <input id="btnRemDlg" type="button" align="left" value="Search" /></td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtTIU">TIU Template</label></td>
        <td align="left">
            <input id="txtTIU" name="txtTIU" align="left" type="text" 
                class="ui-widget ui-corner-all"  />
            <input id="btnTIU" type="button" align="left" value="Search" /></td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="selAlertCat">Alert Category</label></td>
        <td align="left">
            <select id="selAlertCat" name="selAlertCat" class="ui-widget ui-corner-all" >
	        </select>
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtMnemonic">Alert Type Mnemonic</label></td>
        <td align="left">
            <input id="txtMnemonic" name="txtMnemonic" type="text" 
                class="ui-widget ui-corner-all" />
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtSite">AWARE Source Site</label></td>
        <td align="left">
            <input id="txtSite" name="txtSite" type="text" 
                class="ui-widget ui-corner-all" />
        </td>
        </tr>
        
        </table>
    </div>

    <div id='tabs-2'>
        <table id="listOrder"></table>
        <div id="pagerOrder"></div>
		<table style="width: 700px">
            <tr>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Alt+G to Last Accessed Record</br>Ctrl+Alt+A to Add</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+N to Next Page</br>Ctrl+Alt+E to Edit</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+B to Previous Page</br>Ctrl+Alt+D to Delete</p>
                </td>
           </tr>
        </table>
    </div>

   <div id='tabs-3'>
        <table id="listFol"></table>
        <div id="pagerFol"></div>
		<table style="width: 700px">
            <tr>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Alt+G to Last Accessed Record</br>Ctrl+Alt+A to Add</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+N to Next Page</br>Ctrl+Alt+E to Edit</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+B to Previous Page</br>Ctrl+Alt+D to Delete</p>
                </td>
           </tr>
        </table>
   </div>

   <div id='tabs-4'>
        <table id="listCmt"></table>
        <div id="pagerCmt"></div>
		<table style="width: 700px">
            <tr>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Alt+G to Last Accessed Record</br>Ctrl+Alt+A to Add</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+N to Next Page</br>Ctrl+Alt+E to Edit</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+B to Previous Page</br>Ctrl+Alt+D to Delete</p>
                </td>
           </tr>
        </table>
   </div>

   <div id='tabs-5'>
   		<ul>
    		<li><a id='tabIDC' href='#tabs-51'>Imaging Diagnostic Codes</a></li>
	        <li><a id='tabRAD' href='#tabs-52'>RAD Codes</a></li>
    	    <li><a id='tabRpt' href='#tabs-53'>Report Text</a></li>
	    	<li><a id='tabImp' href='#tabs-54'>Impression Text</a></li>
		</ul>

		<div id='tabs-51'>
			<input type="radio" name="rbIDC" value="A" checked="checked">Include All Codes</input>
			<input type="radio" name="rbIDC" value="I">Include Codes in the list</input>
			<input type="radio" name="rbIDC" value="E">Exclude Codes in the list</input>
			</br>
			</br>
			<table id="listIDC"></table>
	        <div id="pagerIDC"></div>
       		<table style="width: 700px">
            <tr>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Alt+G to Last Accessed Record</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+A to Add</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+D to Delete</p>
                </td>
            </tr>
		    </table>
	   	</div>
		<div id='tabs-52'>
			<input type="radio" name="rbISC" value="A" checked="checked">Include All Codes</input>
			<input type="radio" name="rbISC" value="I">Include Codes in the list</input>
			<input type="radio" name="rbISC" value="E">Exclude Codes in the list</input>
    		</br>
			</br>
			<table id="listISC"></table>
	        <div id="pagerISC"></div>
       		<table style="width: 700px">
            <tr>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Alt+G to Last Accessed Record</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+A to Add</p>
                </td>
                <td>
                  <p style="font-size:70%; color:#001A4C; text-align:left;">Ctrl+Alt+D to Delete</p>
                </td>
            </tr>
		    </table>
	   	</div>
		<div id='tabs-53'>
			<input type="radio" name="rbRpt" value="A" checked="checked">Include All Texts</input>
			<input type="radio" name="rbRpt" value="I">Include Texts in the list</input>
			<input type="radio" name="rbRpt" value="E">Exclude Texts in the list</input>
    		</br>
			</br>
			<textarea name="txtRpt" id="txtRpt" cols=75 rows=15></textarea>
	   	</div>
		<div id='tabs-54'>
    		<table id="listImp"></table>
	        <div id="pagerImp"></div>
			<input type="radio" name="rbImp" value="A" checked="checked">Include All Texts</input>
			<input type="radio" name="rbImp" value="I">Include Texts in the list</input>
			<input type="radio" name="rbImp" value="E">Exclude Texts in the list</input>
    		</br>
			</br>
			<textarea name="txtImp" id="txtImp" cols=75 rows=15></textarea>
	   	</div>
   </div>

</div>

<div style="width: 900px">
    <table style="width: 900px">
	   	<tr>
	        <td align="left" class="auto-style4">
             <input id="chkActive" name="chkActive" type="checkbox" /><label for="chkActive">Active</label>
           &nbsp;
            </td>

  	        <td align="right" class="auto-style3">
		     <label for="dtInit">Initiation Date</label>
            </td>
  	        
  	        <td align="left" class="auto-style2">
             <input id="dtInit" name="dtInit" type="text" align="left" class="ReadOnly ui-widget ui-corner-all" readonly/>
            </td>
       	

		    <td align="right" class="auto-style1">
	            &nbsp;<input id="ok" name="ok" type="button" value="OK" />
	        </td>

	        <td align="left" class="button">
    	        &nbsp;<input type="button" value="Cancel" id="cancel" name="cancel" >
        	</td>

	    </tr>

    </table>
</div>

</FORM>

<script language="Cache" runat="server" >
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
	d ##class(VEFA.AlertType).Populate()
</script>

<script type="text/javascript">
	
	$(function () {
        fillForm();
    
		var reminderDlg = $("#txtName").val();
	    if (reminderDlg != "") {
		   		$("#listOrder").setCaption(reminderDlg + " - Order Dialog Box Text");
		   		$("#listFol").setCaption(reminderDlg + " - Follow-up Dialog Box Text");
		   		$("#listCmt").setCaption(reminderDlg + " - Comments Dialog Box Text");
	    }

        fillOrdDlg();
        fillfollDlg();
        fillCmtDlg();
		fillDiagCodes();
		fillStopCodes();
		
		//Set Order Dialog Grid Size
	    var ordRowNum = $.cookie("ord.rowNum");
         
         if (NotNumber(ordRowNum)) {
             ordRowNum = 10;
             $.cookie("ord.rowNum", ordRowNum, { expires: 10000 });
         } else{
	         ordRowNum = parseInt(ordRowNum,10);
         }

		 //Set Followup Grid Size
	     var folRowNum = $.cookie("fol.rowNum");
         
         if (NotNumber(folRowNum)) {
             folRowNum = 10;
             $.cookie("fol.rowNum", folRowNum, { expires: 10000 });
         } else {
	         folRowNum = parseInt(folRowNum);
         }
 
		 //Set Comments Grid Size
	     var cmtRowNum = $.cookie("cmt.rowNum");
         
         if (NotNumber(cmtRowNum)) {
             cmtRowNum = 10;
             $.cookie("cmt.rowNum", cmtRowNum, { expires: 10000 });
         } else {
	         cmtRowNum = parseInt(cmtRowNum);
         }

	     //Set order dialog page and row id
	     var pageNum = $.cookie("ord.page")
	     if (NotNumber(pageNum)) {
		     pageNum = 1;
	     } else {
		     pageNum = parseInt(pageNum);
	     }
         $("#listOrder").setGridParam({ page: pageNum, rowNum: ordRowNum }).trigger("reloadGrid");
         

	     var rowID = $.cookie("ord.id");
	     if (NotNumber(rowID)) {
		     rowID = 1;
	     } else {
		     rowID = parseInt(rowID);
	     }
	                
         $("#listOrder").jqGrid("setSelection", rowID);
         
         
	     //Set followup dialog page and row id
	     var pageNum = $.cookie("fol.page")
	     if (NotNumber(pageNum)) {
		     pageNum = 1;
	     } else {
		     pageNum = parseInt(pageNum);
	     }
         $("#listFol").setGridParam({ page: pageNum, rowNum: folRowNum }).trigger("reloadGrid");

	     var rowID = $.cookie("fol.id");
	     if (NotNumber(rowID)) {
		     rowID = 1;
	     } else {
		     rowID = parseInt(rowID);
	     }
	                
         $("#listFol").jqGrid("setSelection", rowID);

	     //Set comments dialog page and row id
	     var pageNum = $.cookie("cmt.page")
	     if (NotNumber(pageNum)) {
		     pageNum = 1;
	     } else {
		     pageNum = parseInt(pageNum);
	     }
         $("#listCmt").setGridParam({ page: pageNum, rowNum: cmtRowNum }).trigger("reloadGrid");

	     var rowID = $.cookie("cmt.id");
	     if (NotNumber(rowID)) {
		     rowID = 1;
	     } else {
		     rowID = parseInt(rowID);
	     }
	                
         $("#listCmt").jqGrid("setSelection", rowID);

	    
    });
    
</script>


<p>
	<label id="lblAreaResult" name="lblAreaResult" for="txtAreaResult" class="ui-widget"><b>Validation Result</b></label></br>
    <textarea id="txtAreaResult" name="txtAreaResult" readonly class="ReadOnly ui-widget ui-corner-all"></textarea>
</p>

</center>
</body>
</html>
]]></CSP>


<CSP name="kbeditor/showcmtdlg.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KB Editor Alert Type</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <style type="text/css">
    	h1 {	
			margin:0;
	  	}
	  	
    	.TxtBoxWidth
        {
            width: 400px;
        }

    	.NumberWidth
        {
            width: 150px;
        }

        .ReadOnly
        {
			background: #f5f5f5
		}

        #chkOrdItemReq
        {
            width: 26px;
        }

		#txtAreaResult {
            width: 888px;
            height: 52px;
            color: #0e1ed7;
            font-weight: bold;
        }     
	</style>

	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />

    <style type="text/css">
	   #tabs {
            padding: 0px;
	   }
	   #tabs .ui-tabs-nav {
    	 background: transparent; 
         border-width: 0px 0px 1px 0px; 
         -moz-border-radius: 0px; 
         -webkit-border-radius: 0px; 
         border-radius: 0px; 
	   }
	   #tabs .ui-tabs-panel {
          margin: 0em 0.2em 0.2em 0.2em;
	   }
	    
	    .style1
        {
            height: 29px;
        }
	    
	</style>

	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>
    <script src="jquery.ui.datepicker.js"></script>
    
	<script src="grid.locale-en.js"></script>
	<script src="jquery.jqGrid.min-aware.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.validate.min.js"></script>

    <script type="text/javascript">
		// Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

        var btnClicked = false;

        $(function () {
   		    var killSession = false;
		    
   	        window.onbeforeunload = function() {
	   	        if (killSession) {
					#server(VEFA.Login.KillSession())#;
	   	        }
	        }

            $("#form1").validate({
                rules: {
                    txtName: "required",
                    selOrdDlgPkg: "required",
                    txtDesired: "required"
                }
            });

			$("#btnSearch")
            .button({ text: true, icons: { primary: "ui-icon ui-icon-search" } })
            .click(function () {
	            searchReminderDlg();
            });

            $("#ok")
            .button()
            .click(function () {
	            if (valLength()) {
	                if (!btnClicked) {
    	                btnClicked = true;
        	            setCookies();
		    	        $.cookie("cmt.form", "close");
						clearUpdateResult();
                    	killSession = false;
                    	window.location = "savecmtdlg.csp";
	                }
                }
            });

            $("#update")
            .button()
            .click(function () {
	            if (valLength()) {
	                if (!btnClicked) {
    	                btnClicked = true;
        	            setCookies();
						$.cookie("cmt.form", "update");
						clearUpdateResult();
                    	killSession = false;
                    	window.location = "savecmtdlg.csp";
	                }
                }
            });


            $("#cancel")
            .button()
            .click(function () {
                if (!btnClicked) {
                    btnClicked = true;
                    killSession = false;
                    window.location = "showalerttype.csp";
                }
            });

            fillForm();

			if ($.cookie("fromPage") == "saveCmtDlg") {
				showUpdateResult();
			} else {
				clearUpdateResult();
			}
			
	        $("#txtName").focus();

			function showUpdateResult() {
				var updateResult = $.cookie("updateResult") ;
				$("#txtAreaResult").val(updateResult);
				$("#txtAreaResult").show();
				$("#lblAreaResult").show();

				var todo = $.cookie("cmt.todo");
				if (todo == "add") {
					var record = $.cookie("dlg.record");
					var recAry = record.split("^");
	            
        	        $("#txtName").val(recAry[0]);
            	    $("#selOrdDlgPkg").val(recAry[6]);
                	$("#txtComment").val(recAry[7]);
	                $("#txtDesired").val(recAry[8]);
                
		            var itemReq = recAry[9];
	    	        if (itemReq == "1") {
		    	        $("#chkOrdItemReq").prop("checked", true);
		            } else {
			            $("#chkOrdItemReq").prop("checked", false);
		           }

				}
				

			}

			function clearUpdateResult() {
				$.cookie("fromPage", "cmtdlg");
            	$("#txtAreaResult").val("");
				$("#txtAreaResult").hide();
				$("#lblAreaResult").hide();
			}

            function setCookies() {
	            var itemReq = $("#chkOrdItemReq").prop("checked") ? "1" : "0";
                var record = $("#txtName").val() + "^" +
                $("#txtOrdItemDispGrp").val() + "^" +
                $("#txtOrdItemName").val() + "^" +
                $("#txtOrdDlgDispGrp").val() + "^" +
                $("#txtOrdDlg").val() + "^" +
                $("#txtAddFind").val() + "^" +
                $("#selOrdDlgPkg").val() + "^" +
                $("#txtComment").val() + "^" +
                $("#txtDesired").val() + "^" +
                itemReq  + "^" +
                $("#txtSeqNumber").val();
                $.cookie("dlg.record", record)
            }

			function searchReminderDlg() {
    			var features = "dialogwidth: 550px; dialogheight: 700px; resizable: yes";
				var searchval = $("#txtDesired").val();

				if (searchval == "") {
					var record = $.cookie("type.record");
					var arr = record.split("^");
	                var searchval = "AW" + arr[6] + " " + arr[5];
				}

                $.cookie("search.dlgFile", "19007.03");
                $.cookie("search.filenumber", "801.41");
                $.cookie("search.filename", "Reminder Dialog");
                $.cookie("search.value", searchval);
                $.cookie('search.screen', 'I $P(^(0),U,4)="E"');

				var remDlg = window.showModalDialog("searchfile.csp", null, "dialogHeight:700px;dialogWidth:500px");
				if (typeof remDlg === "undefined") {
				} else {
					var res = remDlg.split(" (#");
					$("#txtDesired").val(res[0]);
					var seq = res[1].split(")");
					$("#txtSeqNumber").val(seq[0]);
				}
				//window.open("searchfile.csp", "_blank", "height=700,width=550,status=yes,toolbar=no,menubar=no,location=no");
            }
            

        });

		function valLength() {
			var fld = "#txtName";
			var val = valFieldLength(fld, "Order Dialog Box Text", 1, 240);
			if (!val) {
				$(fld).focus();
			}
			return val;
		}
		
		function valFieldLength(fld, caption, low, high) {
			if (($(fld).val().length > high) || ($(fld).val().length < low)) {
				alert(caption + " must be " + low + "-" + high + " characters in length");
				return false;
			} else {
				return true;
			}
		}

		var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}

		function setSeqNumber(remDlg) {
			var alertType = $.cookie("type.ien");
			var seq = $("#txtSeqNumber").val();
			if ((alertType != "") && (remDlg !="") && (seq == "")) {
		        #server(VEFA.OrderDialog.SetSequenceNumber(19007.03,alertType, remDlg))#;
			}
		}


    </script>

</head>
<body>

<center>

<FORM id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:900px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
        	<h1>VistA AWARE KB Editor</h1>
			<h1>Comments Dialog</h1>
		</td>
    </table>
</div>

</br>
	
<div>
        <table class="ui-widget ui-state-default ui-corner-all" style="width: 100%;">
        
		<tr>
        <td align="right" >
            Alert Type</td>
        <td align="left">
			<label id="txtReminderDlg" for="form1" style="color:#654D00">AlertType</label>
        </td>
      	</tr>

        <tr>
        <td align="right" >
            <label for="txtName">Order Dialog Box Text</label></td>
        <td align="left">
            <input id="txtName" name="txtName" class="ui-widget ui-corner-all TxtBoxWidth" type="text" /></td>
        </tr>

       <tr>
        <td align="right" >
            <label for="txtDesired">Desired Reminder Element</label></td>
        <td align="left">
            <input id="txtDesired" name="txtDesired" class="ui-widget ui-corner-all TxtBoxWidth" type="text" />
		    <input id="btnSearch" type="button" align="left" value="Search" /></td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtSeqNumber">Sequence Number</label></td>
        <td align="left">
            <input id="txtSeqNumber" name="txtSeqNumber" class="ui-widget ui-corner-all NumberWidth" type="text" />
        </tr>

        <tr>
        <td align="left">
            <input id="txtComment" class="ui-widget ui-corner-all TxtBoxWidth" type="hidden" 
                name="txtComment" /></td>
        </tr>

        <tr>
        <td align="right" >
            <label for="selOrdDlgPkg">Desired Order Dialog Package</label></td>
        <td align="left">
            <select id="selOrdDlgPkg" name="selOrdDlgPkg" class="ui-widget ui-corner-all TxtBoxWidth" >
                <option></option>
            </select></td>
        </tr>

        <tr>
        <td align="right" >
            &nbsp;</td>
        <td align="left">
            &nbsp;<input id="chkOrdItemReq" type="checkbox" 
                name="chkOrdItemReq" class="ui-widget ui-corner-all" /><label for="chkOrdItemReq">Orderable Item Required</label></td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdItemDispGrp">Orderable Item Display Group</label></td>
        <td align="left">
            <input id="txtOrdItemDispGrp" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrdItemDispGrp" readonly /></td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdItemName">Orderable Item Name</label></td>
        <td align="left">
            <input id="txtOrdItemName" name="txtOrdItemName" align="left" type="text" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly/>&nbsp;
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdDlgDispGrp">Order Dialog Display Group</label></td>
        <td align="left">
            <input id="txtOrdDlgDispGrp" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrdDlgDispGrp" readonly/></td>
        </td>
        </tr>

        <tr>
        <td align="right" hidden="true">
            <label for="txtOrgOrdDlgPkg">Order Dialog Package</label></td>
        <td align="left" hidden="true">
            <input id="txtOrgOrdDlgPkg" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrgOrdDlgPkg" readonly/></td>
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtOrdDlg">Order Dialog</label></td>
        <td align="left">
            <input id="txtOrdDlg" name="txtOrdDlg" type="text" align="left" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" 
                />&nbsp;
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtAddFind">Additional Finding</label></td>
        <td align="left">
            <input id="txtAddFind" name="txtAddFind" type="text" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly />
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtAreaNote">Progress Note</label></td>
        <td align="left">
            <textarea id="txtAreaNote" name="txtAreaNote" rows="5" cols="50" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly 
            ></textarea>
        </td>
        </tr>

        </table>
</div>

</br>

<div style="width: 731px">
    <table style="width: 400px">
    <tr>
        <td align="left" class="style2">
            &nbsp; <!-- <p style="font-size:70%; color:#4682B4; text-align:left;">Alt+S to switch between Tabs</p> -->
        </td>
    
        <td align="left" class="button">
            &nbsp;<input id="ok" name="ok" type="button" value="Update and Close" />
        </td>

        <td align="left" class="button">
            &nbsp;<input id="update" type="button" name="update" value="Update" />
        </td>
    
        <td align="left" class="button">
            &nbsp;<input value="Close" type="button" id="cancel" name="cancel" >
         </td>
         
         
    </tr>

    </table>
</div>

 <script language="Cache" runat="server" >
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
  	d ##class(VEFA.OrderDialog).FillCommentDlg()
</script>


<br />



</FORM>



<p>
	<label id="lblAreaResult" name="lblAreaResult" for="txtAreaResult" class="ui-widget"><b>Validation Result</b></label></br>
    <textarea id="txtAreaResult" name="txtAreaResult" readonly class="ReadOnly ui-widget ui-corner-all"></textarea>
</p>


</center>
</body>
</html>
]]></CSP>


<CSP name="kbeditor/showfoldlg.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KB Editor Alert Type</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <style type="text/css">
    	h1 {	
			margin:0;
	  	}
	  	
    	.TxtBoxWidth
        {
            width: 400px;
        }

    	.NumberWidth
        {
            width: 150px;
        }

        .ReadOnly
        {
			background: #f5f5f5
		}

        #chkOrdItemReq
        {
            width: 26px;
        }
        
		#txtAreaResult {
            width: 888px;
            height: 52px;
            color: #0e1ed7;
            font-weight: bold;
        }     
	</style>

	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />

    <style type="text/css">
	   #tabs {
            padding: 0px;
	   }
	   #tabs .ui-tabs-nav {
    	 background: transparent; 
         border-width: 0px 0px 1px 0px; 
         -moz-border-radius: 0px; 
         -webkit-border-radius: 0px; 
         border-radius: 0px; 
	   }
	   #tabs .ui-tabs-panel {
          margin: 0em 0.2em 0.2em 0.2em;
	   }
	    
	    .style1
        {
            height: 29px;
        }
	    
	</style>

	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>
    <script src="jquery.ui.datepicker.js"></script>
    
	<script src="grid.locale-en.js"></script>
	<script src="jquery.jqGrid.min-aware.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.validate.min.js"></script>

    <script type="text/javascript">
		// Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

        var btnClicked = false;

        $(function () {
   		    var killSession = false;
		    
   	        window.onbeforeunload = function() {
	   	        if (killSession) {
					#server(VEFA.Login.KillSession())#;
	   	        }
	        }

            $("#form1").validate({
                rules: {
                    txtName: "required",
                    selOrdDlgPkg: "required",
                    txtDesired: "required"
                }
            });


			$("#btnSearch")
            .button({ text: true, icons: { primary: "ui-icon ui-icon-search" } })
            .click(function () {
	            searchReminderDlg();
            });

            $("#ok")
            .button()
            .click(function () {
	            if (valLength()) {
	                if (!btnClicked) {
    	                btnClicked = true;
        	            setCookies();
		    	        $.cookie("fol.form", "close");
						clearUpdateResult();
                    	killSession = false;
                    	window.location = "savefoldlg.csp";
	                }
                }
            });

            $("#update")
            .button()
            .click(function () {
	            if (valLength()) {
	                if (!btnClicked) {
    	                btnClicked = true;
        	            setCookies();
						$.cookie("fol.form", "update");
						clearUpdateResult();
                    	killSession = false;
                    	window.location = "savefoldlg.csp";
	                }
                }
            });


            $("#cancel")
            .button()
            .click(function () {
                if (!btnClicked) {
                    btnClicked = true;
                    killSession = false;
                    window.location = "showalerttype.csp";
                }
            });

            fillForm();

			if ($.cookie("fromPage") == "saveFolDlg") {
				showUpdateResult();
			} else {
				clearUpdateResult();
			}
			
	        $("#txtName").focus();

			function showUpdateResult() {
				var updateResult = $.cookie("updateResult") ;
				$("#txtAreaResult").val(updateResult);
				$("#txtAreaResult").show();
				$("#lblAreaResult").show();
				
				var todo = $.cookie("fol.todo");
				if (todo == "add") {
					var record = $.cookie("dlg.record");
					var recAry = record.split("^");
	            
        	        $("#txtName").val(recAry[0]);
            	    $("#selOrdDlgPkg").val(recAry[6]);
                	$("#txtComment").val(recAry[7]);
	                $("#txtDesired").val(recAry[8]);
                
		            var itemReq = recAry[9];
	    	        if (itemReq == "1") {
		    	        $("#chkOrdItemReq").prop("checked", true);
		            } else {
			            $("#chkOrdItemReq").prop("checked", false);
		           }

				}
				

			}

			function clearUpdateResult() {
				$.cookie("fromPage", "foldlg");
            	$("#txtAreaResult").val("");
				$("#txtAreaResult").hide();
				$("#lblAreaResult").hide();
			}

            function setCookies() {
	            var itemReq = $("#chkOrdItemReq").prop("checked") ? "1" : "0";
                var record = $("#txtName").val() + "^" +
                $("#txtOrdItemDispGrp").val() + "^" +
                $("#txtOrdItemName").val() + "^" +
                $("#txtOrdDlgDispGrp").val() + "^" +
                $("#txtOrdDlg").val() + "^" +
                $("#txtAddFind").val() + "^" +
                $("#selOrdDlgPkg").val() + "^" +
                $("#txtComment").val() + "^" +
                $("#txtDesired").val() + "^" +
                itemReq  + "^" +
                $("#txtSeqNumber").val();
                $.cookie("dlg.record", record)
            }

			function searchReminderDlg() {
    			var features = "dialogwidth: 550px; dialogheight: 700px; resizable: yes";
				var searchval = $("#txtDesired").val();

				if (searchval == "") {
					var record = $.cookie("type.record");
					var arr = record.split("^");
	                var searchval = "AW" + arr[6] + " " + arr[5];
				}

                $.cookie("search.dlgFile", "19007.02");
                $.cookie("search.filenumber", "801.41");
                $.cookie("search.filename", "Reminder Dialog");
                $.cookie("search.value", searchval);
                $.cookie('search.screen', 'I $P(^(0),U,4)="E"');
				
				var remDlg = window.showModalDialog("searchfile.csp", null, "dialogHeight:700px;dialogWidth:500px");
				if (typeof remDlg === "undefined") {
				} else {
					var res = remDlg.split(" (#");
					$("#txtDesired").val(res[0]);
					var seq = res[1].split(")");
					$("#txtSeqNumber").val(seq[0]);
				}
	               
				//window.open("searchfile.csp", "_blank", "height=700,width=550,status=yes,toolbar=no,menubar=no,location=no");
            }

            
        });

		function valLength() {
			var fld = "#txtName";
			var val = valFieldLength(fld, "Order Dialog Box Text", 1, 240);
			if (!val) {
				$(fld).focus();
			}
			return val;
		}
		
		function valFieldLength(fld, caption, low, high) {
			if (($(fld).val().length > high) || ($(fld).val().length < low)) {
				alert(caption + " must be " + low + "-" + high + " characters in length");
				return false;
			} else {
				return true;
			}
		}

		var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}

		function setSeqNumber(remDlg) {
			var alertType = $.cookie("type.ien");
			var seq = $("#txtSeqNumber").val();
			if ((alertType != "") && (remDlg !="") && (seq == "")) {
		        #server(VEFA.OrderDialog.SetSequenceNumber(19007.02,alertType, remDlg))#;
			}
		}

    </script>

</head>
<body>

 <center>

<FORM id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:900px" >

<div id="searchDlg" name="searchDlg" title="Search Result"></div>

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE KB Editor</h1>
			<h1>Follow-up Dialog</h1>
        </td>
    </table>
</div>

</br>

<div>
        <table class="ui-widget ui-state-default ui-corner-all" style="width: 100%;">
        
		<tr>
        <td align="right" >
            Alert Type</td>
        <td align="left">
			<label id="txtReminderDlg" for="form1" style="color:#654D00">AlertType</label>
        </td>
      	</tr>

        <tr>
        <td align="right" >
            <label for="txtName">Order Dialog Box Text</label></td>
        <td align="left">
            <input id="txtName" name="txtName" class="ui-widget ui-corner-all TxtBoxWidth" type="text" /></td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtDesired">Desired Reminder Element</label></td>
        <td align="left">
            <input id="txtDesired" name="txtDesired" class="ui-widget ui-corner-all TxtBoxWidth" type="text" />
		    <input id="btnSearch" type="button" align="left" value="Search" /></td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtSeqNumber">Sequence Number</label></td>
        <td align="left">
            <input id="txtSeqNumber" name="txtSeqNumber" class="ui-widget ui-corner-all NumberWidth" type="text" />
        </tr>

        <tr>
        <td align="left">
            <input id="txtComment" class="ui-widget ui-corner-all TxtBoxWidth" type="hidden" 
                name="txtComment" /></td>
        </tr>

        <tr>
        <td align="right" >
            <label for="selOrdDlgPkg">Desired Order Dialog Package</label></td>
        <td align="left">
            <select id="selOrdDlgPkg" name="selOrdDlgPkg" class="ui-widget ui-corner-all TxtBoxWidth" >
                <option></option>
            </select></td>
        </tr>

        <tr>
        <td align="right" >
            &nbsp;</td>
        <td align="left">
            &nbsp;<input id="chkOrdItemReq" type="checkbox" 
                name="chkOrdItemReq" class="ui-widget ui-corner-all" /><label for="chkOrdItemReq">Orderable Item Required</label></td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdItemDispGrp">Orderable Item Display Group</label></td>
        <td align="left">
            <input id="txtOrdItemDispGrp" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrdItemDispGrp" readonly/></td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdItemName">Orderable Item Name</label></td>
        <td align="left">
            <input id="txtOrdItemName" name="txtOrdItemName" align="left" type="text" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly/>&nbsp;
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdDlgDispGrp">Order Dialog Display Group</label></td>
        <td align="left">
            <input id="txtOrdDlgDispGrp" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrdDlgDispGrp" /></td>
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtOrgOrdDlgPkg">Order Dialog Package</label></td>
        <td align="left">
            <input id="txtOrgOrdDlgPkg" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrgOrdDlgPkg" readonly/></td>
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtOrdDlg">Order Dialog</label></td>
        <td align="left">
            <input id="txtOrdDlg" name="txtOrdDlg" type="text" align="left" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" 
                readonly/>&nbsp;
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtAddFind">Additional Finding</label></td>
        <td align="left">
            <input id="txtAddFind" name="txtAddFind" type="text" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly />
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtAreaNote">Progress Note</label></td>
        <td align="left">
            <textarea id="txtAreaNote" name="txtAreaNote" rows="5" cols="50" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly 
            ></textarea>
        </td>
        </tr>

        </table>
</div>

</br>

<div style="width: 731px">
    <table style="width: 400px">
    <tr>
        <td align="left" class="style2">
            &nbsp; <!-- <p style="font-size:70%; color:#4682B4; text-align:left;">Alt+S to switch between Tabs</p> -->
        </td>
    
        <td align="left" class="button">
            &nbsp;<input id="ok" name="ok" type="button" value="Update and Close" />
        </td>

        <td align="left" class="button">
            &nbsp;<input id="update" type="button" name="update" value="Update" />
        </td>
    
        <td align="left" class="button">
            &nbsp;<input value="Close" type="button" id="cancel" name="cancel" >
         </td>
         
         
    </tr>

    </table>
</div>

 <script language="Cache" runat="server" >
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
   	d ##class(VEFA.OrderDialog).FillFollowupDlg()
</script>


<br />


</FORM>


<p>
	<label id="lblAreaResult" name="lblAreaResult" for="txtAreaResult" class="ui-widget"><b>Validation Result</b></label></br>
    <textarea id="txtAreaResult" name="txtAreaResult" readonly class="ReadOnly ui-widget ui-corner-all"></textarea>
</p>


</center>
</body>
</html>
]]></CSP>


<CSP name="kbeditor/showmain.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>AWARE KBEditor Main</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
 
	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="jquery.ui.dialog.css" />
    
    <style type="text/css">
    	h1 {	
			margin:0;
	  	}
	  	
    	#tabs {
            padding: 0px;
	    }
	   
	   #tabs .ui-tabs-nav {
    	 background: transparent; 
         border-width: 0px 0px 1px 0px; 
         -moz-border-radius: 0px; 
         -webkit-border-radius: 0px; 
         border-radius: 0px; 
	   }
	   #tabs .ui-tabs-panel {
          margin: 0em 0.2em 0.2em 0.2em;
	   }
   	   #tabs .ui-state-hover a {
		   color: #0e1ed7;
	   }
	   #tabs .ui-state-focus a {
		   color: #0e1ed7;
	   }
	   #tabs .ui-state-active a {
		   color: #0e1ed7;
	   }
	   #signout:hover {
		   color: #0e1ed7;
	   }
	   
      	.ui-jqgrid tr.ui-row-ltr td {
			padding: 0 8px;
    	}
		.ui-jqgrid tr.jqgrow td {
			word-wrap: break-word;
			white-space:normal !important;
    	}
    	.ui-jqgrid .ui-widget-header {
			background: #0a1a4c;
		}

	    #txtUser {
            width: 250px;
        }
        .auto-style1 {
            width: 500px;
        }
	    #txtConnection {
            width: 250px;
        }
	    .auto-style2 {
            width: 500px;
        }
	</style>


	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>

	<script src="grid.locale-en.js"></script>
	<script src="jquery.jqGrid.min-aware.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.ui.dialog.js"></script>


	<script type="text/javascript">
		// Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

		function NotNumber(str) {
			return ((str == "undefined") || (str == "") || isNaN(str));
    	}
        
	    $(function () {
   		    var killSession = false;
		    
   	        window.onbeforeunload = function() {
	   	        if (killSession) {
					#server(VEFA.Login.KillSession())#;
	   	        }
	        }

		    var btnClicked = false;
			var catRowNum = $.cookie("cat.rowNum");
    	    if (NotNumber(catRowNum)) {
        	    catRowNum = 10;
	        } else {
    	        catRowNum = parseInt(catRowNum);
        	}
	
			var typeRowNum = $.cookie("type.rowNum");
    	    if (NotNumber(typeRowNum)) {
        	    typeRowNum = 10;
	        } else {
    	        typeRowNum = parseInt(typeRowNum);
        	}

			$("#tabs").tabs({
				activate: function(event, ui) {
					var activeIndex = $("#tabs").tabs("option", "active");
	            	$.cookie("type.tab", activeIndex);
				}
			});
				
	        $("#listCat").jqGrid({
	            datatype: "local",
	            height: "auto",
	            colNames: ["ID", "Name", "Description", "Delete Alert", "Follow-up Action", "", "Notification Type"],
	            colModel: [
                    { name: "ien", width: 50 },
                    { name: "name", width: 175 },
                    { name: "descr", width: 200 },
                    { name: "delAlert", width: 150, align: "left" },
                    { name: "action", formatter: "checkbox", width: 100, align: "center" },
                    { name: "notfType", hidden:true },
                    { name: "notfTypeDescr", width: 175, align: "left" }
       		    ],
				hidegrid: false,
	            pager: "#pagerCat",
	            rowNum: catRowNum,
	            rowList: [10, 20, 30, 40],
	            viewrecords: true,
	            gridview: true,
	            autoencode: true,
	            multiSelect: true,
	            caption: "Alert Category",
	            ondblClickRow: function (rowId) {
	                editAlertCategory();
	            },
	            loadComplete: function () {
		            selectTab();
          			//var rowsPerPage = getGridSize("#listCat");
	                //$("#listCat").jqGrid("setGridHeight", (rowsPerPage * 23.5), true);
	            }
	        }).navGrid("#pagerCat", { add: false, edit: false, del: false, refresh: false, search: false })
            .navButtonAdd("#pagerCat", {
                caption: "Add",
                id: "add",
                buttonicon: "ui-icon-document",
                onClickButton: function () {
                    addAlertCategory();
                },
                position: "last"
            })
	        .navButtonAdd("#pagerCat", {
	            caption: "Edit",
	            buttonicon: "ui-icon-folder-open",
	            onClickButton: function () {
	                editAlertCategory();
	            },
	            position: "last"
	        })
	        .navButtonAdd("#pagerCat", {
	            caption: "Delete",
	            buttonicon: "ui-icon-trash",
	            onClickButton: function () {
	                delAlertCategory();
	            },
	            position: "last"
	        });

	        $("#listCat").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event
			genACToolTips();
			//$("#pagerCat_center").hide();
			
	        $("#listType").jqGrid({
	            datatype: "local",
	            height: "auto",
	            colNames: ["ID", "Alert Type", "Active", "Reminder Dialog", "TIU Template", "Alert Category", "Init Date"],
	            colModel: [
                    { name: "ien", width: 50 },
                    { name: "name", width: 200 },
                    { name: "active", formatter: "checkbox", width: 50, align: "center" },
                    { name: "remDlg", width: 150 },
                    { name: "tiu", width: 150 },
                    { name: "alertCat", width: 150 },
                    { name: "initDate", width: 100, align: "left" },
                ],
				hidegrid: false,
	            pager: "#pagerType",
	          	rowNum: typeRowNum,
	            rowList: [10, 20, 30, 40],
				viewrecords: true,
	            gridview: true,
	            autoencode: true,
	            multiSelect: true,
	            caption: "Alert Type",
	            scrollrows: true,
	            ondblClickRow: function (rowId) {
	                editAlertType();
	            },
	            loadComplete: function () {
	                selectTab();
          			//var rowsPerPage = getGridSize("#listType");
	                //$("#listType").jqGrid("setGridHeight", (rowsPerPage * 23.5), true);
	            }

	        }).navGrid("#pagerType", { add: false, edit: false, del: false, refresh: false, search: false })
            .navButtonAdd("#pagerType", {
                caption: "Add",
                buttonicon: "ui-icon-document",
                onClickButton: function () {
                    addAlertType();
                },
                position: "last"
            })
	        .navButtonAdd("#pagerType", {
	            caption: "Edit",
	            buttonicon: "ui-icon-folder-open",
	            onClickButton: function () {
	                editAlertType();
	            },
	            position: "last"
	        })
	        .navButtonAdd("#pagerType", {
	            caption: "Copy",
	            buttonicon: "ui-icon-copy",
	            onClickButton: function () {
	                copyAlertType();
	            },
	            position: "last"
	        })
	        .navButtonAdd("#pagerType", {
	            caption: "Delete",
	            buttonicon: "ui-icon-trash",
	            onClickButton: function () {
	                delAlertType();
	            },
	            position: "last"
	        });

	        $("#listType").jqGrid("bindKeys", {}); 	// Bind the navigation and set the onEnter event
			genATToolTips();
			//$("#pagerType_center").hide();
			
			$("#alertmod_listType").remove();
			$("#alertmod_listCat").remove();
	        $("#pagerType .ui-pg-selbox").prop("title","Select Page Size");
            $("#pagerType .ui-pg-input").prop("title","Enter Page Number");
	        $("#pagerCat .ui-pg-selbox").prop("title","Select Page Size");
            $("#pagerCat .ui-pg-input").prop("title","Enter Page Number");

			
            $("#signout")
              .button()
              .click(function (event) {
   				var rowsPerPage = $("#listCat").getGridParam("rowNum");
                $.cookie("cat.rowNum", rowsPerPage, { expires: 10000 });
   				var rowsPerPage = $("#listType").getGridParam("rowNum");
                $.cookie("type.rowNum", rowsPerPage, { expires: 10000 });
		        window.location = "logoff.csp";
              });

	        Mousetrap.bind("alt+g", function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            activeIndex = parseInt(activeIndex, 10);
	            $('#tabs').tabs({ active: activeIndex });
	            if (activeIndex == 0) {
	                selectCatRow();
	            } else {
	                selectTypeRow();
	            }
	        });

	        Mousetrap.bind("ctrl+alt+x", function (e) {
		        window.location = "logoff.csp";
	        });

	        Mousetrap.bind("ctrl+alt+a", function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 0) {
	                addAlertCategory();
	            } else {
	                addAlertType();
	            }
	        });

	        Mousetrap.bind("ctrl+alt+e", function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 0) {
	                editAlertCategory();
	            } else {
	                editAlertType();
	            }
	        });

	        Mousetrap.bind("ctrl+alt+c", function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 1) {
	                copyAlertType();
	            }
	        });

	        Mousetrap.bind("ctrl+alt+d", function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 0) {
	                delAlertCategory();
	            } else {
	                delAlertType();
	            }
	        });


	        Mousetrap.bind('ctrl+alt+n', function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 0) {
		            nextPage("#listCat");
	            } else {
		            nextPage("#listType");
	            }
	        });
	        
	        Mousetrap.bind('ctrl+alt+b', function (e) {
	            var activeIndex = $("#tabs").tabs("option", "active");
	            if (activeIndex == 0) {
		            prevPage("#listCat");
	            } else {
		            prevPage("#listType");
	            }
	        });

	        function nextPage(grid) {
				var rowNum = $(grid).getGridParam("rowNum");
				var allRecs = $(grid).getGridParam("records");
				var totalPages = parseInt((allRecs/rowNum) + 1);
				var page = $(grid).getGridParam("page");
				if (page+1 <= totalPages) {
		        	$(grid).setGridParam({ page: (page+1) }).trigger("reloadGrid");
					$(grid).focus();
	        		$(grid + " tr").eq(1).trigger("click");
				}
	        }

	        function prevPage(grid) {
				var page = $(grid).getGridParam("page");
				if (page > 0) {
		        	$(grid).setGridParam({ page: (page-1) }).trigger("reloadGrid");
					$(grid).focus();
	        		$(grid + " tr").eq(1).trigger("click");
				}
	        }

	        window.onload = function () {
	            var tab = parseInt($.cookie("type.tab"),0)

	            if (tab == 1) {
	                $('#tabs').tabs({ active: 1 });
	                selectTypeRow();
	            } else {
					$.cookie("fromPage","showmain");
	                var activeIndex = $("#tabs").tabs("option", "active");
	                if (activeIndex == 0) {
	                    $('#tabs').tabs({ active: 0 });
	                    selectCatRow();
	                } else {
	                    $('#tabs').tabs({ active: 1 });
	                    selectTypeRow();
	                }
	            }
	        };

	        function getGridSize(grid) {
	            var rowsPerPage = $(grid).getGridParam("rowNum");
	            if (NotNumber(rowsPerPage)) {
	                rowsPerPage = 10;
	            } else {
		            rowsPerPage = parseInt(rowsPerPage);
	            }
	            return rowsPerPage;
	        }

	        function selectTab() {
	            var tab = $.cookie("type.tab")
	            if (NotNumber(tab)) {
		            tab = 0;
	            } else {
					tab = parseInt(tab);
	            }
	            if (tab == 1) {
	                $('#tabs').tabs({ active: 1 });
	                selectTypeRow();
	            } else {
	                $('#tabs').tabs({ active: 0 });
	                selectCatRow();
	            }
	        }

	        function selectCatRow() {
	            $("#listCat").focus();
	            var id = $.cookie("cat.id");
	            if (typeof id == "undefined") {
	                id = 1;
	                $.cookie("cat.id", id);
	            } else if (id == "") {
	                id = $.cookie("cat.lastrow");
	                id = parseInt(id, 10) + 1;
	                $.cookie("cat.id", id);
	            }
	            $("#listCat").jqGrid("setSelection", id);
	        }

	        function selectTypeRow() {
	            $("#listType").focus();
	            var id = $.cookie("type.id");
	            if (typeof id == "undefined") {
	                id = 1;
	                $.cookie("type.id", id);
	            } else if (id == "") {
	                id = $.cookie("type.lastrow");
	                id = parseInt(id, 10) + 1;
	                $.cookie("type.id", id);
	            }

	            $("#listType").jqGrid("setSelection", id);
	        }

	        function getLastRowId(list) {
	            var rows = $(list)[0].rows;
	            return (rows.length - 1);
	        }

	        function addAlertCategory() {
	            if (!btnClicked) {
	   		        btnClicked = true;
	                var addClass = $("#add").prop("class");
   			        var n = addClass.search("ui-state-disabled");
   			        if (n == -1) {
	        		    $.cookie("cat.lastrow", getLastRowId("#listCat"));
	                	$.cookie("cat.todo", "add");
		                $.cookie("startMainTab", "#listType");
						savePageRowNum();
			   			killSession = false;
	    	            window.location = "showalertcategory.csp";
	        	    }
	            }
	        }

	        function editAlertCategory() {
	            var rowId = $("#listCat").jqGrid("getGridParam", "selrow");
	            if (rowId == null) {
	                alert("No row selected");
	            } else {
	                if (!btnClicked) {
	                    btnClicked = true;
	                    var rowData = $("#listCat").getRowData(rowId);
	                    var ien = rowData["ien"];
	                    $.cookie("startMainTab", "#listCat");
	                    $.cookie("cat.todo", "edit");
	                    $.cookie("cat.ien", ien);
	                    $.cookie("cat.id", rowId);
						savePageRowNum();
	                    var record = rowData["name"] + "^" +
							rowData["descr"] + "^" +
							rowData["delAlert"] + "^" +
							rowData["notfType"] + "^" +
							rowData["action"];

	                    $.cookie("cat.record", record);
	                    
			   			killSession = false;
	    	            window.location = "showalertcategory.csp";
	                }
                }
	        }

	        function delAlertCategory() {
	            var rowId = $("#listCat").jqGrid("getGridParam", "selrow");
	            if (rowId == null) {
	                alert("No row selected");
	            } else {
	                if (!btnClicked) {
		            	if (confirm("Delete the selected Alert Category")) {
		                    btnClicked = true;
		                    var rowData = $("#listCat").getRowData(rowId);
	    	                var ien = rowData["ien"];
	        	            $.cookie("startMainTab", "#listCat");
	            	        $.cookie("cat.todo", "delete");
	                	    $.cookie("cat.ien", ien);
	                    	$.cookie("cat.id", rowId);
							savePageRowNum();
		                    var record = rowData["name"] + "^" +
								rowData["descr"] + "^" +
								rowData["delAlert"] + "^" +
								rowData["notfType"] + "^" +
								rowData["action"];
		                    $.cookie("cat.record", record);
							killSession = false;
		                    window.location = "savealertcat.csp";
            	        }
	                }
	            }
	        }

	        function addAlertType() {
	            if (!btnClicked) {
	                btnClicked = true;
	                $.cookie("type.lastrow", getLastRowId("#listType"));
	                $.cookie("startMainTab", "#listType");
	                $.cookie("type.todo", "add");
	                $.cookie("type.lastTabIndex", 0);
					$.cookie("updateResult","");
					savePageRowNum();
					killSession = false;
	    	   	    window.location = "showalerttype.csp";
                }
	        }

	        function editAlertType() {
	            var rowId = $("#listType").jqGrid("getGridParam", "selrow");
	            if (rowId == null) {
	                alert("No row selected");
	            } else {
	                if (!btnClicked) {
	                    btnClicked = true;
	                    var rowData = $("#listType").getRowData(rowId);
	                    var ien = rowData["ien"];
	                    $.cookie("startMainTab", "#listType");
	                    $.cookie("type.todo", "edit");
	                    $.cookie("type.ien", ien);
	                    $.cookie("type.id", rowId);
	                    $.cookie("type.lastTabIndex", 0);
						$.cookie("updateResult","");
						savePageRowNum();
	                    killSession = false;
	                    window.location = "showalerttype.csp";
                    }
	            }
	        }

	        function copyAlertType() {
	            var rowId = $("#listType").jqGrid("getGridParam", "selrow");
	            if (rowId == null) {
	                alert("No row selected");
	            } else {
	                if (!btnClicked) {
		            	if (confirm("Copy the selected Alert Type")) {
		                    btnClicked = true;
		                    var rowData = $("#listType").getRowData(rowId);
	    	                var ien = rowData["ien"];
	        	            $.cookie("startMainTab", "#listType");
	            	        $.cookie("type.todo", "copy");
	                	    $.cookie("type.ien", ien);
	                    	$.cookie("type.id", rowId);
		                    $.cookie("type.lastTabIndex", 0);
							$.cookie("updateResult","");
							savePageRowNum();
							killSession = false;
		                    window.location = "savealerttype.csp";
            	        }
	                }
	            }
	        }
	        
	        function delAlertType() {
	            var rowId = $("#listType").jqGrid("getGridParam", "selrow");
	            if (rowId == null) {
	                alert("No row selected");
	            } else {
	                if (!btnClicked) {
		            	if (confirm("Delete the selected Alert Type")) {
		                    btnClicked = true;
		                    var rowData = $("#listType").getRowData(rowId);
	    	                var ien = rowData["ien"];
	        	            $.cookie("startMainTab", "#listType");
	            	        $.cookie("type.todo", "delete");
	                	    $.cookie("type.ien", ien);
	                    	$.cookie("type.id", rowId);
		                    $.cookie("type.lastTabIndex", 0);
							$.cookie("updateResult","");
							savePageRowNum();
							killSession = false;
		                    window.location = "savealerttype.csp";
            	        }
	                }
	            }
	        }
	        
	        function savePageRowNum() {
   				var rowsPerPage = $("#listCat").getGridParam("rowNum");
                $.cookie("cat.rowNum", rowsPerPage, { expires: 10000 });
   				var page = $("#listCat").getGridParam("page");
                $.cookie("cat.page", page);

		    	var rowsPerPage = $("#listType").getGridParam("rowNum");
			    $.cookie("type.rowNum", rowsPerPage, { expires: 10000 });
      			var page = $("#listType").getGridParam("page");
	            $.cookie("type.page", page);
	        }

	    });

		var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}

		function genACToolTips() {
	        $("#listCat_ien").attr("title", "Sort By: Alert Category IEN");
	        $("#listCat_name").attr("title", "Sort By: Alert Category Name");
	        $("#listCat_descr").attr("title", "Sort By: Description");
	        $("#listCat_delAlert").attr("title", "Sort By: Delete Alert");
	        $("#listCat_action").attr("title", "Sort By: Follow-up Action");
	        $("#listCat_notfTypeDescr").attr("title", "Sort By: Notification Type");
		}

		function genATToolTips() {
	        $("#listType_ien").attr("title", "Sort By: Alert Type IEN");
	        $("#listType_name").attr("title", "Sort By: Alert Type Name");
	        $("#listType_active").attr("title", "Sort By: Active");
	        $("#listType_remDlg").attr("title", "Sort By: Reminder Dialog");
	        $("#listType_tiu").attr("title", "Sort By: TIU Template");
	        $("#listType_alertCat").attr("title", "Sort By: Alert Category");
	        $("#listType_initDate").attr("title", "Sort By: Initiation Date");
		}

    </script>

</head>

<body>

<center>

    

<FORM  id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:950px">


<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
        	<h1>VistA AWARE</h1>
			<h1>Knowledge Based Editor</h1>
		</td>
    </table>
</div>

 
    <div id='tabs' text-align:left>
        <ul>
            <li><a id='tabCat' href='#tabs-1'>Alert Category</a></li>
            <li><a id='tabType' href='#tabs-2'>Alert Type</a></li>
	    </ul>
	
        <div id='tabs-1'>
            <table id="listCat"></table>
            <div id="pagerCat"></div>
	        <table style="width: 850px">
            <tr>
                <td>
                  <p style="font-size:70%; text-align:left;">Alt+G to Last Accessed Record
                  </br><label for="add" id="lblAdd" name="lblAdd">Ctrl+Alt+A to Add</label></p>
                </td>
                <td>
                  <p style="font-size:70%; text-align:left;">Ctrl+Alt+N to Next Page</br>Ctrl+Alt+E to Edit</p>
                </td>
                <td>
                  <p style="font-size:70%; text-align:left;">Ctrl+Alt+B to Previous Page</br>Ctrl+Alt+D to Delete</p>
                </td>
                <td>
                  <p style="font-size:70%; text-align:right;">Ctrl+Alt+X to Sign Out</p>
                </td>
            </tr>
       		</table>

        </div>

        <div id='tabs-2'>
            <table id="listType"></table>
            <div id="pagerType"></div>
	        <table style="width: 850px">
            <tr>
            <tr>
                <td>
                  <p style="font-size:70%; text-align:left;">Alt+G to Last Accessed Record</br>Ctrl+Alt+A to Add</p>
                </td>
                <td>
                  <p style="font-size:70%; text-align:left;">Ctrl+Alt+N to Next Page</br>Ctrl+Alt+E to Edit</p>
                </td>
                <td>
                  <p style="font-size:70%; text-align:left;">Ctrl+Alt+B to Previous Page</br>Ctrl+Alt+D to Delete</p>
                </td>
                <td>
                  <p style="font-size:70%; text-align:left;">Ctrl+Alt+C to Copy</br>Ctrl+Alt+X to Sign Out</p>
                </td>
            </tr>
       		</table>
        </div>
    </div>

	

<div id="lastPanel" name="lastPanel">
        <table style="width: 870px">
           <tr>
                <td class="auto-style2">
                  <p style="font-size:70%; text-align:left; width: 423px;">
                      <label for="txtUser">KB Editor used by&nbsp;</label>
                      <input id="txtUser" type="text" readonly/></p>
                </td>

		        <td align="right" style="font-size:60%;">
				    <input type="button" value="Sign Out" id="signout" name="signout">
		        </td>
        
           </tr>

        </table>
</div>

</FORM>    

<script language="Cache" runat="server" >
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
  	d ##class(VEFA.Login).LoginKBEditor()
</script>


<script type="text/javascript">
     $(function () {
		 //Set Alert Category Grid Size
	     var catRowNum = $.cookie("cat.rowNum");
         
         if (NotNumber(catRowNum)) {
             catRowNum = 10;
             $.cookie("cat.rowNum", catRowNum, { expires: 10000 });
         } else{
	         catRowNum = parseInt(catRowNum);
         }

		 //Set Alert Type Grid Size
	     var typeRowNum = $.cookie("type.rowNum");
         
         if (NotNumber(typeRowNum)) {
             typeRowNum = 10;
             $.cookie("type.rowNum", typeRowNum, { expires: 10000 });
         } else {
	         typeRowNum = parseInt(typeRowNum);
         }
 
	     //Set Alert Categoy page and row id
	     var pageNum = $.cookie("cat.page");
	     if (NotNumber(pageNum)) {
		    pageNum = 1;
	     } else {
	     	pageNum = parseInt(pageNum);
	     }
         $("#listCat").setGridParam({ page: pageNum, rowNum: catRowNum }).trigger("reloadGrid");
	     
	     var rowID = $.cookie("cat.id");
	     if (NotNumber(rowID)) {
		    rowID = 1;
	     } else {
		    rowID = parseInt(rowID);
	     }
	                
         $("#listCat").jqGrid("setSelection", rowID);
         
		 //Set Alert Type page and row id         
	     var pageNum = $.cookie("type.page");
	     if (NotNumber(pageNum)) {
		     pageNum = 1;
	     } else {
	     	 pageNum = parseInt(pageNum);
	     }
         $("#listType").setGridParam({ page: pageNum, rowNum: typeRowNum }).trigger("reloadGrid");
	     
	     var rowID = $.cookie("type.id");
	     if (NotNumber(rowID)) {
		     rowID = 1;
	     } else {
		     rowID = parseInt(rowID);
	     }
	                
         $("#listType").jqGrid("setSelection", rowID);

         //$("#listCat").jqGrid("setGridHeight", (catRowNum * 23.5), true);
         //$("#listType").jqGrid("setGridHeight", (typeRowNum * 23.5), true);

     });
</script>


	
</center>

</body>


</html>
]]></CSP>


<CSP name="kbeditor/showorderdlg.csp" application="/csp/aware/"><![CDATA[
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <title>AWARE KB Editor Alert Type</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <style type="text/css">
		h1 {
			margin:0;
	  	}
	  	
    	.TxtBoxWidth
        {
            width: 400px;
        }
        
    	.NumberWidth
        {
            width: 150px;
        }

        #chkOrdItemReq
        {
            width: 26px;
        }
        
        .ReadOnly
        {
			background: #f5f5f5
		}
        
		#txtAreaResult {
            width: 888px;
            height: 52px;
            color: #0e1ed7;
            font-weight: bold;
        }     
        
	</style>

	<link rel="stylesheet" type="text/css" media="screen" href="jquery-ui-aware.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="ui.jqgrid.css" />

    <style type="text/css">
	   #tabs {
            padding: 0px;
	   }
	   #tabs .ui-tabs-nav {
    	 background: transparent; 
         border-width: 0px 0px 1px 0px; 
         -moz-border-radius: 0px; 
         -webkit-border-radius: 0px; 
         border-radius: 0px; 
	   }
	   #tabs .ui-tabs-panel {
          margin: 0em 0.2em 0.2em 0.2em;
	   }
	    
	    .style1
        {
            height: 29px;
        }
	    
	</style>

	<script src="jquery.js"></script>
	<script src="jquery-ui.js"></script>
	<script src="jquery.cookie.js"></script>
    <script src="jquery.ui.datepicker.js"></script>
    
	<script src="grid.locale-en.js"></script>
	<script src="jquery.jqGrid.min-aware.js"></script>
	<script src="mousetrap.min.js"></script>
    <script src="jquery.validate.min.js"></script>

    <script type="text/javascript">
		// Prevent the backspace key from navigating back.
		$(document).unbind('keydown').bind('keydown', function (event) {
	    	var doPrevent = false;
		    if (event.keyCode === 8) {
	    	    var d = event.srcElement || event.target;
    	    	if ((d.tagName.toUpperCase() === 'INPUT' && 
        	     (
                 d.type.toUpperCase() === 'TEXT' ||
                 d.type.toUpperCase() === 'PASSWORD' || 
                 d.type.toUpperCase() === 'FILE' || 
                 d.type.toUpperCase() === 'EMAIL' || 
                 d.type.toUpperCase() === 'SEARCH' || 
                 d.type.toUpperCase() === 'DATE' )
            	 ) || 
             	 d.tagName.toUpperCase() === 'TEXTAREA') {
		            doPrevent = d.readOnly || d.disabled;
        		} else {
            		doPrevent = true;
		        }
		    }
	
    		if (doPrevent) {
        		event.preventDefault();
		    }
		});

        var btnClicked = false;

        $(function () {
   		    var killSession = false;
		    
   	        window.onbeforeunload = function() {
	   	        if (killSession) {
					#server(VEFA.Login.KillSession())#;
	   	        }
	        }

            $("#form1").validate({
                rules: {
                    txtName: "required",
                    selOrdDlgPkg: "required",
                    txtDesired: "required"
                }
            });

			$("#btnSearch")
            .button({ text: true, icons: { primary: "ui-icon ui-icon-search" } })
            .click(function () {
	            searchReminderDlg();
            });

            $("#ok")
            .button()
            .click(function () {
	            if (valLength()) {
	                if (!btnClicked) {
                 	   btnClicked = true;
                    	setCookies();
			            $.cookie("ord.form", "close");
						clearUpdateResult();
    	                killSession = false;
    	                window.location = "saveorderdlg.csp";
        	        }
	            }
            });

            $("#update")
            .button()
            .click(function () {
                if (valLength()) {
	    	        if (!btnClicked) {
            	        btnClicked = true;
                	    setCookies();
						$.cookie("ord.form", "update");
						clearUpdateResult();
    	                killSession = false;
    	                window.location = "saveorderdlg.csp";
        	        }
                }
            });


            $("#cancel")
            .button()
            .click(function () {
                if (!btnClicked) {
                    btnClicked = true;
                    killSession = false;
                    window.location = "showalerttype.csp";
                }
            });

            fillForm();

			if ($.cookie("fromPage") == "saveOrdDlg") {
				showUpdateResult();
			} else {
				clearUpdateResult();
			}
			
	        $("#txtName").focus();

			function showUpdateResult() {
				var updateResult = $.cookie("updateResult") ;
				$("#txtAreaResult").val(updateResult);
				$("#txtAreaResult").show();
				$("#lblAreaResult").show();
				
				var todo = $.cookie("ord.todo");
				if (todo == "add") {
					var record = $.cookie("dlg.record");
					var recAry = record.split("^");
	            
        	        $("#txtName").val(recAry[0]);
            	    $("#selOrdDlgPkg").val(recAry[6]);
                	$("#txtComment").val(recAry[7]);
	                $("#txtDesired").val(recAry[8]);
                
		            var itemReq = recAry[9];
	    	        if (itemReq == "1") {
		    	        $("#chkOrdItemReq").prop("checked", true);
		            } else {
			            $("#chkOrdItemReq").prop("checked", false);
		           }

				}
				

			}

			function clearUpdateResult() {
				$.cookie("fromPage", "orderdlg");
            	$("#txtAreaResult").val("");
				$("#txtAreaResult").hide();
				$("#lblAreaResult").hide();
			}

            function setCookies() {
	            var itemReq = $("#chkOrdItemReq").prop("checked") ? "1" : "0";
                var record = $("#txtName").val() + "^" +
                $("#txtOrdItemDispGrp").val() + "^" +
                $("#txtOrdItemName").val() + "^" +
                $("#txtOrdDlgDispGrp").val() + "^" +
                $("#txtOrdDlg").val() + "^" +
                $("#txtAddFind").val() + "^" +
                $("#selOrdDlgPkg").val() + "^" +
                $("#txtComment").val() + "^" +
                $("#txtDesired").val() + "^" +
                itemReq  + "^" +
                $("#txtSeqNumber").val();
                $.cookie("dlg.record", record)
            }

			function searchReminderDlg() {
    			var features = "dialogwidth: 550px; dialogheight: 700px; resizable: yes";
				var searchval = $("#txtDesired").val();

				if (searchval == "") {
					var record = $.cookie("type.record");
					var arr = record.split("^");
	                var searchval = "AW" + arr[6] + " " + arr[5];
				}

                $.cookie("search.dlgFile", "19007.01");
                $.cookie("search.filenumber", "801.41");
                $.cookie("search.filename", "Reminder Dialog");
                $.cookie("search.value", searchval);
                $.cookie('search.screen', 'I $P(^(0),U,4)="E"');

   				var remDlg = window.showModalDialog("searchfile.csp", null, "dialogHeight:700px;dialogWidth:500px");
				if (typeof remDlg === "undefined") {
				} else {
					var res = remDlg.split(" (#");
					$("#txtDesired").val(res[0]);
					var seq = res[1].split(")");
					$("#txtSeqNumber").val(seq[0]);
					//setSeqNumber(seq[0]);
				}

				//window.open("searchfile.csp", "_blank", "height=700,width=550,status=yes,toolbar=no,menubar=no,location=no");
            }
            

        });

		function valLength() {
			var fld = "#txtName";
			var val = valFieldLength(fld, "Order Dialog Box Text", 1, 240);
			if (!val) {
				$(fld).focus();
			}
			return val;
		}
		
		function valFieldLength(fld, caption, low, high) {
			if (($(fld).val().length > high) || ($(fld).val().length < low)) {
				alert(caption + " must be " + low + "-" + high + " characters in length");
				return false;
			} else {
				return true;
			}
		}


		var intervalID = window.setInterval(checkTimeout,60000);
		function checkTimeout() { 
			#server(VEFA.Login.WarnUser())#;
		}
        
		function timeoutWarning(min) {
        	alert("Web Page is closing in " + min + " minutes. Click OK to continue working");
	        clearInterval(intervalID);
	        #server(VEFA.Login.ResetSession())#;
		}

		function setSeqNumber(remDlg) {
			var alertType = $.cookie("type.ien");
			var seq = $("#txtSeqNumber").val();
			if ((alertType != "") && (remDlg !="") && (seq == "")) {
		        #server(VEFA.OrderDialog.SetSequenceNumber(19007.01,alertType, remDlg))#;
			}
		}


    </script>

</head>
<body>

 <center>

<FORM id="form1" name="form1" class="ui-widget ui-state-default ui-corner-all" style="width:900px">

<div id="header" name="header" style="background-color:#001A4C; color:#FFFFFF; " >
    <table>
		<td align="left">
            <img border="0" src="va.png" alt="U.S. Department of Veterans Affairs" width="125" height="125"/>
		</td>
		<td align="left">
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
        	&nbsp; &nbsp;
		</td>
        <td align="right">
			<h1>VistA AWARE KB Editor</h1>
			<h1>Order Dialog</h1>
        </td>
    </table>
</div>

</br>

<div>
        <table class="ui-widget ui-state-default ui-corner-all" style="width: 100%;">
        
		<tr>
        <td align="right" >
            Alert Type</td>
        <td align="left">
			<label id="txtReminderDlg" for="form1" style="color:#654D00">AlertType</label>
        </td>
      	</tr>

        <tr>
        <td align="right" >
            <label for="txtName">Order Dialog Box Text</label></td>
        <td align="left">
            <input id="txtName" name="txtName" class="ui-widget ui-corner-all TxtBoxWidth" type="text" /></td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtDesired">Desired Reminder Element</label></td>
        <td align="left">
            <input id="txtDesired" name="txtDesired" class="ui-widget ui-corner-all TxtBoxWidth" type="text" />
		    <input id="btnSearch" type="button" align="left" value="Search" /></td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtSeqNumber">Sequence Number</label></td>
        <td align="left">
            <input id="txtSeqNumber" name="txtSeqNumber" class="ui-widget ui-corner-all NumberWidth" type="text" />
        </tr>
		
		<tr>
        <td align="left">
            <input id="txtComment" class="ui-widget ui-corner-all TxtBoxWidth" type="hidden" 
                name="txtComment" /></td>
        </tr>

        <tr>
        <td align="right" >
            <label for="selOrdDlgPkg">Desired Order Dialog Package</label></td>
        <td align="left">
            <select id="selOrdDlgPkg" name="selOrdDlgPkg" class="ui-widget ui-corner-all TxtBoxWidth" >
                <option></option>
            </select></td>
        </tr>

        <tr>
        <td align="right" >
            &nbsp;</td>
        <td align="left">
            &nbsp;<input id="chkOrdItemReq" type="checkbox" 
                name="chkOrdItemReq" class="ui-widget ui-corner-all" /><label for="chkOrdItemReq">Orderable Item Required</label></td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdItemDispGrp">Orderable Item Display Group</label></td>
        <td align="left">
            <input id="txtOrdItemDispGrp" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrdItemDispGrp" readonly /></td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdItemName">Orderable Item Name</label></td>
        <td align="left">
            <input id="txtOrdItemName" name="txtOrdItemName" align="left" type="text" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly />&nbsp;
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtOrdDlgDispGrp">Order Dialog Display Group</label></td>
        <td align="left">
            <input id="txtOrdDlgDispGrp" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrdDlgDispGrp" readonly/></td>
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtOrgOrdDlgPkg">Order Dialog Package</label></td>
        <td align="left">
            <input id="txtOrgOrdDlgPkg" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" type="text" 
                name="txtOrgOrdDlgPkg" readonly/></td>
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtOrdDlg">Order Dialog</label></td>
        <td align="left">
            <input id="txtOrdDlg" name="txtOrdDlg" type="text" align="left" class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" 
                readonly />&nbsp;
        </td>
        </tr>
        
        <tr>
        <td align="right" >
            <label for="txtAddFind">Additional Finding</label></td>
        <td align="left">
            <input id="txtAddFind" name="txtAddFind" type="text" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly />
        </td>
        </tr>

        <tr>
        <td align="right" >
            <label for="txtAreaNote">Progress Note</label></td>
        <td align="left">
            <textarea id="txtAreaNote" name="txtAreaNote" rows="5" cols="50" 
                class="ReadOnly ui-widget ui-corner-all TxtBoxWidth" readonly 
            ></textarea>
        </td>
        </tr>

        </table>
</div>

</br>

<div style="width: 731px">
    <table style="width: 400px">
    <tr>
        <td align="left" class="style2">
            &nbsp; <!-- <p style="font-size:70%; color:#4682B4; text-align:left;">Alt+S to switch between Tabs</p> -->
        </td>
    
        <td align="left" class="button">
            &nbsp;<input id="ok" name="ok" type="button" value="Update and Close" />
        </td>

        <td align="left" class="button">
            &nbsp;<input id="update" type="button" name="update" value="Update" />
        </td>
    
        <td align="left" class="button">
            &nbsp;<input value="Close" type="button" id="cancel" name="cancel" >
         </td>
         
         
    </tr>

    </table>
</div>

 <script language="Cache" runat="server" >
	s %session.Data("startTimeOut",1)=$zh
	s %session.Data("hasBeenWarned",1)=0
   	d ##class(VEFA.OrderDialog).FillOrderDlg()
</script>

<br />



</FORM>


<p>
	<label id="lblAreaResult" name="lblAreaResult" for="txtAreaResult" class="ui-widget"><b>Validation Result</b></label></br>
    <textarea id="txtAreaResult" name="txtAreaResult" readonly class="ReadOnly ui-widget ui-corner-all"></textarea>
</p>



</center>
</body>
</html>
]]></CSP>
</Export>
